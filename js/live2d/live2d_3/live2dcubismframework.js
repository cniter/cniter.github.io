var LIVE2DCUBISMFRAMEWORK;!function(t){var h=function(t,e){this.time=t,this.value=e};t.AnimationPoint=h;var e=function(t,e){this.time=t,this.value=e};t.AnimationUserDataBody=e;var c=(r.lerp=function(t,e,i){return new h(t.time+(e.time-t.time)*i,t.value+(e.value-t.value)*i)},r.LINEAR=function(t,e,i){var a=t[e+0],e=t[e+1],i=(i-a.time)/(e.time-a.time);return a.value+(e.value-a.value)*i},r.BEZIER=function(t,e,i){var a=(i-t[e+0].time)/(t[e+3].time-t[e].time),n=r.lerp(t[e+0],t[e+1],a),i=r.lerp(t[e+1],t[e+2],a),e=r.lerp(t[e+2],t[e+3],a),n=r.lerp(n,i,a),e=r.lerp(i,e,a);return r.lerp(n,e,a).value},r.STEPPED=function(t,e,i){return t[e+0].value},r.INVERSE_STEPPED=function(t,e,i){return t[e+1].value},r);function r(){}t.BuiltinAnimationSegmentEvaluators=c;var p=function(t,e){this.offset=t,this.evaluate=e};t.AnimationSegment=p;var f=(i.prototype.evaluate=function(t){for(var e=0,i=this.segments.length-1;e<i&&this.points[this.segments[e+1].offset].time<t;++e);return this.segments[e].evaluate(this.points,this.segments[e].offset,t)},i);function i(t,e,i){this.targetId=t,this.points=e,this.segments=i}t.AnimationTrack=f;var a=(n.fromMotion3Json=function(t){if(null==t)return null;t=new n(t);return t.isValid?t:null},n.prototype.addAnimationCallback=function(t){null==this._callbackFunctions&&(this._callbackFunctions=new Array),this._callbackFunctions.push(t)},n.prototype.removeAnimationCallback=function(t){if(null!=this._callbackFunctions){for(var e=-1,i=0;i<this._callbackFunctions.length;i++)if(this._callbackFunctions[i]===t){e=i;break}0<=e&&this._callbackFunctions.splice(e,1)}},n.prototype.clearAnimationCallback=function(){this._callbackFunctions=[]},n.prototype.callAnimationCallback=function(e){0<this._callbackFunctions.length&&this._callbackFunctions.forEach(function(t){t(e)})},n.prototype.evaluate=function(s,o,u,l,h,c){if(void 0===c&&(c=null),!(o<=.01)){if(this.loop)for(;s>this.duration;)s-=this.duration;if(this.parameterTracks.forEach(function(t){var e,i=l.parameters.ids.indexOf(t.targetId);0<=i&&(e=t.evaluate(s),1!=h[0][i]&&(l.parameters.values[i]=l.parameters.defaultValues[i],h[0][i]=!0),l.parameters.values[i]=u(l.parameters.values[i],e,t.evaluate(0),o))}),this.partOpacityTracks.forEach(function(t){var e,i=l.parts.ids.indexOf(t.targetId);0<=i&&(e=t.evaluate(s),1!=h[1][i]&&(l.parts.opacities[i]=1,h[1][i]=!0),l.parts.opacities[i]=u(l.parts.opacities[i],e,t.evaluate(0),o))}),this.modelTracks.forEach(function(t){if(null!=c){var e=c.getGroupById(t.targetId);if(null!=e&&"Parameter"===e.target)for(var i=0,a=e.ids;i<a.length;i++){var n=a[i],r=l.parameters.ids.indexOf(n);0<=r&&(n=t.evaluate(s),1!=h[0][r]&&(l.parameters.values[r]=l.parameters.defaultValues[r],h[0][r]=!0),l.parameters.values[r]=u(l.parameters.values[r],n,t.evaluate(0),o))}}}),null!=this._callbackFunctions)for(var t=0,e=this.userDataBodys;t<e.length;t++){var i=e[t];this.isEventTriggered(i.time,s,this._lastTime,this.duration)&&this.callAnimationCallback(i.value)}this._lastTime=s}},n.prototype.isEventTriggered=function(t,e,i,a){if(i<e){if(i<t&&t<e)return!0}else if(0<t&&t<e||i<t&&t<a)return!0;return!1},Object.defineProperty(n.prototype,"isValid",{get:function(){return!0},enumerable:!0,configurable:!0}),n);function n(t){var l=this;this.modelTracks=new Array,this.parameterTracks=new Array,this.partOpacityTracks=new Array,this.userDataBodys=new Array,this.duration=t.Meta.Duration,this.fps=t.Meta.Fps,this.loop=t.Meta.Loop,this.userDataCount=t.Meta.UserDataCount,this.totalUserDataSize=t.Meta.TotalUserDataSize,null!=t.UserData&&(t.UserData.forEach(function(t){l.userDataBodys.push(new e(t.Time,t.Value))}),console.assert(this.userDataBodys.length===this.userDataCount)),t.Curves.forEach(function(t){var e=t.Segments,i=new Array,a=new Array;i.push(new h(e[0],e[1]));for(var n=2;n<e.length;n+=3){var r=i.length-1,s=c.LINEAR,o=e[n];1==o?(s=c.BEZIER,i.push(new h(e[n+1],e[n+2])),i.push(new h(e[n+3],e[n+4])),n+=4):2==o?s=c.STEPPED:3==o&&(s=c.INVERSE_STEPPED),i.push(new h(e[n+1],e[n+2])),a.push(new p(r,s))}var u=new f(t.Id,i,a);"Model"==t.Target?l.modelTracks.push(u):"Parameter"==t.Target?l.parameterTracks.push(u):"PartOpacity"==t.Target&&l.partOpacityTracks.push(u)})}t.Animation=a;var s=(o.LINEAR=function(t,e){return t/e},o);function o(){}t.BuiltinCrossfadeWeighters=s,t.AnimationState=function(){};var u=(l.OVERRIDE=function(t,e,i,a){return e*a+t*(1-a)},l.ADD=function(t,e,i,a){return t+(e-i)*a},l.MULTIPLY=function(t,e,i){return t*(1+(e-1)*i)},l);function l(){}t.BuiltinAnimationBlenders=u;var y=(Object.defineProperty(d.prototype,"currentAnimation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"currentTime",{get:function(){return this._time},set:function(t){this._time=t},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"isPlaying",{get:function(){return this._play},enumerable:!0,configurable:!0}),d.prototype.play=function(t,e){void 0===e&&(e=0),this._animation&&0<e?(this._goalAnimation=t,this._goalTime=0,this._fadeTime=0,this._fadeDuration=e):(this._animation=t,this.currentTime=0,this._play=!0)},d.prototype.resume=function(){this._play=!0},d.prototype.pause=function(){this._play=!1},d.prototype.stop=function(){this._play=!1,this.currentTime=0},d.prototype._update=function(t){this._play&&(this._time+=t,this._goalTime+=t,this._fadeTime+=t,(null==this._animation||!this._animation.loop&&this._time>this._animation.duration)&&(this.stop(),this._animation=null))},d.prototype._evaluate=function(t,e){var i,a;null!=this._animation&&(i=this.weight<1?this.weight:1,a=null!=this._goalAnimation?i*this.weightCrossfade(this._fadeTime,this._fadeDuration):i,this._animation.evaluate(this._time,a,this.blend,t,e,this.groups),null!=this._goalAnimation&&(a=1-i*this.weightCrossfade(this._fadeTime,this._fadeDuration),this._goalAnimation.evaluate(this._goalTime,a,this.blend,t,e,this.groups),this._fadeTime>this._fadeDuration&&(this._animation=this._goalAnimation,this._time=this._goalTime,this._goalAnimation=null)))},d);function d(){this.weight=1}t.AnimationLayer=y;var m=(Object.defineProperty(g.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"isPlaying",{get:function(){var e=!1;return this._layers.forEach(function(t){t.isPlaying&&(e=!0)}),e},enumerable:!0,configurable:!0}),g.prototype.addLayer=function(t,e,i){void 0===e&&(e=u.OVERRIDE),void 0===i&&(i=1);var a=new y;a.blend=e,a.weightCrossfade=s.LINEAR,a.weight=i,a.groups=this.groups,this._layers.set(t,a)},g.prototype.getLayer=function(t){return this._layers.has(t)?this._layers.get(t):null},g.prototype.removeLayer=function(t){return this._layers.has(t)?this._layers.delete(t):null},g.prototype.clearLayers=function(){this._layers.clear()},g.prototype.updateAndEvaluate=function(e){var i=this;.001<(e*=0<this.timeScale?this.timeScale:0)&&this._layers.forEach(function(t){t._update(e)});var t=new Array(this._target.parameters.count).fill(!1),a=new Array(this._target.parts.count).fill(!1),n=new Array(t,a);this._layers.forEach(function(t){t._evaluate(i._target,n)})},g._create=function(t,e,i){i=new g(t,e,i);return i.isValid?i:null},Object.defineProperty(g.prototype,"isValid",{get:function(){return null!=this._target},enumerable:!0,configurable:!0}),g);function g(t,e,i){this._target=t,this.timeScale=e,this._layers=i}t.Animator=m;v.prototype.setTarget=function(t){return this._target=t,this},v.prototype.setTimeScale=function(t){return this._timeScale=t,this},v.prototype.addLayer=function(t,e,i){return void 0===e&&(e=u.OVERRIDE),void 0===i&&(i=1),this._layerNames.push(t),this._layerBlenders.push(e),this._layerCrossfadeWeighters.push(s.LINEAR),this._layerWeights.push(i),this},v.prototype.build=function(){for(var t=new Map,e=0;e<this._layerNames.length;++e){var i=new y;i.blend=this._layerBlenders[e],i.weightCrossfade=this._layerCrossfadeWeighters[e],i.weight=this._layerWeights[e],t.set(this._layerNames[e],i)}return m._create(this._target,this._timeScale,t)},a=v;function v(){this._timeScale=1,this._layerNames=new Array,this._layerBlenders=new Array,this._layerCrossfadeWeighters=new Array,this._layerWeights=new Array}t.AnimatorBuilder=a;var _=(b.distance=function(t,e){return Math.abs(t.substract(e).length)},b.dot=function(t,e){return t.x*e.x+t.y*e.y},Object.defineProperty(b.prototype,"length",{get:function(){return Math.sqrt(b.dot(this,this))},enumerable:!0,configurable:!0}),b.prototype.add=function(t){return new b(this.x+t.x,this.y+t.y)},b.prototype.substract=function(t){return new b(this.x-t.x,this.y-t.y)},b.prototype.multiply=function(t){return new b(this.x*t.x,this.y*t.y)},b.prototype.multiplyByScalar=function(t){return this.multiply(new b(t,t))},b.prototype.divide=function(t){return new b(this.x/t.x,this.y/t.y)},b.prototype.divideByScalar=function(t){return this.divide(new b(t,t))},b.prototype.rotateByRadians=function(t){return new b(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t))},b.prototype.normalize=function(){var t=this.length;return new b(this.x/t,this.y/t)},b.zero=new b(0,0),b);function b(t,e){this.x=t,this.y=e}t.PhysicsVector2=_;var w=(D.clampScalar=function(t,e,i){return t<e?e:i<t?i:t},D.directionToDegrees=function(t,e){var i=D.directionToRadians(t,e),i=D.radiansToDegrees(i);return 0<e.x-t.x?-i:i},D.radiansToDegrees=function(t){return 180*t/Math.PI},D.radiansToDirection=function(t){return new _(Math.sin(t),Math.cos(t))},D.degreesToRadians=function(t){return t/180*Math.PI},D.directionToRadians=function(t,e){var i=_.dot(t,e),e=t.length*e.length;if(0==e)return 0;e=i/e;return Math.abs(e)<=1?Math.acos(e):0},D.gravity=new _(0,-1),D.wind=new _(0,0),D.maximumWeight=100,D.airResistance=5,D.movementThreshold=.001,D.correctAngles=!0,D);function D(){}t.Physics=w;var B=function(t,e,i,a,n){this.initialPosition=t,this.mobility=e,this.delay=i,this.acceleration=a,this.radius=n,this.position=t,this.lastPosition=this.position,this.lastGravity=new _(0,-1),this.force=new _(0,0),this.velocity=new _(0,0)};t.PhysicsParticle=B;var T=(x.prototype.add=function(t){return new x(this.x+t.x,this.y+t.y,this.angle+t.angle)},x);function x(t,e,i){this.x=t,this.y=e,this.angle=i}t.PhysicsFactorTuple=T;var A=function(t,e,i){this.minimum=t,this.maximum=e,this.def=i};t.PhysicsNormalizationTuple=A;var E=function(t,e){this.position=t,this.angle=e};t.PhysicsNormalizationOptions=E;var P=(Object.defineProperty(S.prototype,"normalizedWeight",{get:function(){return w.clampScalar(this.weight/w.maximumWeight,0,1)},enumerable:!0,configurable:!0}),S.prototype.evaluateFactor=function(t,e,i,a,n){console.assert(e<i);var r,s,o=this.getMiddleValue(e,i),u=t-o;switch(Math.sign(u)){case 1:0==(r=i-o)?u=n.angle.def:0==(s=n.angle.maximum-n.angle.def)?u=n.angle.maximum:(u*=Math.abs(s/r),u+=n.angle.def);break;case-1:0==(r=o-e)?u=n.angle.def:0==(s=n.angle.def-n.angle.minimum)?u=n.angle.minimum:(u*=Math.abs(s/r),u+=n.angle.def);break;case 0:u=n.angle.def}t=this.weight/w.maximumWeight;return u*=this.invert?1:-1,new T(u*this.factor.x*t,u*this.factor.y*t,u*this.factor.angle*t)},S.prototype.getRangeValue=function(t,e){var i=Math.max(t,e),e=Math.min(t,e);return Math.abs(i-e)},S.prototype.getMiddleValue=function(t,e){return Math.min(t,e)+this.getRangeValue(t,e)/2},S);function S(t,e,i,a){this.targetId=t,this.weight=e,this.factor=i,this.invert=a}t.PhysicsInput=P;var I=(Object.defineProperty(M.prototype,"normalizedWeight",{get:function(){return w.clampScalar(this.weight/w.maximumWeight,0,1)},enumerable:!0,configurable:!0}),M.prototype.evaluateValue=function(t,e){var i,a=t.x*this.factor.x+t.y*this.factor.y;return 0<this.factor.angle&&(i=w.gravity,w.correctAngles&&1<this.particleIndex&&(i=e[this.particleIndex-2].position.substract(e[this.particleIndex-1].position)),e=w.directionToRadians(i,t),a+=(0<t.x-i.x?-e:e)*this.factor.angle),a*=this.invert?-1:1},M);function M(t,e,i,a,n,r){this.targetId=t,this.particleIndex=e,this.weight=i,this.factor=n,this.invert=r,this.factor.angle*=a}t.PhysicsOutput=I;var R=(V.prototype._update=function(s,t){var o=this,i=t.parameters,u=new T(0,0,0);this.input.forEach(function(t){var e=i.ids.indexOf(t.targetId);-1!=e&&(u=u.add(t.evaluateFactor(i.values[e],i.minimumValues[e],i.maximumValues[e],i.defaultValues[e],o.normalization)))});var e=w.degreesToRadians(-u.angle),t=new _(u.x,u.y).rotateByRadians(e);u.x=t.x,u.y=t.y;var l=w.radiansToDirection(e).normalize();this.particles.forEach(function(t,e){var i,a,n,r;0!=e?(t.force=l.multiplyByScalar(t.acceleration).add(w.wind),t.lastPosition=t.position,i=t.delay*s*30,n=t.position.substract(o.particles[e-1].position),r=_.distance(_.zero,n),a=w.directionToDegrees(t.lastGravity,l),a=w.degreesToRadians(a)/w.airResistance,n=n.rotateByRadians(a).normalize(),t.position=o.particles[e-1].position.add(n.multiplyByScalar(r)),n=t.velocity.multiplyByScalar(i),r=t.force.multiplyByScalar(i).multiplyByScalar(i),t.position=t.position.add(n).add(r),r=t.position.substract(o.particles[e-1].position).normalize(),t.position=o.particles[e-1].position.add(r.multiplyByScalar(t.radius)),Math.abs(t.position.x)<w.movementThreshold&&(t.position.x=0),t.velocity=0!=i?t.position.substract(t.lastPosition).divideByScalar(i).multiplyByScalar(t.mobility):_.zero,t.force=_.zero,t.lastGravity=l):t.position=new _(u.x,u.y)})},V.prototype._evaluate=function(t){var a=this,n=t.parameters;this.output.forEach(function(t){var e,i;t.particleIndex<1||t.particleIndex>=a.particles.length||-1!=(e=n.ids.indexOf(t.targetId))&&(i=a.particles[t.particleIndex-1].position.substract(a.particles[t.particleIndex].position),i=w.clampScalar(t.evaluateValue(i,a.particles),n.minimumValues[e],n.maximumValues[e]),t=n.values[e]*(1-t.normalizedWeight)+i*t.normalizedWeight,n.values[e]=w.clampScalar(t,n.minimumValues[e],n.maximumValues[e]))})},V);function V(t,e,i,a){this.input=t,this.output=e,this.particles=i,this.normalization=a}t.PhysicsSubRig=R;var O=(k.prototype.updateAndEvaluate=function(e){var i=this;.01<(e*=0<this.timeScale?this.timeScale:0)&&this._subRigs.forEach(function(t){t._update(e,i._target)}),this._subRigs.forEach(function(t){t._evaluate(i._target)})},k._fromPhysics3Json=function(t,e,i){i=new k(t,e,i);return i._isValid?i:null},Object.defineProperty(k.prototype,"_isValid",{get:function(){return null!=this._target},enumerable:!0,configurable:!0}),k);function k(t,e,i){var r=this;this.timeScale=1,this.timeScale=e,(this._target=t)&&(this._subRigs=new Array,i.PhysicsSettings.forEach(function(t){var i=new Array;t.Input.forEach(function(t){var e=new T(1,0,0);"Y"==t.Type?(e.x=0,e.y=1):"Angle"==t.Type&&(e.x=0,e.angle=1),i.push(new P(t.Source.Id,t.Weight,e,t.Reflect))});var a=new Array;t.Output.forEach(function(t){var e=new T(1,0,0);"Y"==t.Type?(e.x=0,e.y=1):"Angle"==t.Type&&(e.x=0,e.angle=1),a.push(new I(t.Destination.Id,t.VertexIndex,t.Weight,t.Scale,e,t.Reflect))});var n=new Array;t.Vertices.forEach(function(t){var e=new _(t.Position.X,t.Position.Y);n.push(new B(e,t.Mobility,t.Delay,t.Acceleration,t.Radius))});var e=t.Normalization,t=new A(e.Position.Minimum,e.Position.Maximum,e.Position.Default),e=new A(e.Angle.Minimum,e.Angle.Maximum,e.Angle.Default),e=new E(t,e);r._subRigs.push(new R(i,a,n,e))}))}t.PhysicsRig=O;U.prototype.setTarget=function(t){return this._target=t,this},U.prototype.setTimeScale=function(t){return this._timeScale=t,this},U.prototype.setPhysics3Json=function(t){return this._physics3Json=t,this},U.prototype.build=function(){return O._fromPhysics3Json(this._target,this._timeScale,this._physics3Json)},a=U;function U(){this._timeScale=1}t.PhysicsRigBuilder=a;var C=(z._fromUserData3Json=function(t,e){e=new z(t,e);return e._isValid?e:null},Object.defineProperty(z.prototype,"_isValid",{get:function(){return null!=this._target},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"userDataCount",{get:function(){return null==this._userDataBodys?0:this._userDataCount},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"totalUserDataSize",{get:function(){return null==this._userDataBodys?0:this._totalUserDataSize},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"userDataBodys",{get:function(){return null==this._userDataBodys?null:this._userDataBodys},enumerable:!0,configurable:!0}),z.prototype.isExistUserDataById=function(t){if(null==this._userDataBodys)return!1;for(var e=0,i=this._userDataBodys;e<i.length;e++)if(i[e].id===t)return!0;return!1},z.prototype.getUserDataValueById=function(t){if(null==this._userDataBodys)return null;for(var e=0,i=this._userDataBodys;e<i.length;e++){var a=i[e];if(a.id===t)return a.value}return null},z.prototype.getUserDataTargetById=function(t){if(null==this._userDataBodys)return null;for(var e=0,i=this._userDataBodys;e<i.length;e++){var a=i[e];if(a.id===t)return a.target}return null},z.prototype.getUserDataBodyById=function(t){if(null==this._userDataBodys)return null;for(var e=0,i=this._userDataBodys;e<i.length;e++){var a=i[e];if(a.id===t)return a}return null},z);function z(t,e){var i=this;(this._target=t)&&(this._version=e.Version,this._userDataCount=e.Meta.UserDataCount,this._totalUserDataSize=e.Meta.TotalUserDataSize,null!=e.UserData&&(this._userDataBodys=new Array,e.UserData.forEach(function(t){i._userDataBodys.push(new F(t.Target,t.Id,t.Value))}),console.assert(this._userDataBodys.length===this._userDataCount)))}t.UserData=C;W.prototype.setTarget=function(t){return this._target=t,this},W.prototype.setUserData3Json=function(t){return this._userData3Json=t},W.prototype.build=function(){return C._fromUserData3Json(this._target,this._userData3Json)},a=W;function W(){}t.UserDataBuilder=a;var F=function(t,e,i){this.target=t,this.id=e,this.value=i};t.UserDataBody=F;Object.defineProperty(L.prototype,"data",{get:function(){return null==this._groupBodys?null:this._groupBodys},enumerable:!0,configurable:!0}),L.fromModel3Json=function(t){return new L(t)},L.prototype.getGroupById=function(t){if(null!=this._groupBodys)for(var e=0,i=this._groupBodys;e<i.length;e++){var a=i[e];if(a.name===t)return a}return null},a=L;function L(t){var e=this;void 0!==t.Groups?(this._groupBodys=new Array,t.Groups.forEach(function(t){e._groupBodys.push(new j(t.Target,t.Name,t.Ids))})):this._groupBodys=null}t.Groups=a;var j=function(t,e,i){this.target=t,this.name=e,this.ids=i};t.GroupBody=j}(LIVE2DCUBISMFRAMEWORK=LIVE2DCUBISMFRAMEWORK||{});