<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="Shaun之所见所学所想所得"><meta name="keywords" content="algorithm,android,bigdata,c/cpp,clustering,container,css,cv,devtool,ffmpeg,geomesa,geometry,gfw,github,gl,golang,hexo,http,integration,java,k8s,language,latex,llm,mapbox,markdown,matlab,network,note,numerical,opencv,opendrive,opengl,python,qt,record,search,segmentation,tensorflow,thought,unix-like,vscode"><meta property="og:type" content="article"><meta property="og:site_name" content="Shaun&#39;s Space"><title>Shaun&#39;s Space</title><link rel="icon" href="/img/favicon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/fork-awesome/1.1.5/css/fork-awesome.min.css" integrity="sha256-P64qV9gULPHiZTdrS1nM59toStkgjM0dsf5mK/UwBV4=" crossorigin="anonymous"><script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><script src="//cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha256-ZvOgfh+ptkpoa2Y4HkRY28ir89u/+VRyDE7sB7hEEcI=" crossorigin="anonymous"></script><script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script><script src="//cdnjs.cloudflare.com/ajax/libs/pace/1.0.2/pace.min.js" integrity="sha256-EPrkNjGEmCWyazb3A/Epj+W7Qm2pB9vnfXw+X6LImPM=" crossorigin="anonymous"></script><script src="//cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><link rel="stylesheet" href="/css/style.css"><style>body{cursor:url(/img/cursor/normal.cur),auto}#navbar-toggler--btn,.code-copy,.copy-path,a,button{cursor:url(/img/cursor/link.cur),auto}#site-bg{position:fixed;left:0;top:0;width:100%;height:100%;z-index:-1;background-image:url(/img/site-bg/bg-6.jpg);background-repeat:no-repeat;background-size:100% 100%;opacity:.2;transition:background-image 3s}</style><script>const bdshareURL="/plugins/baidushare/"</script><script async type="text/javascript" src="/js/live2d/autoload.js"></script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Shaun's Space" type="application/atom+xml">
</head><body><!--[if lt IE 9]>
        <link rel="stylesheet" href="/css/ie9.css">
        <div class="alert alert-danger topframe" role="alert">
            嘿，朋友！您的浏览器已<strong>过期</strong>，不建议继续食用。
            <a target="_blank" class="alert-link" href="http://browsehappy.com">这里</a> 有些新玩意儿，何不试试？
        </div>
    <![endif]--><header id="header"><nav id="navbar" class="navbar navbar-expand-md"><div class="container"><h1 id="site-title"><a href="/" class="navbar-brand"><img src="/img/favicon.png"> <span>Shaun&#39;s Space</span></a></h1><button id="navbar-toggler--btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar"><span><i class="fa fa-list-ul" aria-hidden="true"></i></span></button><div class="collapse navbar-collapse" id="collapsibleNavbar"><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="/" title="首页" data-toggle="tooltip" data-placement="bottom"><i class="nav-icon fa fa-home"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives" title="所有文章" data-toggle="tooltip" data-placement="bottom"><i class="nav-icon fa fa-archive"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories" title="全部分类" data-toggle="tooltip" data-placement="bottom"><i class="nav-icon fa fa-folder"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags" title="全部标签" data-toggle="tooltip" data-placement="bottom"><i class="nav-icon fa fa-tags"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about" title="关于本站" data-toggle="tooltip" data-placement="bottom"><i class="nav-icon fa fa-user"></i> 关于</a></li><li class="nav-item"><a class="nav-link" href="/guide" title="Treasure Guide" data-toggle="tooltip" data-placement="bottom"><i class="nav-icon fa fa-university"></i> 导航</a></li></ul></div></div></nav></header><div class="container"><div class="row"><aside id="left-col" class="col-md-1"></aside><main class="col-lg-8 col-sm-12"><div id="site-bg"></div><article id="post-LaTex语法指北" class="article div-border"><header class="article-header"><span class="article-date article-title--index"><i class="fa fa-calendar" aria-hidden="true"></i> <a href="/posts/bcdf334e.html"><time datetime="2018-03-09T07:23:26.000Z">2018-03-09</time></a></span><section class="article-title article-title--index"><a href="/posts/bcdf334e.html">LaTex语法指北</a></section><div class="article-label"><div class="article-category label"><i class="fa fa-book" aria-hidden="true"></i> <a class="color4 article-category-link" href="/categories/Wiki/">Wiki</a></div><div class="article-tag label"><i class="fa fa-bookmark" aria-hidden="true"></i> <a class="color4 article-tag-none-link" href="/tags/latex/" rel="tag">latex</a><a class="color4 article-tag-none-link" href="/tags/note/" rel="tag">note</a></div></div></header><section class="article-content"><div class="article-content--excerpt"><h2 id="前言">前言</h2><p>　　本文就简单记录一下使用 LaTex 可能会用到的一些语法，LaTex 的语法公式需要用符号 <code>$</code> 括起来，其中 <code>$...$</code> 代表行内公式，<code>$$...$$</code> 代表行间公式。</p></div><div class="article-content--all"><h2 id="前言">前言</h2><p>　　本文就简单记录一下使用 LaTex 可能会用到的一些语法，LaTex 的语法公式需要用符号 <code>$</code> 括起来，其中 <code>$...$</code> 代表行内公式，<code>$$...$$</code> 代表行间公式。</p><span id="more"></span><h2 id="常用篇">常用篇</h2><h3 id="数学符号">§ 数学符号</h3><table><colgroup><col style="width:6%"><col style="width:18%"><col style="width:18%"><col style="width:6%"><col style="width:24%"><col style="width:24%"></colgroup><thead><tr class="header"><th style="text-align:left">名称</th><th style="text-align:center">示例</th><th style="text-align:center">预览</th><th style="text-align:left">名称</th><th style="text-align:center">示例</th><th style="text-align:center">预览</th></tr></thead><tbody><tr class="odd"><td style="text-align:left"><strong>属于</strong></td><td style="text-align:center"><code>\in</code></td><td style="text-align:center"><span class="math inline">\(\in\)</span></td><td style="text-align:left"><strong>不属于</strong></td><td style="text-align:center"><code>\notin</code></td><td style="text-align:center"><span class="math inline">\(\notin\)</span></td></tr><tr class="even"><td style="text-align:left"><strong>并集</strong></td><td style="text-align:center"><code>\cup</code> 或 <code>\bigcup</code></td><td style="text-align:center"><span class="math inline">\(\cup\)</span> 或 <span class="math inline">\(\bigcup\)</span></td><td style="text-align:left"><strong>交集</strong></td><td style="text-align:center"><code>\cap</code> 或 <code>\bigcap</code></td><td style="text-align:center"><span class="math inline">\(\cap\)</span> 或 <span class="math inline">\(\bigcap\)</span></td></tr><tr class="odd"><td style="text-align:left"><strong>包含于</strong></td><td style="text-align:center"><code>\subset</code></td><td style="text-align:center"><span class="math inline">\(\subset\)</span></td><td style="text-align:left"><strong>真包含于</strong></td><td style="text-align:center"><code>\subsetneqq</code></td><td style="text-align:center"><span class="math inline">\(\subsetneqq\)</span></td></tr><tr class="even"><td style="text-align:left"><strong>包含</strong></td><td style="text-align:center"><code>\supset</code></td><td style="text-align:center"><span class="math inline">\(\supset\)</span></td><td style="text-align:left"><strong>真包含</strong></td><td style="text-align:center"><code>\supsetneqq</code></td><td style="text-align:center"><span class="math inline">\(\supsetneqq\)</span></td></tr><tr class="odd"><td style="text-align:left"><strong>不包含于</strong></td><td style="text-align:center"><code>\not\subset</code></td><td style="text-align:center"><span class="math inline">\(\not\subset\)</span></td><td style="text-align:left"><strong>空集</strong></td><td style="text-align:center"><code>\emptyset</code></td><td style="text-align:center"><span class="math inline">\(\emptyset\)</span></td></tr><tr class="even"><td style="text-align:left"><strong>左大括号</strong></td><td style="text-align:center"><code>\&#123;</code></td><td style="text-align:center"><span class="math inline">\(\{\)</span></td><td style="text-align:left"><strong>右大括号</strong></td><td style="text-align:center"><code>\&#125;</code></td><td style="text-align:center"><span class="math inline">\(\}\)</span></td></tr><tr class="odd"><td style="text-align:left"><strong>正比于</strong></td><td style="text-align:center"><code>\propto</code></td><td style="text-align:center"><span class="math inline">\(\propto\)</span></td><td style="text-align:left"><strong>省略号</strong></td><td style="text-align:center"><code>\cdots</code> 或 <code>\ddots</code> 或 <code>\vdots</code></td><td style="text-align:center"><span class="math inline">\(\cdots\)</span> 或 <span class="math inline">\(\ddots\)</span> 或 <span class="math inline">\(\vdots\)</span></td></tr><tr class="even"><td style="text-align:left"><strong>不等于</strong></td><td style="text-align:center"><code>\neq</code></td><td style="text-align:center"><span class="math inline">\(\neq\)</span></td><td style="text-align:left"><strong>等价于</strong></td><td style="text-align:center"><code>\Leftrightarrow</code> 或 <code>\Longleftrightarrow</code></td><td style="text-align:center"><span class="math inline">\(\Leftrightarrow\)</span> 或 <span class="math inline">\(\Longleftrightarrow\)</span></td></tr><tr class="odd"><td style="text-align:left"><strong>左推出</strong></td><td style="text-align:center"><code>\Leftarrow</code> 或 <code>\Longleftarrow</code></td><td style="text-align:center"><span class="math inline">\(\Leftarrow\)</span> 或 <span class="math inline">\(\Longleftarrow\)</span></td><td style="text-align:left"><strong>右推出</strong></td><td style="text-align:center"><code>\Rightarrow</code> 或 <code>\Longrightarrow</code></td><td style="text-align:center"><span class="math inline">\(\Rightarrow\)</span> 或 <span class="math inline">\(\Longrightarrow\)</span></td></tr><tr class="even"><td style="text-align:left"><strong>大于等于</strong></td><td style="text-align:center"><code>\ge</code> 或 <code>\geq</code></td><td style="text-align:center"><span class="math inline">\(\ge\)</span> 或 <span class="math inline">\(\geq\)</span></td><td style="text-align:left">小于等于</td><td style="text-align:center"><code>\le</code> 或 <code>\leq</code></td><td style="text-align:center"><span class="math inline">\(\le\)</span> 或 <span class="math inline">\(\leq\)</span></td></tr></tbody></table><h3 id="希腊字母">§ 希腊字母</h3><table><colgroup><col style="width:13%"><col style="width:24%"><col style="width:24%"><col style="width:6%"><col style="width:15%"><col style="width:15%"></colgroup><thead><tr class="header"><th style="text-align:left">名称</th><th style="text-align:center">示例（小写和大写）</th><th style="text-align:center">预览（小写和大写）</th><th style="text-align:left">名称</th><th style="text-align:center">示例（小写和大写）</th><th style="text-align:center">预览（小写和大写）</th></tr></thead><tbody><tr class="odd"><td style="text-align:left"><strong>alpha</strong></td><td style="text-align:center"><code>\alpha</code> 和<code>\Alpha</code></td><td style="text-align:center"><span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\Alpha\)</span></td><td style="text-align:left"><strong>beta</strong></td><td style="text-align:center"><code>\beta</code> 和 <code>\Beta</code></td><td style="text-align:center"><span class="math inline">\(\beta\)</span> 和 <span class="math inline">\(\Beta\)</span></td></tr><tr class="even"><td style="text-align:left"><strong>gamma</strong></td><td style="text-align:center"><code>\gamma</code> 和 <code>\Gamma</code></td><td style="text-align:center"><span class="math inline">\(\gamma\)</span> 和 <span class="math inline">\(\Gamma\)</span></td><td style="text-align:left"><strong>delta</strong></td><td style="text-align:center"><code>\delta</code> 和 <code>\Delta</code></td><td style="text-align:center"><span class="math inline">\(\delta\)</span> 和 <span class="math inline">\(\Delta\)</span></td></tr><tr class="odd"><td style="text-align:left"><strong>theta</strong></td><td style="text-align:center"><code>\theta</code> 、 <code>\vartheta</code> 和 <code>\Theta</code></td><td style="text-align:center"><span class="math inline">\(\theta\)</span> 、 <span class="math inline">\(\vartheta\)</span> 和 <span class="math inline">\(\Theta\)</span></td><td style="text-align:left"><strong>lambda</strong></td><td style="text-align:center"><code>\lambda</code> 和 <code>\Lambda</code></td><td style="text-align:center"><span class="math inline">\(\lambda\)</span> 和 <span class="math inline">\(\Lambda\)</span></td></tr><tr class="even"><td style="text-align:left"><strong>mu</strong></td><td style="text-align:center"><code>\mu</code> 和 <code>\Mu</code></td><td style="text-align:center"><span class="math inline">\(\mu\)</span> 和 <span class="math inline">\(\Mu\)</span></td><td style="text-align:left"><strong>pi</strong></td><td style="text-align:center"><code>\pi</code> 和 <code>\Pi</code></td><td style="text-align:center"><span class="math inline">\(\pi\)</span> 和 <span class="math inline">\(\Pi\)</span></td></tr><tr class="odd"><td style="text-align:left"><strong>sigma</strong></td><td style="text-align:center"><code>\sigma</code> 和 <code>\Sigma</code></td><td style="text-align:center"><span class="math inline">\(\sigma\)</span> 和 <span class="math inline">\(\Sigma\)</span></td><td style="text-align:left"><strong>omega</strong></td><td style="text-align:center"><code>\omega</code> 和 <code>\Omega</code></td><td style="text-align:center"><span class="math inline">\(\omega\)</span> 和 <span class="math inline">\(\Omega\)</span></td></tr><tr class="even"><td style="text-align:left"><strong>chi（卡方分布）</strong></td><td style="text-align:center"><code>\chi</code> 和 <code>\Chi</code></td><td style="text-align:center"><span class="math inline">\(\chi\)</span> 和 <span class="math inline">\(\Chi\)</span></td><td style="text-align:left"><strong>phi</strong></td><td style="text-align:center"><code>\phi</code> 和 <code>\Phi</code></td><td style="text-align:center"><span class="math inline">\(\phi\)</span> 和 <span class="math inline">\(\Phi\)</span></td></tr></tbody></table><h3 id="运算符">§ 运算符</h3><table><thead><tr class="header"><th>名称</th><th style="text-align:center">示例</th><th style="text-align:center">预览</th><th>名称</th><th style="text-align:center">示例</th><th style="text-align:center">预览</th></tr></thead><tbody><tr class="odd"><td><strong>点乘</strong></td><td style="text-align:center"><code>\cdot</code></td><td style="text-align:center"><span class="math inline">\(\cdot\)</span></td><td><strong>叉乘</strong></td><td style="text-align:center"><code>\times</code></td><td style="text-align:center"><span class="math inline">\(\times\)</span></td></tr><tr class="even"><td><strong>除号</strong></td><td style="text-align:center"><code>\div</code></td><td style="text-align:center"><span class="math inline">\(\div\)</span></td><td><strong>分数</strong></td><td style="text-align:center"><code>\frac&#123;c&#125;&#123;a+b&#125;</code></td><td style="text-align:center"><span class="math inline">\(\frac{c}{a+b}\)</span></td></tr><tr class="odd"><td><strong>累加</strong></td><td style="text-align:center"><code>\sum</code></td><td style="text-align:center"><span class="math inline">\(\sum\)</span></td><td><strong>累乘</strong></td><td style="text-align:center"><code>\prod</code></td><td style="text-align:center"><span class="math inline">\(\prod\)</span></td></tr><tr class="even"><td></td><td style="text-align:center"></td><td style="text-align:center"></td><td><strong>积分</strong></td><td style="text-align:center"><code>\int</code></td><td style="text-align:center"><span class="math inline">\(\int\)</span></td></tr></tbody></table><h2 id="特殊篇">特殊篇</h2><h3 id="公式书写">§ 公式书写</h3><table><colgroup><col style="width:18%"><col style="width:40%"><col style="width:40%"></colgroup><thead><tr class="header"><th>名称</th><th>示例</th><th>预览</th></tr></thead><tbody><tr class="odd"><td><strong>大括号多行公式</strong></td><td><code>\begin&#123;cases&#125; x=v , \\ y=w \end&#123;cases&#125;</code></td><td><span class="math inline">\(\begin{cases} x=v , \\ y=w \end{cases}\)</span></td></tr><tr class="even"><td></td><td></td><td></td></tr><tr class="odd"><td></td><td></td><td></td></tr></tbody></table><h3 id="矩阵书写">§ 矩阵书写</h3><p>示例语法：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="PLAINTEXT"><div class="code-copy"></div><figure class="highlight hljs plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">\begin&#123;matrix&#125;</span><br><span class="line">  1 &amp; 2 &amp; 3 \\</span><br><span class="line">  4 &amp; 5 &amp; 6 \\</span><br><span class="line">  7 &amp; 8 &amp; 9</span><br><span class="line">\end&#123;matrix&#125;</span><br><span class="line">\quad</span><br><span class="line">\begin&#123;bmatrix&#125; 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end&#123;bmatrix&#125;</span><br><span class="line">\quad</span><br><span class="line">\begin&#123;Bmatrix&#125; 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end&#123;Bmatrix&#125;</span><br><span class="line">\quad</span><br><span class="line">\begin&#123;pmatrix&#125; 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end&#123;pmatrix&#125;</span><br><span class="line">\quad</span><br><span class="line">\begin&#123;vmatrix&#125; 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end&#123;vmatrix&#125;</span><br><span class="line">\qquad</span><br><span class="line">\begin&#123;Vmatrix&#125; 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end&#123;Vmatrix&#125;</span><br></pre></td></tr></table></figure></div><p>显示效果： <span class="math display">\[ \begin{matrix} 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end{matrix} \quad \begin{bmatrix} 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end{bmatrix} \quad \begin{Bmatrix} 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end{Bmatrix} \quad \begin{pmatrix} 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end{pmatrix} \quad \begin{vmatrix} 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end{vmatrix} \quad \begin{Vmatrix} 1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \\ 7 &amp; 8 &amp; 9 \end{Vmatrix} \]</span></p><h2 id="扩展篇">扩展篇</h2><h2 id="技巧篇">技巧篇</h2><p><strong>将下标放在正下方：</strong></p><p>将普通下标 <code>\max_&#123;x&lt;y&#125;</code> <span class="math inline">\(\max_{x&lt;y}\)</span> 改为 <code>\max\limits_&#123;x&lt;y&#125;</code> <span class="math inline">\(\max\limits_{x&lt;y}\)</span>，即在下标符号 <code>_</code> 前添加 <code>\limits</code>。</p><p><strong>至于分块矩阵的虚线可参考：</strong> <a target="_blank" rel="noopener" href="http://www.biwako.shiga-u.ac.jp/sensei/kumazawa/tex/form012.html">数式: 行列、ベクトル matrix, vector TeX</a></p><p><strong>字符加粗：</strong> 通过 <code>\mathbf&#123;X&#125;</code>， eg. <span class="math inline">\(\mathbf{X}\)</span> 和 <span class="math inline">\(X\)</span> ,</p><h2 id="后记">后记</h2><p>　　写 Wiki 毕竟不是一蹴而就的事，等以后碰到一些常用的或有时间在继续更新吧 ↖(^ ω ^)↗。</p><h2 id="参考资料">参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="http://mohu.org/info/symbols/symbols.htm">常用数学符号的 LaTeX 表示方法</a></p><p>[2] <a target="_blank" rel="noopener" href="https://blog.csdn.net/xxzhangx/article/details/52778539">latex中的希腊字母</a></p><p>[3] <a target="_blank" rel="noopener" href="https://blog.csdn.net/perfumekristy/article/details/8816340">Latex中将下标放在正下方</a></p></div><div class="article-content-more"><button type="button" class="article-more--link"><i class="fa fa-angle-double-down fa-3x" aria-hidden="true"></i></button></div></section></article><article id="post-搜索技巧" class="article div-border"><header class="article-header"><span class="article-date article-title--index"><i class="fa fa-calendar" aria-hidden="true"></i> <a href="/posts/982ff584.html"><time datetime="2018-02-28T08:36:26.000Z">2018-02-28</time></a></span><section class="article-title article-title--index"><a href="/posts/982ff584.html">搜索技巧</a></section><div class="article-label"><div class="article-category label"><i class="fa fa-book" aria-hidden="true"></i> <a class="color1 article-category-link" href="/categories/Study/">Study</a></div><div class="article-tag label"><i class="fa fa-bookmark" aria-hidden="true"></i> <a class="color4 article-tag-none-link" href="/tags/search/" rel="tag">search</a></div></div></header><section class="article-content"><div class="article-content--excerpt"><h2 id="前言">前言</h2><p>　　Shaun 一直以为自己的搜索能力还可以，基本上自己想要的东西都能搜到，但是自从接触到这个世界，才知道自己大概只是个入门的水平（或者说连入门都说不上 /つ∇T)），和网上的一些大神相比还有比较大的差距，此文只是网上一些资料的整理，方便 Shaun 熟练使用，提高驾驶技巧，毕竟信息检索能力还是很重要的。</p></div><div class="article-content--all"><h2 id="前言">前言</h2><p>　　Shaun 一直以为自己的搜索能力还可以，基本上自己想要的东西都能搜到，但是自从接触到这个世界，才知道自己大概只是个入门的水平（或者说连入门都说不上 /つ∇T)），和网上的一些大神相比还有比较大的差距，此文只是网上一些资料的整理，方便 Shaun 熟练使用，提高驾驶技巧，毕竟信息检索能力还是很重要的。</p><span id="more"></span><h2 id="搜索篇">搜索篇</h2><p>Google 可以通过添加一些字符优化搜索结果，如：</p><table><colgroup><col style="width:43%"><col style="width:56%"></colgroup><thead><tr class="header"><th style="text-align:center">搜索需求</th><th style="text-align:center">对应字符</th></tr></thead><tbody><tr class="odd"><td style="text-align:center"><strong>搜索社交媒体</strong></td><td style="text-align:center">在用于搜索社交媒体的字词前加上 <code>@</code>。例如：<code>@twitter</code>。</td></tr><tr class="even"><td style="text-align:center"><strong>从搜索结果中排除特定字词</strong></td><td style="text-align:center">在您要排除的字词前加上 <code>-</code>。例如：<code>jaguar speed -car</code></td></tr><tr class="odd"><td style="text-align:center"><strong>搜索完全匹配的结果</strong></td><td style="text-align:center">为字词或短语加上引号。例如：<code>"tallest building"</code>。</td></tr><tr class="even"><td style="text-align:center"><strong>搜索通配符或未知字词</strong></td><td style="text-align:center">在字词或短语中您要放置占位符的地方加上 <code>*</code>。例如：<code>"largest * in the world"</code>。</td></tr><tr class="odd"><td style="text-align:center"><strong>在某个数字范围内执行搜索</strong></td><td style="text-align:center">在两个数字之间加上 <code>..</code>。例如：<code>camera $50..$100</code></td></tr><tr class="even"><td style="text-align:center"><strong>组合搜索</strong></td><td style="text-align:center">在各个搜索查询之间加上“<code>OR</code>”。例如：<code>marathon OR race</code></td></tr><tr class="odd"><td style="text-align:center"><strong>搜索特定网站</strong></td><td style="text-align:center">在相应网站或域名前加上“<code>site:</code>”。例如：<code>site:youtube.com</code>或 <code>site:.gov</code></td></tr><tr class="even"><td style="text-align:center"><strong>搜索相关网站</strong></td><td style="text-align:center">在已知网址前加上“<code>related:</code>”。例如：<code>related:time.com</code></td></tr><tr class="odd"><td style="text-align:center"><strong>查找链接到某个特定网页的网页</strong></td><td style="text-align:center">在已知网址前加上“<code>link:</code>”。例如：<code>link:chongbuluo.com</code>，就能查到哪些网页中包含链接<code>chongbuluo.com</code></td></tr><tr class="even"><td style="text-align:center"><strong>查找在URL地址里有搜索关键词的页面</strong></td><td style="text-align:center">在已知网址前加上“<code>inurl:</code>”。例如：<code>inurl:chongbuluo</code>，就能查到哪些网页 url 中包含链接<code>chongbuluo</code></td></tr><tr class="odd"><td style="text-align:center"><strong>查找在网页标题里有搜索关键词的页面</strong></td><td style="text-align:center">在已知网址前加上“<code>intitle:</code>”。例如：<code>intitle:chongbuluo</code>，就能查到哪些网页标题中包含链接<code>chongbuluo</code></td></tr><tr class="even"><td style="text-align:center"><strong>查找在网页正文里有搜索关键词的页面</strong></td><td style="text-align:center">在已知网址前加上“<code>intext:</code>”。例如：<code>intext:chongbuluo</code>，就能查到哪些网页正文中包含链接<code>chongbuluo</code></td></tr><tr class="odd"><td style="text-align:center"><strong>查找pdf,xml,xls,txt,doc,csv等特定格式的结果</strong></td><td style="text-align:center">在特定文件格式前加上<code>filetype:</code>。例如 <code>filetype:pdf</code></td></tr><tr class="even"><td style="text-align:center"><strong>查找关键词的定义</strong></td><td style="text-align:center">在关键词前加上<code>define:</code>。例如 <code>define:搜索</code></td></tr></tbody></table><p>　　经 Shaun 实测，以上大部分字符对百度搜索引擎同样适用。当然，最好的搜索方式是使用高级搜索，高级搜索可以进行一系列设置，比如时间范围，从而使搜索结果更精确，更容易得到想要的结果，不过在不十分确定的时候，不要做太多限制，不然可能会过滤掉关键信息。</p><p>　　Google 和百度对英文字符大小写都不敏感，搜索 <strong>QQ</strong> 与 <strong>qq</strong> 所得到的结果是一样的。搜索是否成功最关键的地方还是在于关键词的选取，关键词的选取这没什么好说的，只能提高搜索熟练度及对问题的把握程度了。</p><p>　　哦，还有一点忘记说了，就是在 Google 中如果要搜索那个的话，必须要在搜索设置里面关闭安全搜索功能，如果简体中文不能关闭安全搜索功能的话，就在搜索设置里将语言更换到繁体中文或英语应该就能关闭安全搜索功能。</p><h2 id="技巧篇">技巧篇</h2><p>　　有时候第一个页面没有想要的结果，于是需要看第二个、第三个页面的结果，是不是觉得翻页很麻烦？（如果不觉得麻烦可以直接跳过🙄），但是设置增加搜索结果条目又会提高显示延迟，这时可以使用 <a target="_blank" rel="noopener" href="https://greasyfork.org/zh-CN/scripts/10433-super-preloaderplus-one">Super_preloaderPlus_one</a> 脚本（Chrome 中可以使用 <a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/autopagerize/igiofjhpmpihnifddepnpngfjhkfenbp?utm_source=chrome-app-launcher-info-dialog">AutoPagerize</a> 插件），只需鼠标继续往下滚轮就会自动加载下页搜索结果，无需点击翻页。</p><p>　　当点击网页链接却出现404错误或无法显示页面的错误时，这个时候可以使用搜索引擎的「网页快照」功能，Google的这个功能点击搜索结果页面标题下的 绿色小三角 即可看到，百度的这个叫 百度快照，在搜索结果 url 地址的末端，即结果最后面。快照功能最强大的是 <a target="_blank" rel="noopener" href="https://archive.org/">互联网档案馆</a>（<strong>Internet Archive</strong>），又叫『网站时光倒流机器』（<strong>Wayback Machine</strong>），在知道链接的情况下，将链接输入到 <strong>Internet Archive</strong> 点击搜索就能查看历史快照了。</p><p>　　如果要查找某个网页出现的关键词，可以利用 Chrome 和 Firefox 的网页搜索功能，一般可以通过 <strong><code>Ctrl + F</code></strong> 去检索。也可以通过 <strong><code>F12</code></strong> 或「鼠标右键」（Firefox 点击「查看元素」，Chrome 点击「检查」，都是右键弹框最后一个选项）进入浏览器控制台开发工具，Chrome 中还要通过 <strong><code>Ctrl + F</code></strong> 才能检索元素，而 Firefox 可以直接搜索 HTML，输入要查找的关键词，回车即可。</p><h2 id="专项篇">专项篇</h2><p>　　<strong>图像搜索：</strong>这个一般用 Google 和百度的以图搜图就可以了，不过也有些特殊的图像搜索引擎，如 <a target="_blank" rel="noopener" href="https://www.tineye.com/">TinEye</a> 等，当然，图像搜索最好还是安装相应的插件，在 Chrome 中可以安装一个叫 <a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/noobox/kidibbfcblfbbafhnlanccjjdehoahep?utm_source=chrome-app-launcher-info-dialog">二箱</a> 的插件，在 Firefox 中可以安装一个叫 <a target="_blank" rel="noopener" href="https://addons.mozilla.org/zh-CN/firefox/addon/search_by_image/?src=userprofile">Search by Image</a> 的插件。</p><p>　　<strong>音乐搜索：</strong>这个如果能听出歌词的话就直接去搜索引擎上搜听到的歌词，如果无法听出歌词的话，可以尝试各大音乐软件的「听歌识曲」功能。</p><p>　　当然更精确的专项搜索一般只存在于特定的网站，这就要看对整个互联网的了解程度了，这里强推「<a target="_blank" rel="noopener" href="http://search.chongbuluo.com/">虫部落-快搜</a>」，不管是日常搜索需求还是特殊搜索需求基本都能满足。</p><h2 id="后记">后记</h2><p>　　尽量优先使用 Google，百度或许能找到自己想要的，但太浪费时间了，浪费时间就是浪费生命，不过能看到本文的看官，应该也是能熟练使用 Google 的了。</p><h2 id="参考资料">参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="https://support.google.com/websearch/answer/134479">如何在 Google 中进行搜索</a>(<a target="_blank" rel="noopener" href="https://support.google.com/websearch/#topic=3081620" class="uri">https://support.google.com/websearch/#topic=3081620</a>)</p><p>[2] <a target="_blank" rel="noopener" href="https://support.google.com/websearch/answer/2466433">优化网页搜索</a></p><p>[3] <a target="_blank" rel="noopener" href="http://www.chongbuluo.com/forum.php?mod=viewthread&amp;tid=3041">提高搜索能力的关键技巧（如何查找可靠出处）</a></p><p>[4] <a target="_blank" rel="noopener" href="http://www.chongbuluo.com/forum.php?mod=viewthread&amp;tid=1796">谷歌搜索技巧：搜索语法+隐藏彩蛋+高级设置</a></p></div><div class="article-content-more"><button type="button" class="article-more--link"><i class="fa fa-angle-double-down fa-3x" aria-hidden="true"></i></button></div></section></article><article id="post-矩阵的应用之图像仿射变换" class="article div-border"><header class="article-header"><span class="article-date article-title--index"><i class="fa fa-calendar" aria-hidden="true"></i> <a href="/posts/e124baa1.html"><time datetime="2018-01-20T13:21:16.000Z">2018-01-20</time></a></span><section class="article-title article-title--index"><a href="/posts/e124baa1.html">矩阵的应用之图像仿射变换</a></section><div class="article-label"><div class="article-category label"><i class="fa fa-book" aria-hidden="true"></i> <a class="color2 article-category-link" href="/categories/Image-Graphic/">Image&Graphic</a></div><div class="article-tag label"><i class="fa fa-bookmark" aria-hidden="true"></i> <a class="color1 article-tag-none-link" href="/tags/algorithm/" rel="tag">algorithm</a><a class="color1 article-tag-none-link" href="/tags/matlab/" rel="tag">matlab</a><a class="color1 article-tag-none-link" href="/tags/opencv/" rel="tag">opencv</a></div></div></header><section class="article-content"><div class="article-content--excerpt"><h2 id="前言">前言</h2><p>　　好像很久没写新的东西了，主要是最近期末有一大堆事情要做，忙着写各种结课论文和复习数学，又加上最近忙着把《奥日与黑暗森林：终极版》剧情通关，这游戏不管是画面还是音乐都特别棒，但是对键盘用户太不友好了，不能改键位，需要一只手控制键盘，一只手控制鼠标，如果只是普通的键位就算了，它还要万恶的 shift 键配合，手残党完全吃不消 (´･ω･`)。最终死亡 658 次好歹剧情通关了，最后悔的是没把三段跳点出来 /つ∇T)。这些事情一搞完，Shaun 这不就又开始写了嘛（ 说什么也摆脱不了你拖延症晚期的事实 (￣ε(#￣)☆╰╮(￣▽￣///) ）。 选修的《数字图像处理》是也早结课了，虽然教的东西大都事前已经了解了，但是好像还没写过图像处理相关的 blog，所以谨以此篇最基础的 blog 来表示一下。</p></div><div class="article-content--all"><h2 id="前言">前言</h2><p>　　好像很久没写新的东西了，主要是最近期末有一大堆事情要做，忙着写各种结课论文和复习数学，又加上最近忙着把《奥日与黑暗森林：终极版》剧情通关，这游戏不管是画面还是音乐都特别棒，但是对键盘用户太不友好了，不能改键位，需要一只手控制键盘，一只手控制鼠标，如果只是普通的键位就算了，它还要万恶的 shift 键配合，手残党完全吃不消 (´･ω･`)。最终死亡 658 次好歹剧情通关了，最后悔的是没把三段跳点出来 /つ∇T)。这些事情一搞完，Shaun 这不就又开始写了嘛（ 说什么也摆脱不了你拖延症晚期的事实 (￣ε(#￣)☆╰╮(￣▽￣///) ）。 选修的《数字图像处理》是也早结课了，虽然教的东西大都事前已经了解了，但是好像还没写过图像处理相关的 blog，所以谨以此篇最基础的 blog 来表示一下。</p><span id="more"></span><h2 id="预备篇">预备篇</h2><p>　　首先需要了解的是图像中坐标系和数学课本中常用的坐标系略有不同，图像中坐标系是以左上角为原点，水平向右为 X 轴，垂直向下为 Y 轴；而数学课本中常见的坐标系是以图像中心为原点，水平向右为 X 轴，垂直向上为 Y 轴。所以由图像中坐标 <span class="math inline">\((x,y)\)</span> 转数学课本中常见的坐标 <span class="math inline">\((x&#39;,y&#39;)\)</span> 的公式为 $x' = x - C/2; y' = -y + R/2; $ 其中 <span class="math inline">\(C\)</span> 表示原图像总列数，即原图像宽度，<span class="math inline">\(R\)</span> 表示原图像总行数，即原图像高度。</p><div style="text-align:center;font-weight:700;margin:.5em auto"><svg width="346px" height="160px"><defs><marker id="arrow" markerWidth="9" markerHeight="6" refx="0" refy="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="#000"/></marker></defs><line x1="25" y1="62" x2="125" y2="62" stroke="#000" stroke-width="1" marker-end="url(#arrow)"/><line x1="75" y1="100" x2="75" y2="25" stroke="#000" stroke-width="1" marker-end="url(#arrow)"/><text x="126" y="56" fill="blue">X 轴</text><text x="75" y="20" fill="blue">Y 轴</text><line x1="210" y1="25" x2="310" y2="25" stroke="#000" stroke-width="1" marker-end="url(#arrow)"/><line x1="210" y1="25" x2="210" y2="100" stroke="#000" stroke-width="1" marker-end="url(#arrow)"/><text x="310" y="42" fill="blue">X 轴</text><text x="215" y="110" fill="blue">Y 轴</text><text x="40" y="150" fill="blue">数学坐标系</text><text x="240" y="150" fill="blue">图像坐标系</text></svg></div><p>　　<font color="#FA8072"><strong>※注：</strong>值得注意的是因为 MATLAB 和 OpenCV 的像素索引坐标形式为 <strong><em>(行坐标，列坐标)</em></strong> ，所以若以本文这样定的图像坐标，则图像中坐标 <span class="math inline">\((x,y)\)</span> 对应的像素值为 <span class="math inline">\(f(y,x)\)</span>。</font></p><h2 id="变换篇">变换篇</h2><p>据 OpenCV 文档所说：</p><blockquote><ol type="1"><li><p>一个任意的仿射变换都能表示为 <em>乘以一个矩阵</em> (线性变换) 接着再 <em>加上一个向量</em> (平移).</p></li><li><p>综上所述, 我们能够用仿射变换来表示:</p><ol type="1"><li>旋转 (线性变换)</li><li>平移 (向量加)</li><li>缩放操作 (线性变换)</li></ol><p>你现在可以知道, 事实上, 仿射变换代表的是两幅图之间的 <strong>关系</strong> .</p></li><li><p>我们通常使用 <img src="http://www.opencv.org.cn/opencvdoc/2.3.2/html/_images/math/a832b76c4f4a4ec13ac1b557da4fed6006e64d00.png" alt="2 "> 矩阵来表示仿射变换.</p><p><img src="http://www.opencv.org.cn/opencvdoc/2.3.2/html/_images/math/c3fdaa7031379552454b333ff916cd1987107b5c.png" alt="A = \begin{bmatrix}     a_{00} &amp; a_{01} \\     a_{10} &amp; a_{11}     \end{bmatrix}_{2 \times 2} B = \begin{bmatrix}     b_{00} \\     b_{10}     \end{bmatrix}_{2 \times 1} M = \begin{bmatrix}     A &amp; B     \end{bmatrix} =\begin{bmatrix}     a_{00} &amp; a_{01} &amp; b_{00} \\     a_{10} &amp; a_{11} &amp; b_{10}\end{bmatrix}_{2 \times 3}">　　</p><p>考虑到我们要使用矩阵 <img src="http://www.opencv.org.cn/opencvdoc/2.3.2/html/_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A"> 和 <img src="http://www.opencv.org.cn/opencvdoc/2.3.2/html/_images/math/ff5fb3d775862e2123b007eb4373ff6cc1a34d4e.png" alt="B"> 对二维向量 <img src="http://www.opencv.org.cn/opencvdoc/2.3.2/html/_images/math/22671b2dfac15c46b634f068e4ccd644551abd8a.png" alt="X = \begin-{bmatrix}x \ y\end-{bmatrix}"> 做变换, 所以也能表示为下列形式:</p><p><img src="http://www.opencv.org.cn/opencvdoc/2.3.2/html/_images/math/7b0b4b830b85f222266aa9c8fc76e1a7ce998c42.png" alt="T = A \begin-{bmatrix}x \ y\end-{bmatrix} + B"> or <img src="http://www.opencv.org.cn/opencvdoc/2.3.2/html/_images/math/f44f98e19b4ee0613633b70414a47259846b2d27.png" alt="T = M ^{T}"></p><p><img src="http://www.opencv.org.cn/opencvdoc/2.3.2/html/_images/math/3295a3e90f963d7a35c1cd910b9258cd92761a8f.png" alt="T=\begin-{bmatrix}a_{00}x + a_{01}y + b_{00} \ a_{10}x + a_{11}y + b_{10}\end-{bmatrix}">　　</p></li></ol></blockquote><p>而在冈萨雷斯的《数字图像处理_第三版》里有：</p><blockquote><p>最常用的空间坐标变换之一是仿射变换，其一般形式如下： <span class="math display">\[ \begin{bmatrix} x &amp; y &amp; 1 \end{bmatrix} = \begin{bmatrix} v &amp; w &amp; 1 \end{bmatrix} \textbf{T} = \begin{bmatrix} v &amp; w &amp; 1 \end{bmatrix} \begin{bmatrix} t_{11} &amp; t_{12} &amp; 0 \\ t_{21} &amp; t_{22} &amp; 0 \\ t_{31} &amp; t_{32} &amp; 1 \end{bmatrix} \]</span> 其中 <span class="math inline">\((v,w)\)</span> 为原坐标，<span class="math inline">\((x,y)\)</span> 为变换后的坐标，可根据变换矩阵 <span class="math inline">\(\textbf{T}\)</span> 中的元素选择的值，对一组坐标点做尺度、旋转、平移或偏移变换。一些常见的变换矩阵及作用如下表：</p><table><colgroup><col style="width:16%"><col style="width:41%"><col style="width:41%"></colgroup><thead><tr class="header"><th style="text-align:center">变换名称</th><th style="text-align:center">仿射变换矩阵<span class="math inline">\(\textbf{T}\)</span></th><th style="text-align:center">坐标公式</th></tr></thead><tbody><tr class="odd"><td style="text-align:center"><strong>恒等变换</strong></td><td style="text-align:center"><span class="math inline">\(\begin{bmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{bmatrix}\)</span></td><td style="text-align:center"><span class="math inline">\(\begin{cases} x=v , \\ y=w \end{cases}\)</span></td></tr><tr class="even"><td style="text-align:center"><strong>尺度变换</strong></td><td style="text-align:center"><span class="math inline">\(\begin{bmatrix} c_x &amp; 0 &amp; 0 \\ 0 &amp; c_y &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{bmatrix}\)</span></td><td style="text-align:center"><span class="math inline">\(\begin{cases} x=vc_x , \\ y=wc_y \end{cases}\)</span></td></tr><tr class="odd"><td style="text-align:center"><strong>旋转变换</strong>（以逆时针为正）</td><td style="text-align:center"><span class="math inline">\(\begin{bmatrix} cos(\theta) &amp; sin(\theta) &amp; 0 \\ -sin(\theta) &amp; cos(\theta) &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{bmatrix}\)</span></td><td style="text-align:center"><span class="math inline">\(\begin{cases} x=vcos(\theta)-wsin(\theta) , \\ y=vsin(\theta)+wcos(\theta) \end{cases}\)</span></td></tr><tr class="even"><td style="text-align:center"><strong>旋转变换</strong>（以顺时针为正）</td><td style="text-align:center"><span class="math inline">\(\begin{bmatrix} cos(\theta) &amp; -sin(\theta) &amp; 0 \\ sin(\theta) &amp; cos(\theta) &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{bmatrix}\)</span></td><td style="text-align:center"><span class="math inline">\(\begin{cases} x=vcos(\theta)+wsin(\theta) , \\ y=-vsin(\theta)+wcos(\theta) \end{cases}\)</span></td></tr><tr class="odd"><td style="text-align:center"><strong>平移变换</strong></td><td style="text-align:center"><span class="math inline">\(\begin{bmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ t_x &amp; t_y &amp; 1 \end{bmatrix}\)</span></td><td style="text-align:center"><span class="math inline">\(\begin{cases} x=v+t_x , \\ y=w+t_y \end{cases}\)</span></td></tr><tr class="even"><td style="text-align:center"><strong>偏移变换</strong>（水平）</td><td style="text-align:center"><span class="math inline">\(\begin{bmatrix} 1 &amp; 0 &amp; 0 \\ s_h &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{bmatrix}\)</span></td><td style="text-align:center"><span class="math inline">\(\begin{cases} x=v+ws_h , \\ y=w \end{cases}\)</span></td></tr><tr class="odd"><td style="text-align:center"><strong>偏移变换</strong>（垂直）</td><td style="text-align:center"><span class="math inline">\(\begin{bmatrix} 1 &amp; s_v &amp; 0 \\\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{bmatrix}\)</span></td><td style="text-align:center"><span class="math inline">\(\begin{cases} x=v , \\ y=vs_v+w \end{cases}\)</span></td></tr></tbody></table><p>仿射变换的实现由两种方式：一种是 <strong><em>前向映射（Forward Mapping）</em></strong>：直接采用利用原图像坐标 <span class="math inline">\((v,w)\)</span> 通过 <span class="math inline">\(\begin{bmatrix} x &amp; y &amp; 1\end{bmatrix}=\begin{bmatrix} v &amp; w &amp; 1\end{bmatrix} \textbf{T}\)</span> 得到变换后的坐标 <span class="math inline">\((x,y)\)</span>，使用前向映射会导致一些问题：可能会有多个像素坐标映射到输出图像的同一位置，也可能输出图像的某些位置完全没有相应的输入图像像素与它匹配，也就是没有被映射到，造成有规律的空洞（黑色的花纹状）；更好的一种方式是采用 <strong><em>反向映射（Inverse Mapping）</em></strong>：扫描输出图像的位置 <span class="math inline">\((x,y)\)</span>，通过 <span class="math inline">\(\begin{bmatrix} v &amp; w &amp; 1\end{bmatrix}= \begin{bmatrix} x &amp; y &amp; 1\end{bmatrix}\textbf{T}^{-1}\)</span>（其中 <span class="math inline">\(\textbf{T}^{-1}\)</span> 为 <span class="math inline">\(\textbf{T}\)</span> 的逆矩阵）计算输入图像对应的位置 <span class="math inline">\((v,w)\)</span>，通过插值方法决定输出图像该位置的灰度值。</p></blockquote><p>　　<strong>本文这里采取冈萨雷斯的《数字图像处理_第三版》的变换矩阵方式</strong>，毕竟所学的矩阵论也是将变换矩阵放在后面作为第二个因子。虽然仿射变换都有现成的 API 可以调用，而且速度一般要比自己写的要快，但是知其然终究也要知其所以然。</p><p>　　<strong>下面就以旋转变换为例了</strong>，因为尺度变换和平移变换只需要相应的缩放图像即可，而旋转变换不仅需要更改图像大小，还要确定旋转中心，而旋转中心一般以图像中心为标准。</p><h3 id="旋转变换">旋转变换</h3><p>　　旋转变换首先需要确定旋转中心，若以图像左上角为旋转中心，则只需要像做尺度变换和平移变换那样通过 <span class="math inline">\(\begin{bmatrix} v &amp; w &amp; 1\end{bmatrix}= \begin{bmatrix} x &amp; y &amp; 1\end{bmatrix}\textbf{T}^{-1}\)</span> 做普通的变换即可。而以图像中心为旋转中心，首先需要做坐标变换，将以左上角为原点，水平向右为 X 轴，垂直向下为 Y 轴的图像坐标系转换为以图像中心为原点，水平向右为 X 轴，垂直向下为 Y 轴的数学坐标系；再做正常的旋转变换；随后再将数学坐标系转换为图像坐标系，所以图像中心为旋转中心的旋转变换总共需要做三次变换。这里就以图像中心为旋转中心为例，由于有三次变换，所以应该有三个变换矩阵相乘，设 图像坐标系==》数学坐标系的变换矩阵为 T1，旋转变换矩阵为 T2，数学坐标系==》图像坐标系的变换矩阵为 T3，设顺时针旋转角度为 <span class="math inline">\(\theta\)</span> ，原图像宽度为 <span class="math inline">\(C\)</span>，高度为 <span class="math inline">\(R\)</span>，旋转后图像宽度为 <span class="math inline">\(W\)</span>，高度为 <span class="math inline">\(H\)</span>，则： <span class="math display">\[ T1=\begin{bmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; -1 &amp; 0 \\ -0.5C &amp; 0.5R &amp; 1 \end{bmatrix}　　 T2=\begin{bmatrix} cos(\theta) &amp; -sin(\theta) &amp; 0 \\ sin(\theta) &amp; cos(\theta) &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{bmatrix}　　 T3=\begin{bmatrix} 1 &amp; 0 &amp; 0 \\ 0 &amp; -1 &amp; 0 \\ 0.5W &amp; 0.5H &amp; 1 \end{bmatrix} \]</span> 则旋转变换最终形式为：<span class="math inline">\(\begin{bmatrix} x &amp; y &amp; 1 \end{bmatrix}=\begin{bmatrix} v &amp; w &amp; 1\end{bmatrix} \textbf{T}=\begin{bmatrix} v &amp; w &amp; 1 \end{bmatrix}T1*T2*T3\)</span>。</p><p><strong><em>※BTW：</em></strong>旋转变换中，旋转后图像宽度 <span class="math inline">\(W\)</span>，高度 <span class="math inline">\(H\)</span> 与 原图像宽度 <span class="math inline">\(C\)</span>，高度 <span class="math inline">\(R\)</span> 的关系为： <span class="math display">\[ \begin{cases} H = |R*cos(\theta)| + |C*sin(\theta)| , \\ W = |C*cos(\theta)| + |R*sin(\theta)| \end{cases} \]</span></p><h2 id="插值篇">插值篇</h2><p>　　因为经过采用<strong>反向映射</strong><font color="#00f"><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></font>方式的仿射变换之后，得到的原图像坐标 <span class="math inline">\((v,w)\)</span> 往往不是整数值，所以无法知道其对应的像素值 <span class="math inline">\(f(w,v)\)</span>，这时需要采取插值的方式近似估计该坐标位置的像素值。</p><p>　　常用的插值方法有最近邻插值（nearest neighbor interpolation）、双线性插值（bilinear interpolation）和双三次插值（bicubic interpolation），其中双三次插值在保持图像细节方面最好，但花费时间也最多，PS 中的消除锯齿和羽化效果好像就采用了双三次插值。</p><p>　　最近邻插值只考虑相邻最近的像素，双线性插值考虑相邻的 4 个像素点，双三次插值则考虑相邻的 16 个像素点。</p><h3 id="最近邻插值">最近邻插值</h3><p>　　最近邻插值最简单，将变换后图像的坐标 <span class="math inline">\((x,y)\)</span> 通过反向映射得到原图像坐标 <span class="math inline">\((v,w)\)</span> ，直接对 <span class="math inline">\((v,w)\)</span> 进行四舍五入得到相应的整数坐标 <span class="math inline">\((⌊v+0.5⌋,⌊w+0.5⌋)\)</span><font color="#00f"><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></font>，用该整数坐标的像素值近似估计 <span class="math inline">\((v,w)\)</span> 的像素值，令 <span class="math inline">\(f(y,x)=f(⌊w+0.5⌋,⌊v+0.5⌋)\)</span> ，从而得到变换后图像每个像素点的像素值。</p><h3 id="双线性插值">双线性插值</h3><p>　　双线性插值是线性插值方法的一种扩展，它是 X 和 Y 两个方向上线性插值的组合。</p><div style="text-align:center;font-weight:700;margin:.5em auto"><svg width="270px" height="230px"><defs><marker id="arrow" markerWidth="9" markerHeight="6" refx="0" refy="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="#000"/></marker></defs><line x1="25" y1="25" x2="225" y2="25" stroke="#000" stroke-width="1" marker-end="url(#arrow)"/><line x1="25" y1="25" x2="25" y2="200" stroke="#000" stroke-width="1" marker-end="url(#arrow)"/><text x="230" y="42" fill="blue">X 轴</text><text x="30" y="210" fill="blue">Y 轴</text><circle cx="60" cy="60" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="160" cy="60" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="160" cy="160" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="60" cy="160" r="3" stroke="black" stroke-width="1" fill="red"/><text x="36" y="70" fill="blue">P1</text><text x="170" y="70" fill="blue">P2</text><text x="170" y="170" fill="blue">P3</text><text x="36" y="170" fill="blue">P4</text><circle cx="100" cy="60" r="3" stroke="black" stroke-width="1" fill="blue"/><circle cx="100" cy="160" r="3" stroke="black" stroke-width="1" fill="blue"/><text x="110" y="70" fill="blue">Z1</text><text x="110" y="170" fill="blue">Z2</text><circle cx="100" cy="100" r="3" stroke="black" stroke-width="1" fill="green"/><text x="110" y="110" fill="blue">P(v,w)</text><line x1="100" y1="25" x2="100" y2="160" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="25" y1="100" x2="100" y2="100" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="60" y1="25" x2="60" y2="160" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="160" y1="25" x2="160" y2="160" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="25" y1="60" x2="160" y2="60" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="25" y1="160" x2="160" y2="160" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/></svg></div><p>如上图，设变换后图像的坐标 <span class="math inline">\((x,y)\)</span> 通过反向映射得到原图像坐标 <span class="math inline">\((v,w)\)</span> ，即点 <span class="math inline">\(P\)</span> 正好处于四个像素点 <span class="math inline">\(P1(v_0, w_0)\)</span>、<span class="math inline">\(P2(v_0+1, w_0)\)</span>、<span class="math inline">\(P3(v_0+1, w_0+1)\)</span>、<span class="math inline">\(P4(v_0, w_0+1)\)</span> 的中间，其中 <span class="math inline">\(v_0=⌊v⌋\)</span>，<span class="math inline">\(w_0=⌊w⌋\)</span> ，点 <span class="math inline">\(P\)</span> 对应的像素值为 <span class="math inline">\(f(P)\)</span> 因为双线性插值即在 <span class="math inline">\(X\)</span> 和 <span class="math inline">\(Y\)</span> 两个方向进行线性插值，首先计算 <span class="math inline">\(X\)</span> 方向的插值： <span class="math display">\[ \begin{cases} \frac{f(P2)-f(P1)}{P2.x-P1.x}=\frac{f(Z1)-f(P1)}{Z1.x-P1.x} , \\ \frac{f(P3)-f(P4)}{P3.x-P4.x}=\frac{f(Z2)-f(P4)}{Z2.x-P4.x} \end{cases} \]</span> 即： <span class="math display">\[ \begin{cases} f(Z1)=\frac{Z1.x-P1.x}{P2.x-P1.x}f(P2)+\frac{P2.x-Z1.x}{P2.x-P1.x}f(P1) =(v-v_0)f(P2)+(v_0+1-v)f(P1), \\ f(Z2)=\frac{Z2.x-P4.x}{P3.x-P4.x}f(P3)+\frac{P3.x-Z2.x}{P3.x-P4.x}f(P4) =(v-v_0)f(P3)+(v_0+1-v)f(P4) \end{cases}\tag{1} \]</span> 然后计算 <span class="math inline">\(Y\)</span> 方向的插值： <span class="math display">\[ \begin{equation} \frac{f(Z2)-f(Z1)}{Z2.y-Z1.y}=\frac{f(P)-f(Z1)}{P.y-Z1.y} \end{equation} \]</span> 即： <span class="math display">\[ \begin{equation} f(P)=\frac{P.y-Z1.y}{Z2.y-Z1.y}f(Z2)+\frac{Z2.y-P.y}{Z2.y-Z1.y}f(Z1) =(w-w_0)f(Z2)+(w_0+1-w)f(Z1) \end{equation}\tag{2} \]</span> 结合式（1）和式（2）可得： <span class="math display">\[ \begin{equation} f(P)=(v_0+1-v)(w_0+1-w)f(P1)+(v-v_0)(w_0+1-w)f(P2)+(v-v_0)(w-w_0)f(P3)+(v_0+1-v)(w-w_0)f(P4) \end{equation} \]</span> 用矩阵形式可表示为： <span class="math display">\[ f(P)=\begin{bmatrix} v_0+1-v &amp; v-v_0 \end{bmatrix} \begin{bmatrix} f(P1) &amp; f(P4) \\ f(P2) &amp; f(P3) \end{bmatrix} \begin{bmatrix} (w_0+1-w) \\ (w-w_0) \end{bmatrix} \]</span> 即： <span class="math display">\[ f(y,x)=f(w,v)=\begin{bmatrix} ⌊v⌋+1-v &amp; v-⌊v⌋ \end{bmatrix} \begin{bmatrix} f(⌊w⌋,⌊v⌋) &amp; f(⌊w⌋+1,⌊v⌋) \\ f(⌊w⌋,⌊v⌋+1) &amp; f(⌊w⌋+1,⌊v⌋+1) \end{bmatrix} \begin{bmatrix} (⌊w⌋+1-w) \\ (w-⌊w⌋) \end{bmatrix} \]</span></p><h3 id="双三次插值">双三次插值</h3><div style="text-align:center;font-weight:700;margin:.5em auto"><svg width="270px" height="230px"><defs><marker id="arrow" markerWidth="9" markerHeight="6" refx="0" refy="3" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L0,6 L9,3 z" fill="#000"/></marker></defs><line x1="25" y1="25" x2="225" y2="25" stroke="#000" stroke-width="1" marker-end="url(#arrow)"/><line x1="25" y1="25" x2="25" y2="200" stroke="#000" stroke-width="1" marker-end="url(#arrow)"/><text x="230" y="42" fill="blue">X 轴</text><text x="30" y="210" fill="blue">Y 轴</text><line x1="55" y1="25" x2="55" y2="175" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="85" y1="25" x2="85" y2="175" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="115" y1="25" x2="115" y2="175" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="145" y1="25" x2="145" y2="175" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="175" y1="25" x2="175" y2="176" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="25" y1="55" x2="175" y2="55" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="25" y1="85" x2="175" y2="85" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="25" y1="115" x2="175" y2="115" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="25" y1="145" x2="175" y2="145" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><line x1="25" y1="175" x2="176" y2="175" style="stroke:#000;stroke-width:1;stroke-dasharray:3"/><circle cx="55" cy="55" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="85" cy="55" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="115" cy="55" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="145" cy="55" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="55" cy="85" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="85" cy="85" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="115" cy="85" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="145" cy="85" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="55" cy="115" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="85" cy="115" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="115" cy="115" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="145" cy="115" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="55" cy="145" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="85" cy="145" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="115" cy="145" r="3" stroke="black" stroke-width="1" fill="red"/><circle cx="145" cy="145" r="3" stroke="black" stroke-width="1" fill="red"/><text x="77" y="85" fill="blue">P11</text><circle cx="100" cy="100" r="3" stroke="black" stroke-width="1" fill="green"/><text x="110" y="110" fill="blue">P(v,w)</text></svg></div><p>　　如上图，双三次插值需要考虑相邻16个像素（4×4），用双三次插值重采样的图像更平滑并且更能保留图像细节，在这三种插值算法中，双三次插值效果最好，但处理速度最慢。同样设变换后图像的坐标 <span class="math inline">\((x,y)​\)</span> 通过反向映射得到原图像坐标 <span class="math inline">\((v,w)​\)</span> ，与其左上角相邻最近的 点P11 坐标则为 <span class="math inline">\((⌊v⌋,⌊w⌋)​\)</span> ，该插值方法需要选取一个合适的插值基函数，参照维基百科 <strong>Bicubic interpolation</strong> 的一般为： <span class="math display">\[ W(x) = \begin{cases} (a+2)|x|^3-(a+3)|x|^2+1 &amp; \text{for } |x| \leq 1, \\ a|x|^3-5a|x|^2+8a|x|-4a &amp; \text{for } 1 &lt; |x| &lt; 2, \\ 0 &amp; \text{otherwise}, \end{cases} \]</span> 其中 <span class="math inline">\(a\)</span> 一般取 -0.5 、-0.75 或 -1；则：<span class="math inline">\(f(y,x)=f(w,v)=A*B*C\)</span> ，其中： <span class="math display">\[ A=\begin{bmatrix} W( v-(⌊v⌋-1) ) &amp; W(v-⌊v⌋) &amp; W( (⌊v⌋+1)-v ) &amp; W( (⌊v⌋+2)-v ) \end{bmatrix} \\ B=\begin{bmatrix} f(⌊w⌋-1,⌊v⌋-1) &amp; f(⌊w⌋,⌊v⌋-1) &amp; f(⌊w⌋+1,⌊v⌋-1) &amp; f(⌊w⌋+2,⌊v⌋-1) \\ f(⌊w⌋-1,⌊v⌋) &amp; f(⌊w⌋,⌊v⌋) &amp; f(⌊w⌋+1,⌊v⌋) &amp; f(⌊w⌋+2,⌊v⌋) \\ f(⌊w⌋-1,⌊v⌋+1) &amp; f(⌊w⌋,⌊v⌋+1) &amp; f(⌊w⌋+1,⌊v⌋+1) &amp; f(⌊w⌋+2,⌊v⌋+1) \\ f(⌊w⌋-1,⌊v⌋+2) &amp; f(⌊w⌋,⌊v⌋+2) &amp; f(⌊w⌋+1,⌊v⌋+2) &amp; f(⌊w⌋+2,⌊v⌋+2) \end{bmatrix} \\ C=\begin{bmatrix} W( w-(⌊w⌋-1) ) \\ W(w-⌊w⌋) \\ W( (⌊w⌋+1)-w ) \\ W( (⌊w⌋+2)-w ) \end{bmatrix} \]</span></p><p>即： <span class="math display">\[ f(y,x)=f(w,v)= \sum\limits_{row=-1}^2\sum\limits_{col=-1}^2f(⌊w⌋+row,⌊v⌋+col)W(row-(w-⌊w⌋))W(col-(v-⌊v⌋)) \]</span> <strong>另附：</strong>网上也有人中间那个矩阵 <span class="math inline">\(B\)</span> 是本文中间矩阵 <span class="math inline">\(B\)</span> 的转置，经过下文实践，感觉效果差不多，但从理论上来说，应该本文这样写才是对的吧🤔。</p><h3 id="lanczos-插值">Lanczos 插值</h3><p>　　Lanczos 插值和双三次插值本质上差不多，不同的是插值权重基函数不一样，Lanczos 插值算法的基函数为： <span class="math display">\[ L(x) = \begin{cases} 1 &amp; \text{for } x = 0, \\ a*sin(\pi x)sin(\pi x/a)/(\pi x)^2 &amp; \text{for } 0 &lt; |x| \leq a, \\ 0 &amp; \text{otherwise}, \end{cases} \]</span> 其中 a 代表插值窗口半径，若 a = 2，则代表取周围 4×4 邻域像素点进行插值，和双三次插值除权重不一样外其它都一样，此时适用于对图像下采样（缩小），若 a = 3，则代表取周围 9×9 邻域像素点进行插值，此时适用于对图像上采样（放大），OpenCV 的 <code>INTER_LANCZOS4</code> 插值参数就代表取周围 8×8 邻域的像素点进行插值。</p><h2 id="实践篇">实践篇</h2><p>　　本次实践采用 Matlab R2016b，具体 matlab 实现代码为：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="MATLAB"><div class="code-copy"></div><figure class="highlight hljs matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">clc;clear;close all;</span><br><span class="line"></span><br><span class="line">img = imread(<span class="string">&#x27;lena_gray.jpg&#x27;</span>); <span class="comment">% 读取图像</span></span><br><span class="line">[R, C] = <span class="built_in">size</span>(img); <span class="comment">% 获取图像大小</span></span><br><span class="line"></span><br><span class="line">theta = <span class="number">45</span> * <span class="built_in">pi</span> / <span class="number">180.0</span>; <span class="comment">% 旋转角度</span></span><br><span class="line">H = <span class="built_in">ceil</span>(<span class="built_in">abs</span>(R*<span class="built_in">cos</span>(theta)) + <span class="built_in">abs</span>(C*<span class="built_in">sin</span>(theta)));    <span class="comment">% 变换后图像的高度</span></span><br><span class="line">W = <span class="built_in">ceil</span>(<span class="built_in">abs</span>(C*<span class="built_in">cos</span>(theta)) + <span class="built_in">abs</span>(R*<span class="built_in">sin</span>(theta)));    <span class="comment">% 变换后图像的宽度</span></span><br><span class="line">res = <span class="built_in">zeros</span>(H, W);   <span class="comment">% 构造结果矩阵。每个像素点默认初始化为0（黑色）</span></span><br><span class="line"></span><br><span class="line">T1 = [<span class="number">1</span> <span class="number">0</span> <span class="number">0</span>; <span class="number">0</span> <span class="number">-1</span> <span class="number">0</span>; <span class="number">-0.5</span>*C <span class="number">0.5</span>*R <span class="number">1</span>];   <span class="comment">% 将原图像坐标映射到数学笛卡尔坐标</span></span><br><span class="line">T2 = [<span class="built_in">cos</span>(theta) -<span class="built_in">sin</span>(theta) <span class="number">0</span>; <span class="built_in">sin</span>(theta) <span class="built_in">cos</span>(theta) <span class="number">0</span>; <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>];    <span class="comment">% 数学笛卡尔坐标下顺时针旋转的变换矩阵</span></span><br><span class="line">T3 = [<span class="number">1</span> <span class="number">0</span> <span class="number">0</span>; <span class="number">0</span> <span class="number">-1</span> <span class="number">0</span>; <span class="number">0.5</span>*W <span class="number">0.5</span>*H <span class="number">1</span>];    <span class="comment">% 将数学笛卡尔坐标映射到旋转后的图像坐标</span></span><br><span class="line">T = T1*T2*T3;</span><br><span class="line">inv_T = inv(T);    <span class="comment">% 求逆矩阵</span></span><br><span class="line"><span class="comment">% inv_T = [cos(theta) -sin(theta) 0; sin(theta) cos(theta) 0; -0.5*W*cos(theta)-0.5*H*sin(theta)+0.5*C 0.5*W*sin(theta)-0.5*H*cos(theta)+0.5*R 1];</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> y = <span class="number">1</span> : H   <span class="comment">% 变换后图像的纵坐标，行，高</span></span><br><span class="line">    <span class="keyword">for</span> x = <span class="number">1</span> : W   <span class="comment">% 变换后图像的横坐标，列，宽</span></span><br><span class="line">        original_coordinate = [x y <span class="number">1</span>] * inv_T; <span class="comment">% 矩阵乘法</span></span><br><span class="line">        v = original_coordinate(<span class="number">1</span>);    <span class="comment">% 原图像的横坐标，列，宽</span></span><br><span class="line">        w = original_coordinate(<span class="number">2</span>);    <span class="comment">% 原图像的纵坐标，行，高</span></span><br><span class="line">        <span class="comment">% 变换后的位置判断是否越界</span></span><br><span class="line">        <span class="keyword">if</span> v&gt;=<span class="number">1</span> &amp;&amp; w&gt;=<span class="number">1</span> &amp;&amp; v&lt;=C &amp;&amp; w&lt;=R</span><br><span class="line">            res(y, x) = img(<span class="built_in">round</span>(w), <span class="built_in">round</span>(v));  <span class="comment">% 用原图像对应坐标的像素值填充变换后的图像（最邻近插值）</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">% ------------- 双线性插值（bilinear interpolation）-----------------</span></span><br><span class="line">            left = <span class="built_in">floor</span>(v); right = <span class="built_in">ceil</span>(v); top = <span class="built_in">floor</span>(w); bottom = <span class="built_in">ceil</span>(w);</span><br><span class="line">            dC = v-left;   <span class="comment">% 列偏差</span></span><br><span class="line">            dR = w-top;    <span class="comment">% 行偏差</span></span><br><span class="line">            res(y, x) = (<span class="number">1</span>-dC)*(<span class="number">1</span>-dR)*img(top, left) + dC*(<span class="number">1</span>-dR)*img(top,right) + (<span class="number">1</span>-dC)*dR*img(bottom, left) + dC*dR*img(bottom, right); </span><br><span class="line">            </span><br><span class="line">            <span class="comment">% ------------- 双三次插值（bicubic interpolation） -------------------------</span></span><br><span class="line">        <span class="keyword">if</span> left&gt;=<span class="number">2</span> &amp;&amp; top&gt;=<span class="number">2</span> &amp;&amp; left&lt;=(C<span class="number">-2</span>) &amp;&amp; top&lt;=(R<span class="number">-2</span>)</span><br><span class="line">            img = double(img);</span><br><span class="line">            MA = [bicubic(<span class="number">1</span>+dC) bicubic(dC) bicubic(<span class="number">1</span>-dC) bicubic(<span class="number">2</span>-dC)];</span><br><span class="line">            MB = [img(top<span class="number">-1</span>,left<span class="number">-1</span>) img(top,left<span class="number">-1</span>) img(top+<span class="number">1</span>,left<span class="number">-1</span>) img(top+<span class="number">2</span>,left<span class="number">-1</span>);</span><br><span class="line">                 img(top<span class="number">-1</span>,left) img(top,left) img(top+<span class="number">1</span>,left) img(top+<span class="number">2</span>,left);</span><br><span class="line">                 img(top<span class="number">-1</span>,left+<span class="number">1</span>) img(top,left+<span class="number">1</span>) img(top+<span class="number">1</span>,left+<span class="number">1</span>) img(top+<span class="number">2</span>,left+<span class="number">1</span>);</span><br><span class="line">                 img(top<span class="number">-1</span>,left+<span class="number">2</span>) img(top,left+<span class="number">2</span>) img(top+<span class="number">1</span>,left+<span class="number">2</span>) img(top+<span class="number">2</span>,left+<span class="number">2</span>)];</span><br><span class="line">            <span class="comment">% MB = MB&#x27;;    % 求转置矩阵</span></span><br><span class="line">            MC = [bicubic(<span class="number">1</span>+dR); bicubic(dR); bicubic(<span class="number">1</span>-dR); bicubic(<span class="number">2</span>-dR)];</span><br><span class="line">            res(y, x) = MA*MB*MC;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">figure</span>, imshow(uint8(res)); <span class="comment">% 显示图像</span></span><br></pre></td></tr></table></figure></div><p>BiCubic 基函数 Matlab 代码为：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="MATLAB"><div class="code-copy"></div><figure class="highlight hljs matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">W</span> = <span class="title">bicubic</span><span class="params">(x)</span></span></span><br><span class="line"><span class="comment">%bicubic 双三次插值基函数</span></span><br><span class="line">a = <span class="number">-1</span>; <span class="comment">% 默认取a为-1</span></span><br><span class="line">x1 = <span class="built_in">abs</span>(x);</span><br><span class="line">x2 = x1*x1;</span><br><span class="line">x3 = x1*x2; </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> x1 &lt;= <span class="number">1</span></span><br><span class="line">   W = <span class="number">1</span> - (a+<span class="number">3</span>)*x2 + (a+<span class="number">2</span>)*x3;</span><br><span class="line"><span class="keyword">elseif</span> x1&gt;<span class="number">1</span> &amp;&amp; x1&lt;=<span class="number">2</span></span><br><span class="line">   W = <span class="number">-4</span>*a + <span class="number">8</span>*a*x1 - <span class="number">5</span>*a*x2 + a*x3;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">   W = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></div><p>　　旋转变换中感觉插值的作用没体现出来，以肉眼来看感觉三种插值方法的效果差不多，可能是 Shaun 选取的示例不好，为了体现插值效果，应该采用尺度变换（缩放变换）的。以上代码改为尺度变换也简单，自定义图像缩放后的宽高，以两倍为例，<code>H = R * 2; W = C * 2;</code>，再将旋转变换矩阵改为尺度变换矩阵，尺度变换矩阵中 <span class="math inline">\(c_x=W/C；c_y=H/R\)</span>。</p><p>为了便于理解，Shaun 对代码就不进行优化了（其实是你懒吧 _(:з」∠)_）。</p><h2 id="后记">后记</h2><p>　　本文算是数字图像处理中最基础的知识了，但 Shaun 在写时还是查阅了大量相关的资料，有些地方理解的还不是很透彻，行文思路有点混乱 ╮(╯▽╰)╭。本来是不想使用图片的，但本文不用图片很难理解清楚，又为了不使用外部图，最后只得参考 <a target="_blank" rel="noopener" href="http://www.runoob.com/svg/svg-tutorial.html">SVG 教程</a> 和 <a target="_blank" rel="noopener" href="https://www.w3cplus.com/svg/svg-markers.html">如何创建SVG箭头和polymarker——<code>marker</code>元素</a> 采用 SVG 绘制相应图片了。等有时间再把用 OpenCV 实现的 C++ 代码也贴上吧。最后再感叹一下 Matlab 确实是做科研的好工具（°Д°）Ъ，<del>吐槽一下 <em>MathJax</em> 排版好痛苦啊，太多需要转义符<code>\</code>的地方了吧。</del>，搞错了 Σ(ﾟдﾟ;)，这主要和 markdown 渲染有关，hexo 默认的 markdown 渲染插件 hexo-renderer-marked 太普通了，有些东西根本没办法渲染或者渲染有问题 （╯‵□′）╯︵┴─┴，Shaun 最后决定使用 hexo-renderer-pandoc 插件渲染 markdown，这样就完美了 (๑•̀ㅂ•́)و✧ 。</p><p>　　至于具体怎么使用 hexo-renderer-pandoc 替换默认的渲染器可参考：<a target="_blank" rel="noopener" href="https://www.v2ex.com/t/410080">如何禁止 hexo 在 html 代码里插入&lt;br&gt;标签?</a>。具体如下：</p><blockquote><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="BASH"><div class="code-copy"></div><figure class="highlight hljs bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1、安装 Pandoc，可以不顺带安装 MiKTex</span></span><br><span class="line"><span class="comment"># 2、卸载默认渲染器</span></span><br><span class="line">npm uninstall hexo-renderer-marked --save</span><br><span class="line"><span class="comment"># 3、安装 hexo-renderer-pandoc</span></span><br><span class="line">npm install hexo-renderer-pandoc --save</span><br></pre></td></tr></table></figure></div></blockquote><h2 id="附录">附录</h2><p>　　挖的坑总是要填的，呐，这就是用 OpenCV 实现的旋转变换，实现语言为 C++ ：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="C++"><div class="code-copy"></div><figure class="highlight hljs c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/opencv.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M_PI       3.14159265358979323846</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">bicubic</span><span class="params">(<span class="keyword">double</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="comment">// bicubic 双三次插值基函数</span></span><br><span class="line">	<span class="keyword">int</span> a = <span class="number">-1</span>;	<span class="comment">// 默认取a为 - 1</span></span><br><span class="line">	<span class="keyword">double</span> x1 = <span class="built_in">fabs</span>(x);</span><br><span class="line">	<span class="keyword">double</span> x2 = x1*x1;</span><br><span class="line">	<span class="keyword">double</span> x3 = x1*x2;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (x1 &lt;= <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span> - (a + <span class="number">3</span>)*x2 + (a + <span class="number">2</span>)*x3;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (x1 &gt; <span class="number">1</span> &amp;&amp; x1 &lt;= <span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">-4</span> * a + <span class="number">8</span> * a*x1 - <span class="number">5</span> * a*x2 + a*x3;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cv::Mat img = cv::<span class="built_in">imread</span>(<span class="string">&quot;../Data/lena_gray.jpg&quot;</span>, <span class="number">0</span>);	<span class="comment">// 以灰度模式读取图片</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> R = img.rows;	<span class="comment">// 获取原图像高度</span></span><br><span class="line">	<span class="keyword">int</span> C = img.cols;	<span class="comment">// 获取原图像宽度</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> theta = <span class="number">45</span> * M_PI / <span class="number">180.0</span>;	<span class="comment">// 旋转角度</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> H = <span class="built_in">ceil</span>(<span class="built_in">fabs</span>(R*<span class="built_in">cos</span>(theta)) + <span class="built_in">fabs</span>(C*<span class="built_in">sin</span>(theta)));	<span class="comment">// 变换后图像的高度</span></span><br><span class="line">	<span class="keyword">int</span> W = <span class="built_in">ceil</span>(<span class="built_in">fabs</span>(C*<span class="built_in">cos</span>(theta)) + <span class="built_in">fabs</span>(R*<span class="built_in">sin</span>(theta)));	<span class="comment">// 变换后图像的宽度</span></span><br><span class="line"></span><br><span class="line">	cv::Mat res = cv::Mat::<span class="built_in">zeros</span>(H, W, CV_8UC1);	<span class="comment">// 构造结果矩阵。每个像素点默认初始化为0（黑色）	</span></span><br><span class="line"></span><br><span class="line">	cv::Mat T1 = (cv::Mat_&lt;<span class="keyword">double</span>&gt;(<span class="number">3</span>, <span class="number">3</span>) &lt;&lt; <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">-0.5</span>*C, <span class="number">0.5</span>*R, <span class="number">1</span>);	<span class="comment">// 将原图像坐标映射到数学笛卡尔坐标</span></span><br><span class="line">	cv::Mat T2 = (cv::Mat_&lt;<span class="keyword">double</span>&gt;(<span class="number">3</span>, <span class="number">3</span>) &lt;&lt; <span class="built_in">cos</span>(theta), -<span class="built_in">sin</span>(theta), <span class="number">0</span>, <span class="built_in">sin</span>(theta), <span class="built_in">cos</span>(theta), <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);	<span class="comment">// 数学笛卡尔坐标下顺时针旋转的变换矩阵</span></span><br><span class="line">	<span class="keyword">double</span> t3[<span class="number">3</span>][<span class="number">3</span>] = &#123; &#123; <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span> &#125;, &#123; <span class="number">0</span>, <span class="number">-1</span>, <span class="number">0</span> &#125;, &#123; <span class="number">0.5</span>*W, <span class="number">0.5</span>*H, <span class="number">1</span> &#125; &#125;;	<span class="comment">// 将数学笛卡尔坐标映射到旋转后的图像坐标</span></span><br><span class="line">	cv::Mat T3 = cv::<span class="built_in">Mat</span>(<span class="number">3</span>, <span class="number">3</span>, CV_64FC1, t3);</span><br><span class="line">	cv::Mat T = T1*T2*T3;</span><br><span class="line">	cv::Mat inv_T = T.<span class="built_in">inv</span>();	<span class="comment">// 求逆矩阵</span></span><br><span class="line">	<span class="comment">//cv::Mat inv_T = (cv::Mat_&lt;double&gt;(3, 3) &lt;&lt; cos(theta), -sin(theta), 0, sin(theta), cos(theta), 0, -0.5*W*cos(theta) - 0.5*H*sin(theta) + 0.5*C, 0.5*W*sin(theta) - 0.5*H*cos(theta) + 0.5*R, 1);</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> y = <span class="number">0</span>; y &lt; H; y++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> x = <span class="number">0</span>; x &lt; W; x++)</span><br><span class="line">		&#123;</span><br><span class="line">			cv::Mat point = (cv::Mat_&lt;<span class="keyword">double</span>&gt;(<span class="number">1</span>, <span class="number">3</span>) &lt;&lt; x, y, <span class="number">1</span>);</span><br><span class="line">			cv::Mat original_coordinate = point * inv_T;	<span class="comment">// 矩阵乘法</span></span><br><span class="line">			<span class="keyword">double</span> v = original_coordinate.at&lt;<span class="keyword">double</span>&gt;(<span class="number">0</span>, <span class="number">0</span>);	<span class="comment">// 原图像的横坐标，列，宽</span></span><br><span class="line">			<span class="keyword">double</span> w = original_coordinate.at&lt;<span class="keyword">double</span>&gt;(<span class="number">0</span>, <span class="number">1</span>);	<span class="comment">// 原图像的纵坐标，行，高</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">// 变换后的位置判断是否越界</span></span><br><span class="line">			<span class="keyword">if</span> (v &gt;= <span class="number">0</span> &amp;&amp; w &gt;= <span class="number">0</span> &amp;&amp; v &lt;= C - <span class="number">1</span> &amp;&amp; w &lt;= R - <span class="number">1</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				res.at&lt;uchar&gt;(y, x) = img.at&lt;uchar&gt;(<span class="built_in">round</span>(w), <span class="built_in">round</span>(v));	<span class="comment">// 用原图像对应坐标的像素值填充变换后的图像（最邻近插值）</span></span><br><span class="line">				</span><br><span class="line">				<span class="comment">// ------------ - 双线性插值（bilinear interpolation）---------------- -</span></span><br><span class="line">				<span class="keyword">int</span> left = <span class="built_in">floor</span>(v), right = <span class="built_in">ceil</span>(v), top = <span class="built_in">floor</span>(w), bottom = <span class="built_in">ceil</span>(w);</span><br><span class="line">				<span class="keyword">double</span> dC = v - left;	<span class="comment">// 列偏差</span></span><br><span class="line">				<span class="keyword">double</span> dR = w - top;	<span class="comment">// 行偏差</span></span><br><span class="line">				res.at&lt;uchar&gt;(y, x) = (<span class="number">1</span> - dC)*(<span class="number">1</span> - dR)*img.at&lt;uchar&gt;(top, left) + dC*(<span class="number">1</span> - dR)*img.at&lt;uchar&gt;(top, right) + (<span class="number">1</span> - dC)*dR*img.at&lt;uchar&gt;(bottom, left) + dC*dR*img.at&lt;uchar&gt;(bottom, right);</span><br><span class="line">			</span><br><span class="line">				<span class="comment">// ------------ - 双三次插值（bicubic interpolation）------------------------ -</span></span><br><span class="line">				<span class="keyword">if</span> (left &gt;= <span class="number">1</span> &amp;&amp; top &gt;= <span class="number">1</span> &amp;&amp; left &lt;= (C - <span class="number">3</span>) &amp;&amp; top &lt;= (R - <span class="number">3</span>))</span><br><span class="line">				&#123;</span><br><span class="line">					cv::Mat MA = (cv::Mat_&lt;<span class="keyword">double</span>&gt;(<span class="number">1</span>, <span class="number">4</span>) &lt;&lt; <span class="built_in">bicubic</span>(<span class="number">1</span> + dC), <span class="built_in">bicubic</span>(dC), <span class="built_in">bicubic</span>(<span class="number">1</span> - dC), <span class="built_in">bicubic</span>(<span class="number">2</span> - dC));</span><br><span class="line">					cv::Mat MB = <span class="built_in">img</span>(cv::<span class="built_in">Rect</span>(left - <span class="number">1</span>, top - <span class="number">1</span>, <span class="number">4</span>, <span class="number">4</span>));	<span class="comment">// 提取当前相邻区域16个像素点做插值</span></span><br><span class="line">					MB.<span class="built_in">convertTo</span>(MB, CV_64FC1);	<span class="comment">// 变换为浮点型数据</span></span><br><span class="line">					MB = MB.<span class="built_in">t</span>();	<span class="comment">// 求转置矩阵</span></span><br><span class="line">					cv::Mat MC = (cv::Mat_&lt;<span class="keyword">double</span>&gt;(<span class="number">4</span>, <span class="number">1</span>) &lt;&lt; <span class="built_in">bicubic</span>(<span class="number">1</span> + dR), <span class="built_in">bicubic</span>(dR), <span class="built_in">bicubic</span>(<span class="number">1</span> - dR), <span class="built_in">bicubic</span>(<span class="number">2</span> - dR));</span><br><span class="line">					cv::Mat result = MA*MB*MC;</span><br><span class="line">					res.at&lt;uchar&gt;(y, x) = <span class="keyword">static_cast</span>&lt;uchar&gt;(result.at&lt;<span class="keyword">double</span>&gt;(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cv::<span class="built_in">imshow</span>(<span class="string">&quot;result&quot;</span>, res);	<span class="comment">// 显示变换后图像</span></span><br><span class="line">	cv::<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>　　以上 C++ 代码在 VS2013 下能完美运行，不管是用 OpenCV-2.4.11 还是 OpenCV-3.2.0。其实完全理解的话，不管用什么工具都能实现，只是看哪个工具方便一点而已，就这个而言，感觉 Matlab 要方便很多，Shaun 就不继续挖 Python 的坑了，毕竟如果要用 Python 实现其实还是用 OpenCV，只是用 OpenCV Python 版的接口而已。</p><h2 id="参考资料">参考资料</h2><p>[１] <a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/e94cfa2d336c1eb91a375dab.html">第4章 图像几何变换</a></p><p>[２] <a target="_blank" rel="noopener" href="http://blog.csdn.net/lkj345/article/details/50555870">图像旋转原理及实现</a></p><p>[３] <a target="_blank" rel="noopener" href="http://www.opencv.org.cn/opencvdoc/2.3.2/html/doc/tutorials/imgproc/imgtrans/warp_affine/warp_affine.html#warp-affine">仿射变换</a>（<a target="_blank" rel="noopener" href="http://www.opencv.org.cn/opencvdoc/2.3.2/html/doc/tutorials/tutorials.html" class="uri">http://www.opencv.org.cn/opencvdoc/2.3.2/html/doc/tutorials/tutorials.html</a>）</p><p>[４] <a target="_blank" rel="noopener" href="http://blog.csdn.net/augusdi/article/details/9028365">图像处理常用插值方法总结</a></p><p>[５] <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Bilinear_interpolation"><strong>Wikipedia Bilinear interpolation</strong></a></p><p>[６] <a target="_blank" rel="noopener" href="http://blog.csdn.net/xjz18298268521/article/details/51220576">双线性插值算法的详细总结</a></p><p>[７] <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Bicubic_interpolation"><strong>Wikipedia Bicubic interpolation</strong></a></p><p>[８] <a target="_blank" rel="noopener" href="https://wenku.baidu.com/view/34dea625192e45361166f504.html?qq-pf-to=pcqq.c2c">双三次插值(bicubic interpolation)原理及MATLAB源码实现</a></p><p>[９] <a target="_blank" rel="noopener" href="https://dailc.github.io/2017/11/01/imageprocess_bicubicinterpolation.html">图像缩放】双立方（三次）卷积插值</a>（<a target="_blank" rel="noopener" href="https://dailc.github.io/blog/tags.html#%E6%8F%92%E5%80%BC%E7%AE%97%E6%B3%95" class="uri">https://dailc.github.io/blog/tags.html#%E6%8F%92%E5%80%BC%E7%AE%97%E6%B3%95</a>）</p><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr><ol><li id="fn1" role="doc-endnote"><p><font color="#FA8072">为啥不说前向映射呢？这是因为若原图像坐标 <span class="math inline">\((v,w)\)</span> 通过前向映射方式得到变换后图像的坐标 <span class="math inline">\((x,y)\)</span> ，而且这个坐标为小数的话，一般采用四舍五入的方式得到变换后图像对应的整数坐标 <span class="math inline">\((⌊x+0.5⌋,⌊y+0.5⌋)\)</span>，令 <span class="math inline">\(f(⌊y+0.5⌋,⌊x+0.5⌋)=f(w,v)\)</span> 。</font><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li><li id="fn2" role="doc-endnote"><p><font color="#FA8072"><span class="math inline">\(⌊x⌋\)</span> 表示向下取整，称为 Floor，指的是小于或等于 <span class="math inline">\(x\)</span> 的最大整数；<span class="math inline">\(⌈x⌉\)</span> 表示向上取整，称为 Ceil，指的是大于或等于 <span class="math inline">\(x\)</span> 的最小整数，<span class="math inline">\(eg：⌊5.6⌋ = 5，⌊-5.6⌋ = -6；⌈5.6⌉ = 6，⌈-5.6⌉ = -5。\)</span></font><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li></ol></section></div><div class="article-content-more"><button type="button" class="article-more--link"><i class="fa fa-angle-double-down fa-3x" aria-hidden="true"></i></button></div></section></article><article id="post-本人常用小工具安利" class="article div-border"><header class="article-header"><span class="article-date article-title--index"><i class="fa fa-calendar" aria-hidden="true"></i> <a href="/posts/aef52be2.html"><time datetime="2017-12-17T12:18:50.000Z">2017-12-17</time></a></span><section class="article-title article-title--index"><a href="/posts/aef52be2.html">本人常用小工具安利</a></section><div class="article-label"><div class="article-category label"><i class="fa fa-book" aria-hidden="true"></i> <a class="color1 article-category-link" href="/categories/Share/">Share</a></div><div class="article-tag label"><i class="fa fa-bookmark" aria-hidden="true"></i> <a class="color4 article-tag-none-link" href="/tags/record/" rel="tag">record</a></div></div></header><section class="article-content"><div class="article-content--excerpt"><h2 id="前言">前言</h2><p>　　由于 Shaun 目前使用最多的是 Windows 系统，所以以下推荐的软件基本都是 Windows 下的软件，全凭 Shaun 主观感觉推荐，也算是个人备份吧。</p><p>　　首先推荐的自然是装机软件 <a target="_blank" rel="noopener" href="https://www.ezbsystems.com/ultraiso/download.htm"><strong>ULTRAISO</strong></a>，下个绿色版就好，只有 1M 多一点 或者 <a target="_blank" rel="noopener" href="https://github.com/pbatard/rufus"><strong>Rufus</strong></a> 好像也不错。下载 Windows 镜像的地方推荐为：<a target="_blank" rel="noopener" href="https://msdn.itellyou.cn/"><strong>MSDN，I Tell You</strong></a>。接下来就是正式的软件推荐篇了：</p></div><div class="article-content--all"><h2 id="前言">前言</h2><p>　　由于 Shaun 目前使用最多的是 Windows 系统，所以以下推荐的软件基本都是 Windows 下的软件，全凭 Shaun 主观感觉推荐，也算是个人备份吧。</p><p>　　首先推荐的自然是装机软件 <a target="_blank" rel="noopener" href="https://www.ezbsystems.com/ultraiso/download.htm"><strong>ULTRAISO</strong></a>，下个绿色版就好，只有 1M 多一点 或者 <a target="_blank" rel="noopener" href="https://github.com/pbatard/rufus"><strong>Rufus</strong></a> 好像也不错。下载 Windows 镜像的地方推荐为：<a target="_blank" rel="noopener" href="https://msdn.itellyou.cn/"><strong>MSDN，I Tell You</strong></a>。接下来就是正式的软件推荐篇了：</p><span id="more"></span><h2 id="大众篇">大众篇</h2><p>　　首先推荐浏览器：首选的自然是 <a target="_blank" rel="noopener" href="https://www.google.com/chrome/browser/thankyou.html?standalone=1&amp;statcb=1&amp;installdataindex=defaultbrowser"><strong>Chrome</strong></a> 和 <a target="_blank" rel="noopener" href="https://www.mozilla.org/zh-CN/firefox/organizations/all/"><strong>Firefox</strong></a>，还有一个比较偏门的是 <a target="_blank" rel="noopener" href="https://www.torproject.org/projects/torbrowser.html.en"><strong>Tor Browser</strong></a>（如果在一些特殊时段，各种番（fang）茄（qiang）工具都失效的情况下，这个可以临时用用）。推荐完浏览器，自然也要玩浏览器，</p><p>这里极为推荐的是脚本管理插件：<a target="_blank" rel="noopener" href="http://tampermonkey.net/"><strong>Tampermonkey</strong></a>（支持多种浏览器），有 Tampermonkey 和没 Tampermonkey 是两种浏览体验，会用 Tampermonkey 和没用 Tampermonkey 的是两个世界的人（ᖗ乛◡乛ᖘ），Tampermonkey 是通过 Javascript 改变浏览器的，顺便推荐几个常用的脚本：1、<a target="_blank" rel="noopener" href="https://greasyfork.org/zh-CN/scripts/14716-%E6%8A%A4%E7%9C%BC%E8%84%9A%E6%9C%AC">护眼脚本</a>；2、<a target="_blank" rel="noopener" href="https://greasyfork.org/zh-CN/scripts/10433-super-preloaderplus-one/code">Super_preloaderPlus_one</a>；3、<a target="_blank" rel="noopener" href="https://greasyfork.org/zh-CN/scripts/17800-%E8%A7%A3%E5%86%B3%E7%99%BE%E5%BA%A6%E4%BA%91%E5%A4%A7%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E9%99%90%E5%88%B6">解除百度云大文件下载限制</a>（这个配合 IDM 食用效果最佳）；4、<a target="_blank" rel="noopener" href="https://greasyfork.org/zh-CN/scripts/26992-%E8%B4%B4%E5%90%A7%E5%85%A8%E8%83%BD%E5%8A%A9%E6%89%8B">贴吧全能助手</a>；5、<a target="_blank" rel="noopener" href="https://greasyfork.org/zh-CN/scripts/36384-%E7%A0%B4%E8%A7%A3vip%E4%BC%9A%E5%91%98%E8%A7%86%E9%A2%91%E9%9B%86%E5%90%88">破解VIP会员视频集合</a>；6、<a target="_blank" rel="noopener" href="https://greasyfork.org/zh-CN/scripts/27116-cat-mouse-translation">Cat Mouse Translation</a>；7、<a target="_blank" rel="noopener" href="https://greasyfork.org/zh-CN/scripts/25718-%E8%A7%A3%E9%99%A4b%E7%AB%99%E5%8C%BA%E5%9F%9F%E9%99%90%E5%88%B6">解除B站区域限制</a>；8、<a target="_blank" rel="noopener" href="https://greasyfork.org/zh-CN/scripts/30879-bye-flash-hello-html5-%E5%86%8D%E8%A7%81flash-%E4%BD%A0%E5%A5%BDhtml5">bye-flash-hello-html5 | 再见flash 你好html5</a>；９、<a target="_blank" rel="noopener" href="https://greasyfork.org/zh-CN/scripts/28497-remove-web-limits">网页限制解除(改)</a>。再顺便说一下这两个浏览器中一些比较好用的插件和好看的主题吧。</p><p>Firefox 最新版的插件 Shaun 目前还没发现几个好用的，但是 <a target="_blank" rel="noopener" href="https://adblockplus.org/">Adblock Plus</a> 绝对是必须要装的，Firefox 的主题 Shaun 目前在用为 <a target="_blank" rel="noopener" href="https://addons.mozilla.org/zh-CN/firefox/addon/blue-space-2/">Blue space 2</a> ；</p><p>而 Chrome 中好用的插件就有很多了，首先自然也是 Adblock Plus，有一个 <a target="_blank" rel="noopener" href="http://autopagerize.net/">AutoPagerize</a> 插件可以替代 Super_preloaderPlus_one 脚本，还有一个 <a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/%E5%88%92%E8%AF%8D%E7%BF%BB%E8%AF%91/ikhdkkncnoglghljlkmcimlnlhkeamad?hl=zh-CN">划词翻译</a> 可以替换 Cat Mouse Translation 脚本，由于 Chrome 没有撤销关闭的标签按钮，只能通过快捷键 Crtl+Shift+T 操作，对于 Shaun 这种习惯用 Firefox 恢复按钮的人来说这很不人性化，所以只能使用 <a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/simpleundoclose/emhohdghchmjepmigjojkehidlielknj?hl=zh-CN">SimpleUndoClose</a> 插件来代替了，当然番茄之所以推荐使用 Chrome 有很大一部分原因在于 Chrome 中有一代理神器 <a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/proxy-switchyomega/padekgcemlokbadohgkifijomclgjgif?hl=zh-CN">Proxy SwitchyOmega</a>，好像也正在开发 Firefox 版的 Proxy SwitchyOmega，已经在 Firefox 测试版上使用了，Chrome 的主题 Shaun 目前在用的为 <a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/blue-space-sunset-chrome/nndfdjfoclbidmgpmbelcieibgjjfdog">Blue Space Sunset Chrome Theme</a> ，浏览器相关的东西就推荐到这里了，接下来推荐下载工具吧。</p><p>附浏览器使用小技巧，有时点击链接不会新建标签页，只是在原标签页刷新，这不符合国人的使用习惯，这时可按住 Crtl 键再点击链接，这时会强制使用新标签页打开链接。</p><p>　　下载工具首推的自然是 <a target="_blank" rel="noopener" href="https://www.internetdownloadmanager.com/download.html"><strong>IDM</strong></a>，全称是：Internet Download Manager；种子和磁力链接的下载工具推荐 <a target="_blank" rel="noopener" href="http://www.utorrent.com/intl/zh/"><strong>μtorrent</strong></a> 或者 <a target="_blank" rel="noopener" href="http://www.bittorrent.com/bittorrent-free"><strong>BitTorrent</strong></a>，好像还有一个 <a target="_blank" rel="noopener" href="https://www.qbittorrent.org/download.php"><strong>qBittorrent</strong></a> ；至于迅雷，勉强推荐个极速版吧，最后一版为 ThunderSpeed1.0.35.366。还有一款免费的下载工具 <a target="_blank" rel="noopener" href="https://www.freedownloadmanager.org/">Free Download Manager</a> 也还不错，可以一定程度上替代 IDM。</p><p>　　解压缩工具首推的是 <a target="_blank" rel="noopener" href="https://www.bandisoft.com/bandizip/cn/"><strong>Bandizip</strong></a>（ta家的图片浏览器 <a target="_blank" rel="noopener" href="https://www.bandisoft.com/honeyview/"><strong>Honeyview</strong></a> 也还不错），其次 <a target="_blank" rel="noopener" href="http://www.7-zip.org/"><strong>7-Zip</strong></a>，最后是 <a target="_blank" rel="noopener" href="https://www.win-rar.com/download.html"><strong>WinRAR</strong></a>（主要是最近版本的广告太恼火，好像 5.2 版本没广告），BTW：IDM 下载百度云的大文件可能会造成部分文件损坏，这时可能需要 WinRAR 的修复工具去修复受损的压缩文件（具体操作为用 WinRAR 打开损坏的压缩文件，选中菜单栏的“<strong>工具</strong>”==》“<strong>修复压缩文件</strong>”），才能解压出正常文件。※附：</p><blockquote><p>其实 WinRAR 官方也有无广告版的，只是下载链接被隐藏，这位大佬：<a target="_blank" rel="noopener" href="http://blog.sina.com.cn/cuibin903"><strong>武文隹山</strong></a>发现了，具体可参考：</p><ol type="1"><li><p><a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_4155bb1d0102x5dh.html">WinRAR官方不带弹窗广告的简体中文版</a>，其隐藏的链接为：</p><blockquote><p>WinRAR5.4官方无广告简体中文版64位 <a target="_blank" rel="noopener" href="http://www.win-rar.com/fileadmin/winrar-versions/sc20160819/wrr/winrar-x64-540sc.exe">下载链接</a>：</p><p><a target="_blank" rel="noopener" href="http://www.win-rar.com/fileadmin/winrar-versions/sc20160819/wrr/winrar-x64-540sc.exe" class="uri">http://www.win-rar.com/fileadmin/winrar-versions/sc20160819/wrr/winrar-x64-540sc.exe</a></p><p>WinRAR5.4官方无广告简体中文版32位 <a target="_blank" rel="noopener" href="http://www.win-rar.com/fileadmin/winrar-versions/sc20160819/wrr/winrar-x32-540sc.exe">下载链接</a>：</p><p><a target="_blank" rel="noopener" href="http://www.win-rar.com/fileadmin/winrar-versions/sc20160819/wrr/winrar-x32-540sc.exe" class="uri">http://www.win-rar.com/fileadmin/winrar-versions/sc20160819/wrr/winrar-x32-540sc.exe</a></p></blockquote></li><li><p><a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_4155bb1d0102xxmr.html">WinRAR5.5官方不带弹窗广告的简体中文版</a>，具体链接为：</p><blockquote><p>WinRAR v5.50 简体中文官方版（试用版，注册后没有广告弹窗！）</p><p>32位：<a target="_blank" rel="noopener" href="http://www.win-rar.com/fileadmin/winrar-versions/sc20170830/wrr/wrar550sc.exe" class="uri">http://www.win-rar.com/fileadmin/winrar-versions/sc20170830/wrr/wrar550sc.exe</a></p><p>64位：<a target="_blank" rel="noopener" href="http://www.win-rar.com/fileadmin/winrar-versions/sc20170830/wrr/winrar-x64-550sc.exe" class="uri">http://www.win-rar.com/fileadmin/winrar-versions/sc20170830/wrr/winrar-x64-550sc.exe</a></p></blockquote><p>列位看官应该从下载链接中发现了其中的规律（๑乛◡乛๑）。</p></li></ol></blockquote><p>　　拼音输入法，Shaun 使用的是 <a target="_blank" rel="noopener" href="https://pinyin.sogou.com/zhihui/"><strong>搜狗拼音智慧版</strong></a>，搜狗拼音的皮肤 Shaun 选择 <a target="_blank" rel="noopener" href="https://pinyin.sogou.com/skins/detail/view/info/418138">雨后莲色</a>，不过有人说 Win10 自带的微软拼音也还行。</p><p>　　至于清理垃圾的可以用 <a target="_blank" rel="noopener" href="https://www.iobit.com/en/advancedsystemcarefree.php"><strong>Advanced SystemCare</strong></a>（ASC），也可以用 <a target="_blank" rel="noopener" href="https://www.piriform.com/ccleaner/download"><strong>CCleaner</strong></a> ，至于 Win10 不需要装杀毒软件，国内的的什么 360 全家桶、百度全家桶、腾讯全家桶（诶，好像就差阿里全家桶了，什么时候阿里再来一个，就装个 BAT 全家桶 （๑乛◡乛๑））可以丢了 （(╯°□°）╯︵ ┻━┻）。</p><p>　　QQ 还是用 <a target="_blank" rel="noopener" href="https://tim.qq.com/"><strong>TIM</strong></a> 版吧。</p><p>　　播放器推荐的是 <a target="_blank" rel="noopener" href="https://potplayer.daum.net/"><strong>Potplayer</strong></a>。不过有一款解码工具叫 <a target="_blank" rel="noopener" href="https://tieba.baidu.com/f?kw=%E7%BB%88%E6%9E%81%E8%A7%A3%E7%A0%81&amp;ie=utf-8"><strong>终极解码</strong></a>，可以充当播放器（很多人确实把它当播放器用，比如 Shaun （๑乛◡乛๑））。</p><p>　　音乐软件 Shaun 用 <a target="_blank" rel="noopener" href="https://music.163.com/">网易云音乐</a>（等升到 10 级就把它卸了，只听本地音乐）。</p><p>　　PDF 阅读器还是推荐 <a target="_blank" rel="noopener" href="https://acrobat.adobe.com/cn/zh-Hans/free-trial-download.html"><strong>Adobe Acrobat_DC</strong></a>，毕竟能和 Office 联合使用，有时 Word 转 PDF 需要加密就靠它了。</p><p>　　截图工具推荐 <a target="_blank" rel="noopener" href="http://www.faststone.org/download.htm"><strong>FastStone Capture</strong></a>（<em>FSCapture</em>），国人的 <a target="_blank" rel="noopener" href="https://zh.snipaste.com/index.html">Snipaste</a> 也非常不错。</p><h2 id="小众篇">小众篇</h2><p>　　远程控制工具当然推荐 <a target="_blank" rel="noopener" href="https://www.teamviewer.com/zhCN/"><strong>TeamViewer</strong></a>。</p><p>　　文件管理相关强推 搜索工具 <a target="_blank" rel="noopener" href="https://www.voidtools.com/downloads/"><strong>Everything</strong></a> 和文件资源管理器（即 Windows 快捷键「<strong>Win+E</strong>」打开的「<strong>我的电脑</strong>」）增强工具 <a target="_blank" rel="noopener" href="http://www.listary.com/"><strong>Listary</strong></a> （有个开源实现的同类产品 <a target="_blank" rel="noopener" href="http://www.wox.one/"><strong>Wox</strong></a> ，还有国产的 <a target="_blank" rel="noopener" href="http://www.huoying666.com/"><strong>火萤酱</strong></a> 也很不错，而且功能更全且附带一些实用小工具），这两个工具有重叠的地方，如果硬要只装一个的话推荐后者。还有一个文件管理器增强工具 <a target="_blank" rel="noopener" href="http://qttabbar.wikidot.com/"><strong>QTTabBar</strong></a> ，可以为文件管理器增加标签页，类似于浏览器标签页那种，当然还有其它一些功能。当然 Windows 下最强的文件管理器当属 <a target="_blank" rel="noopener" href="http://www.ghisler.com/"><strong>Total Commander</strong></a>，只是学习成本略高。</p><p>　　快捷键程序快速启动工具 <a target="_blank" rel="noopener" href="https://github.com/hui-Zz/RunAny"><strong>RunAny</strong></a> ，修改配置文件可以通过快捷键快速启动任意程序，以任意程序打开文件，该工具集成 Everything 和支持 <a target="_blank" rel="noopener" href="https://autohotkey.com/"><strong>AutoHotkey</strong></a> 热键格式。</p><p>　　<a target="_blank" rel="noopener" href="http://www.office-tabs.com/"><strong>Office Tabs</strong></a> 给 Microsoft Office 添加标签页界面，类似于浏览器标签页那种，以实现文档快速切换。</p><p>　　<a target="_blank" rel="noopener" href="https://www.moo0.com/software/SystemMonitor/"><strong>Moo0 System Monitor</strong></a> 系统监视器，可视化监控内存 / 磁盘 / 网络 / CPU 等运行状态。</p><p><strong><em>再推荐一些程序员的工具吧。</em></strong></p><p>　　首先当然是编辑器（可别和编译器搞混了），Shaun 就不加入 Vim 和 Emacs 的党争了，就直接推荐 <a target="_blank" rel="noopener" href="https://code.visualstudio.com/"><strong>VS Code</strong></a>吧（巨硬出品，必属精品（^_^））。</p><p>　　Windows 下的命令行没一个好用的，要真矮子里面挑高个的话，只能推荐 <a target="_blank" rel="noopener" href="https://git-scm.com/downloads"><strong>Git Bash</strong></a> 了，其实以前有个 Babun 也挺好用的，可惜早已停止更新。但是 Git Bash 有时输出中文会乱码，Windows 下真正的命令行神器是 <a target="_blank" rel="noopener" href="http://cmder.net/"><strong>Cmder</strong></a>，完整包直接集成 Git for Windows，也就是包含 Git Bash，mini 包只包含基本命令行工具，关于 Cmder 的一些设置和用法可参考 <a target="_blank" rel="noopener" href="https://jeffjade.com/2016/01/13/2016-01-13-windows-software-cmder/">Win下必备神器之Cmder</a>，解压之后为了方便通过右键菜单使用 Cmder，需要在配置好之后以管理员方式执行 <code>Cmder.exe /REGISTER ALL</code> 命令。</p><p>　　Markdown 编辑器推荐的是 <a target="_blank" rel="noopener" href="https://typora.io/#download"><strong>Typora</strong></a>，不过现在还是 Beta 版，也还能使用，期待正式版，希望到时即使收费的话也能继续推出一个免费版。（推出正式版看看效果怎么样吧，如果真的很不错就去支持一下，如果改进不大的话我还是老老实实继续用 beta 版吧）。</p><p>　　在 VS 下写 C++ 自然少不了 <a target="_blank" rel="noopener" href="https://www.wholetomato.com/"><strong>Visual Assist X</strong></a> 这款插件，用 OpenCV 的自然少不了 <a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=WolfKienzle.ImageWatch"><strong>ImageWatch</strong></a>（ <a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=VisualCPPTeam.ImageWatch2017">VS2017版ImageWatch</a> ）这款神器。</p><p>　　编程的字体 Shaun 目前在用是 <a target="_blank" rel="noopener" href="http://www.vimer.cn/wp-content/uploads/2009/11/arimonnew.ttf"><strong>Arial monospaced for SAP(优化版)</strong></a>（<a target="_blank" rel="noopener" href="http://www.vimer.cn/archives/396.html/comment-page-1" class="uri">http://www.vimer.cn/archives/396.html/comment-page-1</a>），背景颜色使用护眼色：R: 204，G: 232，B: 207。</p><p>　　代理工具：Shaun 使用的是 <a target="_blank" rel="noopener" href="https://github.com/XX-net/XX-Net"><strong>XX-Net</strong></a> 和 <a target="_blank" rel="noopener" href="https://getlantern.org/zh_CN/"><strong>Lantern</strong></a>，非特殊情况还是很好用的，还有比较推荐的是 <a target="_blank" rel="noopener" href="https://psiphon3.com/zh/download.html"><strong>赛风</strong></a>。</p><h2 id="偏门篇">偏门篇</h2><p>　　鼠标手势软件 <a target="_blank" rel="noopener" href="http://www.yingdev.com/projects/wgestures"><strong>WGestures</strong></a>，可以利用鼠标手势做一些前进后退，复制粘贴搜索等简单操作。</p><p>　　<a target="_blank" rel="noopener" href="http://www.yingdev.com/projects/tickeys"><strong>Tickeys</strong></a>，让打字发出音效。</p><p>　　Windows 系统优（mei）化工具 <a target="_blank" rel="noopener" href="http://www.chuyu.me/zh-Hans/index.html"><strong>Dism++</strong></a> ，桌面美化工具可以用雨滴桌面 <a target="_blank" rel="noopener" href="https://www.rainmeter.net/"><strong>Rainmeter</strong></a>，或<a target="_blank" rel="noopener" href="http://mofang.ruanmei.com/">软媒魔方<strong><em>绿色版</em></strong></a>（<strong>※注：</strong>软媒魔方一定要是绿色版），桌面美化工具需要占用一定的配置，配置不高的老电脑还是别用比较好。</p><h2 id="后记">后记</h2><p>如果以后碰到更多有意思的小东西再和大家分享吧 ↖(^ω^)↗。</p></div><div class="article-content-more"><button type="button" class="article-more--link"><i class="fa fa-angle-double-down fa-3x" aria-hidden="true"></i></button></div></section></article><article id="post-解决无法打开某个网页问题" class="article div-border"><header class="article-header"><span class="article-date article-title--index"><i class="fa fa-calendar" aria-hidden="true"></i> <a href="/posts/376168c6.html"><time datetime="2017-12-07T08:06:53.000Z">2017-12-07</time></a></span><section class="article-title article-title--index"><a href="/posts/376168c6.html">解决无法打开某个网页问题</a></section><div class="article-label"><div class="article-category label"><i class="fa fa-book" aria-hidden="true"></i> <a class="color3 article-category-link" href="/categories/Problems/">Problems</a></div><div class="article-tag label"><i class="fa fa-bookmark" aria-hidden="true"></i> <a class="color3 article-tag-none-link" href="/tags/network/" rel="tag">network</a></div></div></header><section class="article-content"><div class="article-content--excerpt"><h2 id="前言">前言</h2><p>　　Shaun 最近在某台 Win10 的电脑中打开网页 <a target="_blank" rel="noopener" href="https://www.typora.io/" class="uri">https://www.typora.io/</a> 时出现了问题，一直出现无法连接现象。</p></div><div class="article-content--all"><h2 id="前言">前言</h2><p>　　Shaun 最近在某台 Win10 的电脑中打开网页 <a target="_blank" rel="noopener" href="https://www.typora.io/" class="uri">https://www.typora.io/</a> 时出现了问题，一直出现无法连接现象。</p><span id="more"></span><h2 id="问题篇">问题篇</h2><p>Chrome 中出现：</p><blockquote><p><strong>未连接到互联网</strong></p><p>请试试以下办法：</p><ul><li>检查网线、调制解调器和路由器</li><li>重新连接到 Wi-Fi 网络</li><li><a href="javascript:diagnoseErrors()">运行 Windows 网络诊断</a></li></ul><p>DNS_PROBE_FINISHED_NO_INTERNET</p></blockquote><p>Firefox 中出现：</p><blockquote><p>我们无法连接至 www.typora.io 的服务器。 如果确定此网址正确，您可以尝试：</p><ul><li>过会儿再重试。</li><li>检查您的网络连接是否正常。</li><li>如果您部署有网络防火墙，请检查 Firefox 是否已被授权访问网络。</li></ul></blockquote><p>手机和其它设备在同一网络下能正常连接，打开 host 文件也没发现域名被劫持的情况，挂代理也能连接上。</p><h2 id="解决方案篇">解决方案篇</h2><p>Shaun 尝试过的方法：</p><ol type="1"><li><p>刷新 DNS 缓存：在命令行界面中输入 <code>ipconfig /flushdns</code>，无效；</p></li><li><p>改 DNS 服务器：把电脑的 dns 修改为首选 8.8.8.8，备用 114.114.114.114，和将首选改成 8.8.4.4 均无效；</p></li><li><p>Disable Path MTU discovery，具体操作方法为：</p><blockquote><p>单击“开始”，单击“运行”，键入 regedit，然后单击“确定”。</p><p>在注册表中找到下面的项： <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters</code></p><p>找到<code>EnablePMTUDiscovery</code>，将其值改为 0，如果没找到，则在“编辑”菜单上，指向“新建”，然后单击“DWORD 值”，键入 EnablePMTUDiscovery，然后按 Enter，在“编辑”菜单上，单击“修改”，在“数值数据”框中，键入 0，然后单击“确定”。</p><p>退出注册表编辑器，然后重新启动计算机。</p></blockquote></li><li><p>设置 MTU 值，将其调小，完美解决。具体操作方法为：以管理员身份运行命令提示符，在命令行界面输入 <code>netsh interface ipv4 show subinterfaces</code>，查看传入字节和传出字节的接口，修改对应接口的 MTU 的值，具体命令为：<code>netsh interface ipv4 set subinterface "对应接口名" mtu=值 store=persistent</code>，其中 <strong>对应接口名</strong> 和 <strong>值</strong> 需要替换成相应修改的东西。</p></li></ol><h2 id="后记">后记</h2><p>　　将 MTU 值调小，可能会造成网速变慢，但 Shaun 又无法去改变其它的东西，既然不能改变其它，只能改变自己喽 ╮(╯﹏╰)╭。但 Shaun 这里觉得奇怪的是：别人的电脑设置默认 MTU 的值为 1500 也能访问啊，无奈 （╯‵□′）╯︵┴─┴。</p><h2 id="参考资料">参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="https://www.zhihu.com/question/23627621">电脑上部分网页打不开，但是手机可以，如何解决？</a></p><p>[2] <a target="_blank" rel="noopener" href="https://jingyan.baidu.com/article/ad310e80ff9bf81849f49ea9.html">mtu值怎样设置才网速最快</a></p></div><div class="article-content-more"><button type="button" class="article-more--link"><i class="fa fa-angle-double-down fa-3x" aria-hidden="true"></i></button></div></section></article><article id="post-PyQt5使用小结" class="article div-border"><header class="article-header"><span class="article-date article-title--index"><i class="fa fa-calendar" aria-hidden="true"></i> <a href="/posts/5f54aa2c.html"><time datetime="2017-11-12T13:10:16.000Z">2017-11-12</time></a></span><section class="article-title article-title--index"><a href="/posts/5f54aa2c.html">PyQt5使用小结</a></section><div class="article-label"><div class="article-category label"><i class="fa fa-book" aria-hidden="true"></i> <a class="color3 article-category-link" href="/categories/Study/">Study</a></div><div class="article-tag label"><i class="fa fa-bookmark" aria-hidden="true"></i> <a class="color4 article-tag-none-link" href="/tags/opencv/" rel="tag">opencv</a><a class="color4 article-tag-none-link" href="/tags/python/" rel="tag">python</a><a class="color4 article-tag-none-link" href="/tags/qt/" rel="tag">qt</a></div></div></header><section class="article-content"><div class="article-content--excerpt"><p><font color="#FA8072">本文所用的 Python 版本为 python-3.6.2，PyQt5 版本为 pyqt5-5.9.1，OpenCV 版本为 opencv-python-3.3.0.10 和 opencv-contrib-python-3.3.0.10，TensorFlow 版本为 tensorflow-1.4.0，编程语言为 python3，系统环境为 Windows 10。</font></p><h2 id="前言">前言</h2><p>　　本文是上一篇（<a href="https://cniter.github.io/posts/82d3b275.html">TensorFlow Object Detection API使用小结</a>）的后续，因为那个 project 还需要一个界面，所以 Shaun 使用 PyQt 做了这么个界面，其中借用 OpenCV 的图像数据显示。</p></div><div class="article-content--all"><p><font color="#FA8072">本文所用的 Python 版本为 python-3.6.2，PyQt5 版本为 pyqt5-5.9.1，OpenCV 版本为 opencv-python-3.3.0.10 和 opencv-contrib-python-3.3.0.10，TensorFlow 版本为 tensorflow-1.4.0，编程语言为 python3，系统环境为 Windows 10。</font></p><h2 id="前言">前言</h2><p>　　本文是上一篇（<a href="https://cniter.github.io/posts/82d3b275.html">TensorFlow Object Detection API使用小结</a>）的后续，因为那个 project 还需要一个界面，所以 Shaun 使用 PyQt 做了这么个界面，其中借用 OpenCV 的图像数据显示。</p><span id="more"></span><h2 id="准备篇">准备篇</h2><p>　　首先使用 pip 安装所需库，由于上一篇已经安装了 tensorflow，所以本文其实只需要安装 pyqt5 和 opencv-python 就可以了，安装 pyqt5 指令为：<code>pip install pyqt5</code>，相关依赖关系解决办法在上一篇中已提到，这里不再赘述，然后再使用指令 <code>pip install opencv-python</code> 安装 opencv，这里 Shaun 发现在 python 中配置 OpenCV 简直不要太轻爽 O(∩_∩)O~~，就一个 pip 就解决了，哪有 C++ 那么麻烦，以后可能还会继续使用 python 版的 opencv，所以就顺便把它 python 版的扩展包也顺便一起装上，安装指令为：<code>pip install opencv-contrib-python</code>。至此所需环境库安装完毕。</p><p>　　<strong>※注</strong>：相对于上文中使用 pip 在线安装的方式，还有另一种使用 pip 进行离线安装的方式，在 <a target="_blank" rel="noopener" href="https://www.lfd.uci.edu/~gohlke/pythonlibs/">Unofficial Windows Binaries for Python Extension Packages</a>上下载离线包，即 XXXXXX.whl 文件，文件名一般包含库名称和对应版本、python 版本以及是 64 位还是 32 位的等信息，这里以离线包 <a target="_blank" rel="noopener" href="https://www.lfd.uci.edu/~gohlke/pythonlibs/#numpy">numpy-1.13+mkl</a> 为例，首先下载适合自己的库版本，适合 Shaun 的当然是 numpy-1.13.3+mkl-cp36-cp36m-win_amd64.whl（这适合 64 位的 python3.6 安装），将命令行目录切换至 numpy-1.13.3+mkl-cp36-cp36m-win_amd64.whl 文件所在目录，输入指令 <code>pip install numpy-1.13.3+mkl-cp36-cp36m-win_amd64.whl</code> 即可离线安装 numpy-1.13+mkl 库。相比在线安装，这种离线安装更加灵活，而且能够安装一些在线安装无法安装的库，像上文中的 numpy-1.13+mkl 库只能采取离线安装的方式，在线安装只能安装不带 mkl 的 numpy 库。采用离线安装方式也可以直接安装带扩展包的 opencv-python库：<em>opencv_python‑3.3.1+contrib‑cp36‑cp36m‑win_amd64.whl</em> ，不需要像在线安装那样装两个库。</p><h2 id="实践篇">实践篇</h2><p>　　以前有用过 Qt 的基础，所以这次使用 PyQt5 感觉上手很快，毕竟这里面的语法有很多是相通的，再加上网上的资料也有很多，所以很快就做了个简陋的界面。不过直接用代码控制界面的布局确实很麻烦，每改下布局都要重新运行一下看看，而且启动时间还有点长 ╮(╯﹏╰）╭。网上有种说法是：</p><blockquote><p>可以先通过QtDesigner设计UI，然后通过Qt提供的命令行工具pyuic5将.ui文件转换成python代码，具体用法是：若ui文件名称为firstPyQt5.ui，则在命令行界面中输入指令：<code>pyuic5 -o firstPyQt5.py firstPyQt5.ui</code>，即可将firstPyQt5.ui文件转换成python代码文件firstPyQt5.py</p></blockquote><p>不过 Shaun 这里由于界面比较简陋，没有几个控件，所以就直接将其用 python 代码控制了，没去尝试这个命令行工具 pyuic5 了，下次有机会再尝试吧 ↖(^ω^)↗。</p><p>　　Shaun 做的这个小界面实现的功能是：1、可以选择已经训练好的模型来检测选定图片中的目标；2、可以播放选定的视频；3、还有打开摄像头，显示摄像头拍摄的视频。</p><p>其中由于 Shaun 电脑无法实时检测目标，所以在视频和摄像头拍摄中就没有添加检测的代码，只有选择图片时才会执行检测功能，有需要的童靴可以自行添加(•̀ᴗ•́)。</p><p>附完整代码如下：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="PYTHON"><div class="code-copy"></div><figure class="highlight hljs python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys  </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PyQt5.QtCore <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> PyQt5.QtWidgets <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> PyQt5.QtGui <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> object_detection.utils <span class="keyword">import</span> label_map_util</span><br><span class="line"><span class="keyword">from</span> object_detection.utils <span class="keyword">import</span> visualization_utils <span class="keyword">as</span> vis_util</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Detector</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.PATH_TO_CKPT = <span class="string">&#x27;./model/hand_model_faster_rcnn_resnet101.pb&#x27;</span>   <span class="comment"># 选择模型文件</span></span><br><span class="line">        self.PATH_TO_LABELS = <span class="string">r&#x27;./model/hands_label_map.pbtxt&#x27;</span>  <span class="comment"># 选择类别标签文件</span></span><br><span class="line">        self.NUM_CLASSES = <span class="number">1</span></span><br><span class="line">        self.detection_graph = self._load_model()   <span class="comment"># 加载模型</span></span><br><span class="line">        self.category_index = self._load_label_map()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_load_model</span>(<span class="params">self</span>):</span></span><br><span class="line">        detection_graph = tf.Graph()</span><br><span class="line">        <span class="keyword">with</span> detection_graph.as_default():</span><br><span class="line">            od_graph_def = tf.GraphDef()</span><br><span class="line">            <span class="keyword">with</span> tf.gfile.GFile(self.PATH_TO_CKPT, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fid:</span><br><span class="line">                serialized_graph = fid.read()</span><br><span class="line">                od_graph_def.ParseFromString(serialized_graph)</span><br><span class="line">                tf.import_graph_def(od_graph_def, name=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> detection_graph</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_load_label_map</span>(<span class="params">self</span>):</span></span><br><span class="line">        label_map = label_map_util.load_labelmap(self.PATH_TO_LABELS)</span><br><span class="line">        categories = label_map_util.convert_label_map_to_categories(label_map,</span><br><span class="line">                                                                    max_num_classes=self.NUM_CLASSES,</span><br><span class="line">                                                                    use_display_name=<span class="literal">True</span>)</span><br><span class="line">        category_index = label_map_util.create_category_index(categories)</span><br><span class="line">        <span class="keyword">return</span> category_index</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">detect</span>(<span class="params">self, image</span>):</span></span><br><span class="line">        <span class="keyword">with</span> self.detection_graph.as_default():</span><br><span class="line">            <span class="keyword">with</span> tf.Session(graph=self.detection_graph) <span class="keyword">as</span> sess:</span><br><span class="line">                <span class="comment"># Expand dimensions since the model expects images to have shape: [1, None, None, 3]</span></span><br><span class="line">                image_np_expanded = np.expand_dims(image, axis=<span class="number">0</span>)</span><br><span class="line">                image_tensor = self.detection_graph.get_tensor_by_name(<span class="string">&#x27;image_tensor:0&#x27;</span>)</span><br><span class="line">                boxes = self.detection_graph.get_tensor_by_name(<span class="string">&#x27;detection_boxes:0&#x27;</span>)</span><br><span class="line">                scores = self.detection_graph.get_tensor_by_name(<span class="string">&#x27;detection_scores:0&#x27;</span>)</span><br><span class="line">                classes = self.detection_graph.get_tensor_by_name(<span class="string">&#x27;detection_classes:0&#x27;</span>)</span><br><span class="line">                num_detections = self.detection_graph.get_tensor_by_name(<span class="string">&#x27;num_detections:0&#x27;</span>)</span><br><span class="line">                <span class="comment"># Actual detection.</span></span><br><span class="line">                (boxes, scores, classes, num_detections) = sess.run(</span><br><span class="line">                    [boxes, scores, classes, num_detections],</span><br><span class="line">                    feed_dict=&#123;image_tensor: image_np_expanded&#125;)</span><br><span class="line">                <span class="comment"># Visualization of the results of a detection.</span></span><br><span class="line">                vis_util.visualize_boxes_and_labels_on_image_array(</span><br><span class="line">                    image,</span><br><span class="line">                    np.squeeze(boxes),</span><br><span class="line">                    np.squeeze(classes).astype(np.int32),</span><br><span class="line">                    np.squeeze(scores),</span><br><span class="line">                    self.category_index,</span><br><span class="line">                    use_normalized_coordinates=<span class="literal">True</span>,</span><br><span class="line">                    line_thickness=<span class="number">8</span>)</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> image</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DetectUI</span>(<span class="params">QWidget</span>):</span></span><br><span class="line">     </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">super</span>().__init__()</span><br><span class="line">         </span><br><span class="line">        self.initUI()</span><br><span class="line">        self.detector = Detector()</span><br><span class="line">        self.cap = cv2.VideoCapture()</span><br><span class="line">         </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">initUI</span>(<span class="params">self</span>):</span>  </span><br><span class="line">        self.timer = QTimer(self)   <span class="comment"># 初始化一个定时器</span></span><br><span class="line">        self.timer.timeout.connect(self.showFrame)  <span class="comment"># 计时结束调用showFrame()方法</span></span><br><span class="line">        </span><br><span class="line">        self.show_pic_label = QLabel(self) </span><br><span class="line">        self.show_pic_label.resize(<span class="number">640</span>, <span class="number">480</span>)</span><br><span class="line">        self.show_pic_label.move(<span class="number">10</span>, <span class="number">10</span>)</span><br><span class="line">        self.show_pic_label.setStyleSheet(<span class="string">&quot;border-width: 1px; border-style: solid; border-color: rgb(255, 170, 0);&quot;</span>)            </span><br><span class="line"></span><br><span class="line">        self.show_filename_lineEdit = QLineEdit(self) </span><br><span class="line">        self.show_filename_lineEdit.resize(<span class="number">200</span>, <span class="number">22</span>)</span><br><span class="line">        self.show_filename_lineEdit.move(<span class="number">10</span>, <span class="number">500</span>) </span><br><span class="line"></span><br><span class="line">        self.select_img_btn = QPushButton(<span class="string">&#x27;Select File&#x27;</span>, self)   </span><br><span class="line">        self.select_img_btn.clicked.connect(self.selectImg) </span><br><span class="line">        self.select_img_btn.resize(self.select_img_btn.sizeHint())</span><br><span class="line">        self.select_img_btn.move(<span class="number">218</span>, <span class="number">500</span>) </span><br><span class="line"></span><br><span class="line">        self.open_camera_btn = QPushButton(<span class="string">&#x27;Open Camera&#x27;</span>, self)   </span><br><span class="line">        self.open_camera_btn.clicked.connect(self.openCamera) </span><br><span class="line">        self.open_camera_btn.resize(self.open_camera_btn.sizeHint())</span><br><span class="line">        self.open_camera_btn.move(<span class="number">292</span>, <span class="number">500</span>)</span><br><span class="line"></span><br><span class="line">        self.select_model_btn = QPushButton(<span class="string">&#x27;Select Model&#x27;</span>, self)   </span><br><span class="line">        self.select_model_btn.clicked.connect(self.selectModel) </span><br><span class="line">        self.select_model_btn.resize(self.select_model_btn.sizeHint())</span><br><span class="line">        self.select_model_btn.move(<span class="number">366</span>, <span class="number">500</span>) </span><br><span class="line"></span><br><span class="line">        self.show_modelname_lineEdit = QLineEdit(self) </span><br><span class="line">        self.show_modelname_lineEdit.setText(<span class="string">&#x27;hand_model_faster_rcnn_resnet101.pb&#x27;</span>)</span><br><span class="line">        self.show_modelname_lineEdit.resize(<span class="number">200</span>, <span class="number">22</span>)</span><br><span class="line">        self.show_modelname_lineEdit.move(<span class="number">450</span>, <span class="number">500</span>) </span><br><span class="line"></span><br><span class="line">        self.setGeometry(<span class="number">200</span>, <span class="number">100</span>, <span class="number">660</span>, <span class="number">530</span>)</span><br><span class="line">        self.setWindowTitle(<span class="string">&#x27;Hand Detector&#x27;</span>)   </span><br><span class="line">        self.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showImg</span>(<span class="params">self, src_img, qlabel</span>):</span></span><br><span class="line">        src_img = cv2.cvtColor(src_img, cv2.COLOR_BGR2RGB)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># src_img = self.detector.detect(src_img) # 检测目标</span></span><br><span class="line"></span><br><span class="line">        height, width, bytesPerComponent = src_img.shape</span><br><span class="line">        bytesPerLine = bytesPerComponent * width</span><br><span class="line">        <span class="comment"># 转为QImage对象</span></span><br><span class="line">        q_image = QImage(src_img.data, width, height, bytesPerLine, QImage.Format_RGB888)</span><br><span class="line">        qlabel.setPixmap(QPixmap.fromImage(q_image).scaled(qlabel.width(), qlabel.height())) </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">showFrame</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span>(self.cap.isOpened()):</span><br><span class="line">            ret, frame = self.cap.read()</span><br><span class="line">            <span class="keyword">if</span> ret:</span><br><span class="line">                self.showImg(frame, self.show_pic_label)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.cap.release()</span><br><span class="line">                self.timer.stop()   <span class="comment"># 停止计时器</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">selectImg</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.cap.isOpened():</span><br><span class="line">            self.cap.release()</span><br><span class="line"></span><br><span class="line">        file_name, file_type = QFileDialog.getOpenFileName(self,  </span><br><span class="line">                                    <span class="string">&quot;选取文件&quot;</span>,  </span><br><span class="line">                                    <span class="string">&quot;./&quot;</span>,  </span><br><span class="line">                                    <span class="string">&quot;Image Files (*.jpg *.png *.bmp *.tif);;Video Files (*.avi *.mp4)&quot;</span>)   <span class="comment">#设置文件扩展名过滤,注意用双分号间隔过滤，用空格分隔多个文件  </span></span><br><span class="line">        <span class="comment"># print(file_name,file_type)</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> file_type.find(<span class="string">&quot;Image&quot;</span>) &gt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> file_name:</span><br><span class="line">                self.show_filename_lineEdit.setText(os.path.split(file_name)[<span class="number">1</span>])</span><br><span class="line">            </span><br><span class="line">                img = cv2.imread(file_name, cv2.IMREAD_COLOR)</span><br><span class="line">                cv2.cvtColor(img, cv2.COLOR_BGR2RGB, img)</span><br><span class="line"></span><br><span class="line">                img = self.detector.detect(img) <span class="comment"># 检测目标</span></span><br><span class="line"></span><br><span class="line">                height, width, bytesPerComponent = img.shape</span><br><span class="line">                bytesPerLine = bytesPerComponent * width</span><br><span class="line">                <span class="comment"># 转为QImage对象</span></span><br><span class="line">                q_image = QImage(img.data, width, height, bytesPerLine, QImage.Format_RGB888)</span><br><span class="line">                self.show_pic_label.setPixmap(QPixmap.fromImage(q_image).scaled(self.show_pic_label.width(), self.show_pic_label.height()))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> file_type.find(<span class="string">&quot;Video&quot;</span>) &gt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> file_name:</span><br><span class="line">                self.show_filename_lineEdit.setText(os.path.split(file_name)[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">                self.cap.<span class="built_in">open</span>(file_name)</span><br><span class="line">                self.timer.start(<span class="number">30</span>)    <span class="comment"># 设置时间隔30ms并启动</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">openCamera</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.cap.<span class="built_in">open</span>(<span class="number">0</span>)    <span class="comment"># 默认打开0号摄像头</span></span><br><span class="line">        self.timer.start(<span class="number">30</span>)    <span class="comment"># 设置时间隔30ms并启动</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">selectModel</span>(<span class="params">self</span>):</span>  </span><br><span class="line">        model_name, file_type = QFileDialog.getOpenFileName(self,  </span><br><span class="line">                                    <span class="string">&quot;选取文件&quot;</span>,  </span><br><span class="line">                                    <span class="string">&quot;./&quot;</span>,  </span><br><span class="line">                                    <span class="string">&quot;model Files (*.pb);;All Files (*)&quot;</span>)   <span class="comment">#设置文件扩展名过滤,注意用双分号间隔过滤，用空格分隔多个文件  </span></span><br><span class="line">               </span><br><span class="line">        <span class="keyword">if</span> model_name:</span><br><span class="line">            self.show_modelname_lineEdit.setText(os.path.split(model_name)[<span class="number">1</span>])</span><br><span class="line">            self.detector.PATH_TO_CKPT = model_name</span><br><span class="line">            self.detector.detection_graph = self.detector._load_model() <span class="comment"># 重新加载模型</span></span><br><span class="line">         </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app = QApplication(sys.argv)</span><br><span class="line">    dtcui = DetectUI()</span><br><span class="line">    sys.exit(app.exec_())</span><br></pre></td></tr></table></figure></div><h2 id="后记">后记</h2><p>　　初次使用 Python 做一个小东西，其语法确实简洁，不过对于 Shaun 这种习惯用 C++ 的人来说确实还有点不太习惯 (˘•ω•˘)。</p><h2 id="参考资料">参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="http://blog.csdn.net/m0_37928067/article/details/75883535">用PyQt5+Caffe+Opencv搭建一个人脸识别登录界面</a></p><p>[2] <a target="_blank" rel="noopener" href="http://blog.csdn.net/a359680405/article/details/45166271">PyQt5学习笔记09----标准文件打开保存框QFileDialog</a></p><p>[3] <a target="_blank" rel="noopener" href="http://www.cnblogs.com/archisama/p/5444032.html">PyQt5教程——第一个程序（2）</a>（<a target="_blank" rel="noopener" href="http://www.cnblogs.com/archisama/tag/PyQt5/" class="uri">http://www.cnblogs.com/archisama/tag/PyQt5/</a>）</p><p>[4] <a target="_blank" rel="noopener" href="http://www.cnblogs.com/skynet/p/4229556.html">PyQt5应用与实践</a></p><p>[5] <a target="_blank" rel="noopener" href="http://www.cnblogs.com/tkinter/p/5632245.html">PyQt5系列教程(二)利用QtDesigner设计UI界面</a>（<a target="_blank" rel="noopener" href="http://www.cnblogs.com/tkinter/tag/pyqt5/" class="uri">http://www.cnblogs.com/tkinter/tag/pyqt5/</a>）</p><p>[6] <a target="_blank" rel="noopener" href="https://docs.opencv.org/3.2.0/index.html">OpenCV 3.2.0</a>/<a target="_blank" rel="noopener" href="https://docs.opencv.org/3.2.0/d6/d00/tutorial_py_root.html">OpenCV-Python Tutorials</a>/<a target="_blank" rel="noopener" href="https://docs.opencv.org/3.2.0/dc/d4d/tutorial_py_table_of_contents_gui.html">Gui Features in OpenCV</a>/<a target="_blank" rel="noopener" href="https://docs.opencv.org/3.2.0/dc/d2e/tutorial_py_image_display.html">Getting Started with Images</a></p><p>[7] <a target="_blank" rel="noopener" href="https://docs.opencv.org/3.2.0/index.html">OpenCV 3.2.0</a>/<a target="_blank" rel="noopener" href="https://docs.opencv.org/3.2.0/d6/d00/tutorial_py_root.html">OpenCV-Python Tutorials</a>/<a target="_blank" rel="noopener" href="https://docs.opencv.org/3.2.0/dc/d4d/tutorial_py_table_of_contents_gui.html">Gui Features in OpenCV</a>/<a target="_blank" rel="noopener" href="https://docs.opencv.org/3.2.0/dd/d43/tutorial_py_video_display.html">Getting Started with Videos</a></p><p>[8] <a target="_blank" rel="noopener" href="http://blog.csdn.net/keenweiwei/article/details/9037757">python3.3 分割路径与文件名 小例</a></p></div><div class="article-content-more"><button type="button" class="article-more--link"><i class="fa fa-angle-double-down fa-3x" aria-hidden="true"></i></button></div></section></article><article id="post-TensorFlow-Object-Detection-API使用小结" class="article div-border"><header class="article-header"><span class="article-date article-title--index"><i class="fa fa-calendar" aria-hidden="true"></i> <a href="/posts/82d3b275.html"><time datetime="2017-11-11T13:52:52.000Z">2017-11-11</time></a></span><section class="article-title article-title--index"><a href="/posts/82d3b275.html">TensorFlow Object Detection API使用小结</a></section><div class="article-label"><div class="article-category label"><i class="fa fa-book" aria-hidden="true"></i> <a class="color3 article-category-link" href="/categories/Image-Graphic/">Image&Graphic</a></div><div class="article-tag label"><i class="fa fa-bookmark" aria-hidden="true"></i> <a class="color4 article-tag-none-link" href="/tags/cv/" rel="tag">cv</a><a class="color4 article-tag-none-link" href="/tags/tensorflow/" rel="tag">tensorflow</a></div></div></header><section class="article-content"><div class="article-content--excerpt"><p><font color="#FA8072">本文所用的 Python 版本为 python-3.6.2，TensorFlow 版本为tensorflow-1.4.0，编程语言为 python3，系统环境为 Windows 10。</font></p><h2 id="前言">前言</h2><p>　　很久没写过东西了，主要原因是最近研究生课程开始陆续结课，Shaun 也要忙于应付各种结课时的考试、论文、project 等一堆麻烦事。这不深度学习结课时需要做个 project，Shaun 也顺便将做这个 project 的过程记录下来。</p></div><div class="article-content--all"><p><font color="#FA8072">本文所用的 Python 版本为 python-3.6.2，TensorFlow 版本为tensorflow-1.4.0，编程语言为 python3，系统环境为 Windows 10。</font></p><h2 id="前言">前言</h2><p>　　很久没写过东西了，主要原因是最近研究生课程开始陆续结课，Shaun 也要忙于应付各种结课时的考试、论文、project 等一堆麻烦事。这不深度学习结课时需要做个 project，Shaun 也顺便将做这个 project 的过程记录下来。</p><span id="more"></span><h2 id="准备篇">准备篇</h2><p>　　该 project 主要利用 TensorFlow 中的 Object Detection API 进行训练和检测。在开始使用该 API 之前需要安装配置 Python 环境。</p><p>　　既然是 Python 首先需要 <a target="_blank" rel="noopener" href="https://www.python.org/downloads/">下载安装Python</a>，安装完之后，为了顺利使用 pip 需要配置环境变量，在 Windows 系统环境变量中 Path 末尾添加：</p><table><colgroup><col style="width:9%"><col style="width:90%"></colgroup><thead><tr class="header"><th style="text-align:center">变量名</th><th style="text-align:center">变量值</th></tr></thead><tbody><tr class="odd"><td style="text-align:center">Path</td><td style="text-align:center">;C:\Users\admin\AppData\Local\Programs\Python\Python36\; C:\Users\admin\AppData\Local\Programs\Python\Python36\Scripts\</td></tr></tbody></table><p>其中 <code>C:\Users\admin\AppData\Local\Programs\Python\Python36</code> 为 python-3.6.2 默认安装目录。</p><p>　　然后为了方便使用命令行工具，<a target="_blank" rel="noopener" href="https://www.git-scm.com/download/">下载安装git</a>，安装方式一路默认即可。</p><p>　　接下来利用 pip 安装 TensorFlow，鼠标右键桌面空白处，点击“<strong>Git Bash Here</strong>”，打开 bash 命令行，输入 <code>pip install tensorflow</code>，其中一些依赖关系可能需要手动解决，手动解决的办法就是用 pip install 相关依赖库，这是 CPU 版的 TensorFlow，若要使用 GPU，则需要安装 GPU 版的 TensorFlow，安装命令为：<code>pip install tensorflow-gpu</code>，以同样方式解决依赖关系。由于 Shaun 电脑没 N 卡，所以没安装 GPU 版的 TensorFlow，所以如果想使用 GPU 版的 TensorFlow 请另行尝试。</p><p>　　然后安装 TensorFlow Object Detection API 依赖库，在命令行中输入：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="BASH"><div class="code-copy"></div><figure class="highlight hljs bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pip install pillow</span><br><span class="line">pip install lxml</span><br><span class="line">pip install jupyter</span><br><span class="line">pip install matplotlib </span><br></pre></td></tr></table></figure></div><p>　　因为 tensorflow 并没有默认自带 Object Detection API，所以该 API 需要自行下载，下载地址为：https://github.com/tensorflow/models ，下载之后解压，Shaun 解压目录为：<code>D:\ProgramFiles\PythonLibs\tensorflow</code>，解压完之后需要配置环境目录，在系统环境目录中添加：</p><table><colgroup><col style="width:20%"><col style="width:80%"></colgroup><thead><tr class="header"><th style="text-align:center">变量名</th><th style="text-align:center">变量值</th></tr></thead><tbody><tr class="odd"><td style="text-align:center">PYTHONPATH</td><td style="text-align:center">D:\ProgramFiles\PythonLibs\tensorflow\models; D:\ProgramFiles\PythonLibs\tensorflow\models\research; D:\ProgramFiles\PythonLibs\tensorflow\models\research\slim;</td></tr></tbody></table><p>　　下载配置 Object Detection API 完之后需要安装 Protoc，进入 <a target="_blank" rel="noopener" href="https://github.com/google/protobuf/releases">Protoc下载页</a>，下载 <a target="_blank" rel="noopener" href="https://github.com/google/protobuf/releases/download/v3.4.0/protoc-3.4.0-win32.zip"><strong>protoc-3.4.0-win32.zip</strong></a>，解压之后将 <strong>bin</strong> 文件夹内的 <strong>protoc.exe</strong> 拷贝到 <code>C:\windows\system32</code> 目录下（用于将 protoc.exe 所在的目录配置到环境变量当中）,当然也可以在系统环境变量 Path 中添加该 <strong>bin</strong> 文件夹路径。</p><p>　　最后在命令行中切换目录至：<code>D:\ProgramFiles\PythonLibs\tensorflow\models\research</code> 文件夹，即 object_detection 文件夹所在目录，在命令行中输入：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="BASH"><div class="code-copy"></div><figure class="highlight hljs bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">protoc object_detection/protos/*.proto --python_out=.</span><br></pre></td></tr></table></figure></div><p>编译 <code>object_detection/protos</code> 文件夹下的 proto 文件，生成对应的 python 文件。</p><p>　　至此，Windows 下 TensorFlow中 的 Object Detection API 的使用配置全部完成，至于 Ubuntu 下的配置可参考其<a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/installation.md">官方文档</a>。</p><p>　　至于如何验证，可以在命令行中切换目录至 <code>object_detection</code>，输入：<code>jupyter notebook</code>，稍等一会，浏览器将自动打开 <code>http://localhost:8888/tree</code> jupyter 界面，点击 <code>object_detection_tutorial.ipynb</code> 文件，进入打开的新标签，点击“<strong>Cell</strong>”中的“<strong>Run All</strong>”，耐心等待几 ~ 十几分钟（因为它需要下载相应的模型），将会在浏览器下方显示检测结果。</p><p>　　截止本文完成前，该API公开的有以下几个模型：</p><table><thead><tr class="header"><th>Model name</th><th>Speed (ms)</th><th>COCO mAP<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></th><th>Outputs</th></tr></thead><tbody><tr class="odd"><td><a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/ssd_mobilenet_v1_coco_2017_11_08.tar.gz">ssd_mobilenet_v1_coco</a></td><td>30</td><td>21</td><td>Boxes</td></tr><tr class="even"><td><a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/ssd_inception_v2_coco_2017_11_08.tar.gz">ssd_inception_v2_coco</a></td><td>42</td><td>24</td><td>Boxes</td></tr><tr class="odd"><td><a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/faster_rcnn_inception_v2_coco_2017_11_08.tar.gz">faster_rcnn_inception_v2_coco</a></td><td>58</td><td>28</td><td>Boxes</td></tr><tr class="even"><td><a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/faster_rcnn_resnet50_coco_2017_11_08.tar.gz">faster_rcnn_resnet50_coco</a></td><td>89</td><td>30</td><td>Boxes</td></tr><tr class="odd"><td><a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/faster_rcnn_resnet50_lowproposals_coco_2017_11_08.tar.gz">faster_rcnn_resnet50_lowproposals_coco</a></td><td>64</td><td></td><td>Boxes</td></tr><tr class="even"><td><a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/rfcn_resnet101_coco_2017_11_08.tar.gz">rfcn_resnet101_coco</a></td><td>92</td><td>30</td><td>Boxes</td></tr><tr class="odd"><td><a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/faster_rcnn_resnet101_coco_2017_11_08.tar.gz">faster_rcnn_resnet101_coco</a></td><td>106</td><td>32</td><td>Boxes</td></tr><tr class="even"><td><a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/faster_rcnn_resnet101_lowproposals_coco_2017_11_08.tar.gz">faster_rcnn_resnet101_lowproposals_coco</a></td><td>82</td><td></td><td>Boxes</td></tr><tr class="odd"><td><a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/faster_rcnn_inception_resnet_v2_atrous_coco_2017_11_08.tar.gz">faster_rcnn_inception_resnet_v2_atrous_coco</a></td><td>620</td><td>37</td><td>Boxes</td></tr><tr class="even"><td><a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/faster_rcnn_inception_resnet_v2_atrous_lowproposals_coco_2017_11_08.tar.gz">faster_rcnn_inception_resnet_v2_atrous_lowproposals_coco</a></td><td>241</td><td></td><td>Boxes</td></tr><tr class="odd"><td><a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/faster_rcnn_nas_lowproposals_coco_2017_11_08.tar.gz">faster_rcnn_nas</a></td><td>1833</td><td>43</td><td>Boxes</td></tr><tr class="even"><td><a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/faster_rcnn_nas_lowproposals_coco_2017_11_08.tar.gz">faster_rcnn_nas_lowproposals_coco</a></td><td>540</td><td></td><td>Boxes</td></tr></tbody></table><p>　　根据上述模型可推知，利用该 API 可能只能训练 Faster-RCNN、R-FCN 和 SSD 三种算法的模型。</p><p>接下来介绍如何使用该 API 来训练自己的模型进行物体检测。</p><h2 id="实践篇">实践篇</h2><h3 id="数据准备篇">数据准备篇</h3><p>　　既然要训练自己的模型，当然要准备相应的数据，而 TensorFlow 有其独特的输入数据格式 <a target="_blank" rel="noopener" href="https://www.tensorflow.org/api_guides/python/python_io#tfrecords_format_details">TFRecord</a>，所以通常还要将自己的数据转换成 TFRecord 格式以输入 TensorFlow 中进行训练。以 <a target="_blank" rel="noopener" href="https://github.com/datitran">datitran</a>/<a target="_blank" rel="noopener" href="https://github.com/datitran/raccoon_dataset"><strong>raccoon_dataset</strong></a> 数据集为例，该作者在 Google image 上收集了 200 张 Raccoon 图片，用 <a target="_blank" rel="noopener" href="https://github.com/tzutalin/labelImg">LabelImg</a> 对这些图片进行标记，并将标记以 PASCAL VOC 格式保存为 xml 文件。作者在文中也提到了另一个图片标记工具 <a target="_blank" rel="noopener" href="https://github.com/christopher5106/FastAnnotationTool">FIAT (Fast Image Data Annotation Tool)</a> 。保存为 PASCAL VOC 格式的 xml 文件之后，可以使用 object_detection 文件夹中的 <a target="_blank" rel="noopener" href="https://github.com/tensorflow/models/blob/master/research/object_detection/create_pascal_tf_record.py">create_pascal_tf_record.py</a> 文件将数据转化为 TFRecord 格式，用法为：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="PYTHON"><div class="code-copy"></div><figure class="highlight hljs python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./create_pascal_tf_record --data_dir=/home/user/VOCdevkit \</span><br><span class="line">        --year=VOC2012 \</span><br><span class="line">        --output_path=/home/user/pascal.record</span><br></pre></td></tr></table></figure></div><p>当然也可以使用 datitran 作者提供的 <a target="_blank" rel="noopener" href="https://github.com/datitran/raccoon_dataset/blob/master/xml_to_csv.py">xml_to_csv.py</a> 文件将 xml 文件先转化为 csv 文件，再利用 <a target="_blank" rel="noopener" href="https://github.com/datitran/raccoon_dataset/blob/master/generate_tfrecord.py">generate_tfrecord.py</a> 文件将 csv 文件转化成 TFRecord 格式文件。</p><p>　　注意，使用 xml_to_csv.py 和 generate_tfrecord.py 其文件结构应该是这样的：</p><blockquote><p>.<br>├── annotations<br>├── generate_tfrecord.py<br>├── images<br>└── xml_to_csv.py</p><p>2 directories, 2 files</p></blockquote><p>其中 images 文件夹存的是 jpg 图片，annotations 文件夹存的是 xml 标签文件。generate_tfrecord.py 文件中的：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="PYTHON"><div class="code-copy"></div><figure class="highlight hljs python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">class_text_to_int</span>(<span class="params">row_label</span>):</span></span><br><span class="line">    <span class="keyword">if</span> row_label == <span class="string">&#x27;raccoon&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line"><span class="literal">None</span></span><br></pre></td></tr></table></figure></div><p>其中的 <code>raccoon</code> 注意要改成自己的类别标签。如此，数据的问题就解决了。</p><h3 id="训练篇">训练篇</h3><p>　　然后就是正式开始训练了，以 Faster-RCNN 算法为例。首先准备相应的数据，Shaun 准备的数据文件结构如下：</p><blockquote><p>TensorFlowObjectDetectionAPITest<br>├── data<br>│ 　├── model.ckpt.data-00000-of-00001<br>│ 　├── model.ckpt.index<br>│ 　├── model.ckpt.meta<br>│ 　├── object_label_map.pbtxt<br>│ 　├── test.record<br>│ 　└── train.record<br>├── eval<br>├── eval.py<br>├── export_inference_graph.py<br>├── faster_rcnn_resnet101_coco.config<br>├── model<br>├── train<br>└── train.py</p><p>4 directories, 10 files</p></blockquote><p>其中，<strong>TensorFlowObjectDetectionAPITest</strong> 为项目文件夹，该 <em>project</em> 在此文件夹下运行；</p><p><strong>data</strong> 文件夹中三个 <strong>model.ckpt</strong> 文件：<strong>model.ckpt.data-00000-of-00001</strong>、<strong>model.ckpt.index</strong> 和 <strong>model.ckpt.meta</strong> 来自 <a target="_blank" rel="noopener" href="http://download.tensorflow.org/models/object_detection/faster_rcnn_resnet101_coco_2017_11_08.tar.gz"><em>faster_rcnn_resnet101_coco</em></a> 模型，用来初始化网络参数；</p><p><strong>object_label_map.pbtxt</strong> 文件内容如下：</p><blockquote><p>item { ​ id: 1 ​ name: 'raccoon' }</p></blockquote><p>将其中的 <code>raccoon</code> 改成自己的类别标签，如果有多个类别标签则可以参考 <code>object_detection\data</code> 文件夹中的 <em><code>pascal_label_map.pbtxt</code></em> 文件格式；</p><p><strong>test.record</strong> 和 <strong>train.record</strong> 是生成的 TFRecord 数据，分别为待输入的测试数据和训练数据；</p><p><strong>eval </strong>文件夹为空文件夹用来输出测试结果；<strong>train</strong> 文件夹为空文件夹用来输出训练结果（包括checkpoint文件和最终的模型文件）；</p><p><strong>faster_rcnn_resnet101_coco.config</strong> 为配置文件，包括各种参数和输入输出数据的配置，其来自 <code>object_detection\samples\configs</code> 文件夹中 <em><code>faster_rcnn_resnet101_coco.config</code></em> 文件，在使用时需对其做如下修改：</p><ol type="1"><li><p>首先是 <strong>num_classes</strong>，这是待检测的类别数目，如果只要检测一种，则将其值改为 1；</p></li><li><p><code>fine_tune_checkpoint: "PATH_TO_BE_CONFIGURED/model.ckpt"</code>，将 <code>PATH_TO_BE_CONFIGURED</code> 改为 <code>./data</code>；</p></li><li><p>``` train_input_reader: { tf_record_input_reader { input_path: "PATH_TO_BE_CONFIGURED/mscoco_train.record" } label_map_path: "PATH_TO_BE_CONFIGURED/mscoco_label_map.pbtxt" }</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="PLAINTEXT"><div class="code-copy"></div><figure class="highlight hljs plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   将其中的的 `PATH_TO_BE_CONFIGURED/mscoco_train.record` 改为 `./data/train.record`，将其中的 `PATH_TO_BE_CONFIGURED/mscoco_label_map.pbtxt` 改为 `./data/object_label_map.pbtxt`；</span><br><span class="line"></span><br><span class="line">4. ```</span><br><span class="line">   eval_input_reader: &#123;</span><br><span class="line">     tf_record_input_reader &#123;</span><br><span class="line">       input_path: &quot;PATH_TO_BE_CONFIGURED/mscoco_val.record&quot;</span><br><span class="line">     &#125;</span><br><span class="line">     label_map_path: &quot;PATH_TO_BE_CONFIGURED/mscoco_label_map.pbtxt&quot;</span><br><span class="line">     shuffle: false</span><br><span class="line">     num_readers: 1</span><br><span class="line">     num_epochs: 1</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure></div><p></p><p>将其中的的 <code>PATH_TO_BE_CONFIGURED/mscoco_val.record</code> 改为 <code>./data/test.record</code>，将其中的 <code>PATH_TO_BE_CONFIGURED/mscoco_label_map.pbtxt</code> 改为 <code>./data/object_label_map.pbtxt</code>；</p></li></ol><p>至于其它的参数可以选择默认，不对其进行修改；</p><p><strong>train.py</strong> 为训练代码，其来自 <code>object_detection/</code> 文件夹中的 <em><code>train.py</code></em>，直接复制出来使用即可，具体用法为：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="BASH"><div class="code-copy"></div><figure class="highlight hljs bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python train.py --logtostderr --train_dir=./train --pipeline_config_path=faster_rcnn_resnet101_coco.config</span><br></pre></td></tr></table></figure></div><p>其在运行过程中会在 <strong>train</strong> 文件夹生成一系列训练过程文件，比如 checkpoint、model.ckpt-{num}（{num} 代表训练过程保存的第几个网络模型，一般从 0 开始，包括 .index、.meta和 .data 三个文件）等文件。</p><p><strong>eval.py</strong> 为评估代码，其来自 <code>object_detection/</code> 文件夹中的 <em><code>eval.py</code></em>，直接复制出来使用即可，具体用法为：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="BASH"><div class="code-copy"></div><figure class="highlight hljs bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python eval.py --logtostderr --checkpoint_dir=./train --eval_dir=./<span class="built_in">eval</span> --pipeline_config_path=./faster_rcnn_resnet101_coco.config</span><br></pre></td></tr></table></figure></div><p>其在运行过程中会在 <strong>eval</strong> 文件夹生成一系列评估文件，每个文件对应一个测试 image。</p><p><strong>export_inference_graph.py</strong> 为导出 pb 模型代码，其来自 <code>object_detection/</code> 文件夹中的 <em><code>export_inference_graph.py</code></em>，直接复制出来使用即可，具体用法为：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="BASH"><div class="code-copy"></div><figure class="highlight hljs bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python export_inference_graph.py --input_type image_tensor --pipeline_config_path ./faster_rcnn_resnet101_coco.config --trained_checkpoint_prefix ./train/model.ckpt-18298 --output_directory ./model</span><br></pre></td></tr></table></figure></div><p>其中 <code>model.ckpt-18298</code> 表示使用第 18298 次保存的网络模型导出 pb 模型文件，导出的模型文件保存在 <strong>model</strong> 文件夹，主要有一下几个文件：</p><blockquote><p>- graph.pbtxt</p><p>- model.ckpt.data-00000-of-00001</p><p>- model.ckpt.info</p><p>- model.ckpt.meta</p><p>- frozen_inference_graph.pb</p></blockquote><p>其中 frozen_inference_graph.pb 就是训练成功用来检测目标的模型。</p><p>　　TensorFlow 训练时可以随时查看训练过程，如损失函数的值下降曲线等，所用命令为：在命令行中切换目录至 project 运行目录，即 train.py 所在文件夹，Shaun 这里即 <em>TensorFlowObjectDetectionAPITest</em> 文件夹，输入：<code>tensorboard --logdir=./</code>，等待片刻，在浏览器地址栏输入：<code>http://localhost:6006/</code>，即可看到训练过程曲线。</p><h3 id="检测篇">检测篇</h3><p>　　检测结果使用 opencv 窗口显示（至于 python 中 opencv 的使用详见下一篇（<a href="https://cniter.github.io/posts/5f54aa2c.html">PyQt5使用小结</a>）），具体调用自己训练的模型进行检测的 Python 代码（该代码为 eli 大佬参考 <code>object_detection</code> 文件夹中的 <em><code>object_detection_tutorial.ipynb</code></em>（该文件可在 jupyter 中查看）改的）为：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="PYTHON"><div class="code-copy"></div><figure class="highlight hljs python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> object_detection.utils <span class="keyword">import</span> label_map_util</span><br><span class="line"><span class="keyword">from</span> object_detection.utils <span class="keyword">import</span> visualization_utils <span class="keyword">as</span> vis_util</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Detector</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.PATH_TO_CKPT = <span class="string">r&#x27;./model/frozen_inference_graph.pb&#x27;</span>    <span class="comment"># 选择模型</span></span><br><span class="line">        self.PATH_TO_LABELS = <span class="string">r&#x27;./data/object_label_map.pbtxt&#x27;</span>      <span class="comment"># 选择类别标签文件</span></span><br><span class="line">        self.NUM_CLASSES = <span class="number">1</span></span><br><span class="line">        self.detection_graph = self._load_model()</span><br><span class="line">        self.category_index = self._load_label_map()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_load_model</span>(<span class="params">self</span>):</span></span><br><span class="line">        detection_graph = tf.Graph()</span><br><span class="line">        <span class="keyword">with</span> detection_graph.as_default():</span><br><span class="line">            od_graph_def = tf.GraphDef()</span><br><span class="line">            <span class="keyword">with</span> tf.gfile.GFile(self.PATH_TO_CKPT, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fid:</span><br><span class="line">                serialized_graph = fid.read()</span><br><span class="line">                od_graph_def.ParseFromString(serialized_graph)</span><br><span class="line">                tf.import_graph_def(od_graph_def, name=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> detection_graph</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_load_label_map</span>(<span class="params">self</span>):</span></span><br><span class="line">        label_map = label_map_util.load_labelmap(self.PATH_TO_LABELS)</span><br><span class="line">        categories = label_map_util.convert_label_map_to_categories(label_map,</span><br><span class="line">                                                                    max_num_classes=self.NUM_CLASSES,</span><br><span class="line">                                                                    use_display_name=<span class="literal">True</span>)</span><br><span class="line">        category_index = label_map_util.create_category_index(categories)</span><br><span class="line">        <span class="keyword">return</span> category_index</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">detect</span>(<span class="params">self, image</span>):</span></span><br><span class="line">        <span class="keyword">with</span> self.detection_graph.as_default():</span><br><span class="line">            <span class="keyword">with</span> tf.Session(graph=self.detection_graph) <span class="keyword">as</span> sess:</span><br><span class="line">                <span class="comment"># Expand dimensions since the model expects images to have shape: [1, None, None, 3]</span></span><br><span class="line">                image_np_expanded = np.expand_dims(image, axis=<span class="number">0</span>)</span><br><span class="line">                image_tensor = self.detection_graph.get_tensor_by_name(<span class="string">&#x27;image_tensor:0&#x27;</span>)</span><br><span class="line">                boxes = self.detection_graph.get_tensor_by_name(<span class="string">&#x27;detection_boxes:0&#x27;</span>)</span><br><span class="line">                scores = self.detection_graph.get_tensor_by_name(<span class="string">&#x27;detection_scores:0&#x27;</span>)</span><br><span class="line">                classes = self.detection_graph.get_tensor_by_name(<span class="string">&#x27;detection_classes:0&#x27;</span>)</span><br><span class="line">                num_detections = self.detection_graph.get_tensor_by_name(<span class="string">&#x27;num_detections:0&#x27;</span>)</span><br><span class="line">                <span class="comment"># Actual detection.</span></span><br><span class="line">                (boxes, scores, classes, num_detections) = sess.run(</span><br><span class="line">                    [boxes, scores, classes, num_detections],</span><br><span class="line">                    feed_dict=&#123;image_tensor: image_np_expanded&#125;)</span><br><span class="line">                <span class="comment"># Visualization of the results of a detection.</span></span><br><span class="line">                vis_util.visualize_boxes_and_labels_on_image_array(</span><br><span class="line">                    image,</span><br><span class="line">                    np.squeeze(boxes),</span><br><span class="line">                    np.squeeze(classes).astype(np.int32),</span><br><span class="line">                    np.squeeze(scores),</span><br><span class="line">                    self.category_index,</span><br><span class="line">                    use_normalized_coordinates=<span class="literal">True</span>,</span><br><span class="line">                    line_thickness=<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">        cv2.namedWindow(<span class="string">&quot;detection&quot;</span>, cv2.WINDOW_NORMAL)</span><br><span class="line">        cv2.imshow(<span class="string">&quot;detection&quot;</span>, image)</span><br><span class="line">        cv2.waitKey(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    image = cv2.imread(<span class="string">&#x27;./test_img.jpg&#x27;</span>) <span class="comment"># 选择待检测的图片</span></span><br><span class="line">    detector = Detector()</span><br><span class="line">    detector.detect(image)</span><br></pre></td></tr></table></figure></div><h2 id="后记">后记</h2><p>　　经过这次 TensorFlow 训练，感觉深度学习 真tm 吃硬件，费时间，也难怪神经网络理论出来几十年之后才火，当年的硬件根本无法支持这么大的计算量。</p><h2 id="附录">附录</h2><p>最后附上 datitran 作者提供的 xml_to_csv.py 文件源码和 generate_tfrecord.py 文件源码：</p><p><strong>xml_to_csv.py 源码</strong>如下：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="PYTHON"><div class="code-copy"></div><figure class="highlight hljs python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xml_to_csv</span>(<span class="params">path</span>):</span></span><br><span class="line">    xml_list = []</span><br><span class="line">    <span class="keyword">for</span> xml_file <span class="keyword">in</span> glob.glob(path + <span class="string">&#x27;/*.xml&#x27;</span>):</span><br><span class="line">        tree = ET.parse(xml_file)</span><br><span class="line">        root = tree.getroot()</span><br><span class="line">        <span class="keyword">for</span> member <span class="keyword">in</span> root.findall(<span class="string">&#x27;object&#x27;</span>):</span><br><span class="line">            value = (root.find(<span class="string">&#x27;filename&#x27;</span>).text,</span><br><span class="line">                     <span class="built_in">int</span>(root.find(<span class="string">&#x27;size&#x27;</span>)[<span class="number">0</span>].text),</span><br><span class="line">                     <span class="built_in">int</span>(root.find(<span class="string">&#x27;size&#x27;</span>)[<span class="number">1</span>].text),</span><br><span class="line">                     member[<span class="number">0</span>].text,</span><br><span class="line">                     <span class="built_in">int</span>(member[<span class="number">4</span>][<span class="number">0</span>].text),</span><br><span class="line">                     <span class="built_in">int</span>(member[<span class="number">4</span>][<span class="number">1</span>].text),</span><br><span class="line">                     <span class="built_in">int</span>(member[<span class="number">4</span>][<span class="number">2</span>].text),</span><br><span class="line">                     <span class="built_in">int</span>(member[<span class="number">4</span>][<span class="number">3</span>].text)</span><br><span class="line">                     )</span><br><span class="line">            xml_list.append(value)</span><br><span class="line">    column_name = [<span class="string">&#x27;filename&#x27;</span>, <span class="string">&#x27;width&#x27;</span>, <span class="string">&#x27;height&#x27;</span>, <span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;xmin&#x27;</span>, <span class="string">&#x27;ymin&#x27;</span>, <span class="string">&#x27;xmax&#x27;</span>, <span class="string">&#x27;ymax&#x27;</span>]</span><br><span class="line">    xml_df = pd.DataFrame(xml_list, columns=column_name)</span><br><span class="line">    <span class="keyword">return</span> xml_df</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    image_path = os.path.join(os.getcwd(), <span class="string">&#x27;annotations&#x27;</span>)</span><br><span class="line">    xml_df = xml_to_csv(image_path)</span><br><span class="line">    xml_df.to_csv(<span class="string">&#x27;raccoon_labels.csv&#x27;</span>, index=<span class="literal">None</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Successfully converted xml to csv.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main()</span><br></pre></td></tr></table></figure></div><p><strong>generate_tfrecord.py 文件源码</strong> 如下：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="PYTHON"><div class="code-copy"></div><figure class="highlight hljs python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Usage:</span></span><br><span class="line"><span class="string">  # From tensorflow/models/</span></span><br><span class="line"><span class="string">  # Create train data:</span></span><br><span class="line"><span class="string">  python generate_tfrecord.py --csv_input=data/train_labels.csv  --output_path=train.record</span></span><br><span class="line"><span class="string">  # Create test data:</span></span><br><span class="line"><span class="string">  python generate_tfrecord.py --csv_input=data/test_labels.csv  --output_path=test.record</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> division</span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> absolute_import</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> object_detection.utils <span class="keyword">import</span> dataset_util</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple, OrderedDict</span><br><span class="line"></span><br><span class="line">flags = tf.app.flags</span><br><span class="line">flags.DEFINE_string(<span class="string">&#x27;csv_input&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;Path to the CSV input&#x27;</span>)</span><br><span class="line">flags.DEFINE_string(<span class="string">&#x27;output_path&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;Path to output TFRecord&#x27;</span>)</span><br><span class="line">FLAGS = flags.FLAGS</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># TO-DO replace this with label map</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">class_text_to_int</span>(<span class="params">row_label</span>):</span></span><br><span class="line">    <span class="keyword">if</span> row_label == <span class="string">&#x27;raccoon&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">split</span>(<span class="params">df, group</span>):</span></span><br><span class="line">    data = namedtuple(<span class="string">&#x27;data&#x27;</span>, [<span class="string">&#x27;filename&#x27;</span>, <span class="string">&#x27;object&#x27;</span>])</span><br><span class="line">    gb = df.groupby(group)</span><br><span class="line">    <span class="keyword">return</span> [data(filename, gb.get_group(x)) <span class="keyword">for</span> filename, x <span class="keyword">in</span> <span class="built_in">zip</span>(gb.groups.keys(), gb.groups)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_tf_example</span>(<span class="params">group, path</span>):</span></span><br><span class="line">    <span class="keyword">with</span> tf.gfile.GFile(os.path.join(path, <span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(group.filename)), <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fid:</span><br><span class="line">        encoded_jpg = fid.read()</span><br><span class="line">    encoded_jpg_io = io.BytesIO(encoded_jpg)</span><br><span class="line">    image = Image.<span class="built_in">open</span>(encoded_jpg_io)</span><br><span class="line">    width, height = image.size</span><br><span class="line"></span><br><span class="line">    filename = group.filename.encode(<span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">    image_format = <span class="string">b&#x27;jpg&#x27;</span></span><br><span class="line">    xmins = []</span><br><span class="line">    xmaxs = []</span><br><span class="line">    ymins = []</span><br><span class="line">    ymaxs = []</span><br><span class="line">    classes_text = []</span><br><span class="line">    classes = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> index, row <span class="keyword">in</span> group.<span class="built_in">object</span>.iterrows():</span><br><span class="line">        xmins.append(row[<span class="string">&#x27;xmin&#x27;</span>] / width)</span><br><span class="line">        xmaxs.append(row[<span class="string">&#x27;xmax&#x27;</span>] / width)</span><br><span class="line">        ymins.append(row[<span class="string">&#x27;ymin&#x27;</span>] / height)</span><br><span class="line">        ymaxs.append(row[<span class="string">&#x27;ymax&#x27;</span>] / height)</span><br><span class="line">        classes_text.append(row[<span class="string">&#x27;class&#x27;</span>].encode(<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line">        classes.append(class_text_to_int(row[<span class="string">&#x27;class&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">    tf_example = tf.train.Example(features=tf.train.Features(feature=&#123;</span><br><span class="line">        <span class="string">&#x27;image/height&#x27;</span>: dataset_util.int64_feature(height),</span><br><span class="line">        <span class="string">&#x27;image/width&#x27;</span>: dataset_util.int64_feature(width),</span><br><span class="line">        <span class="string">&#x27;image/filename&#x27;</span>: dataset_util.bytes_feature(filename),</span><br><span class="line">        <span class="string">&#x27;image/source_id&#x27;</span>: dataset_util.bytes_feature(filename),</span><br><span class="line">        <span class="string">&#x27;image/encoded&#x27;</span>: dataset_util.bytes_feature(encoded_jpg),</span><br><span class="line">        <span class="string">&#x27;image/format&#x27;</span>: dataset_util.bytes_feature(image_format),</span><br><span class="line">        <span class="string">&#x27;image/object/bbox/xmin&#x27;</span>: dataset_util.float_list_feature(xmins),</span><br><span class="line">        <span class="string">&#x27;image/object/bbox/xmax&#x27;</span>: dataset_util.float_list_feature(xmaxs),</span><br><span class="line">        <span class="string">&#x27;image/object/bbox/ymin&#x27;</span>: dataset_util.float_list_feature(ymins),</span><br><span class="line">        <span class="string">&#x27;image/object/bbox/ymax&#x27;</span>: dataset_util.float_list_feature(ymaxs),</span><br><span class="line">        <span class="string">&#x27;image/object/class/text&#x27;</span>: dataset_util.bytes_list_feature(classes_text),</span><br><span class="line">        <span class="string">&#x27;image/object/class/label&#x27;</span>: dataset_util.int64_list_feature(classes),</span><br><span class="line">    &#125;))</span><br><span class="line">    <span class="keyword">return</span> tf_example</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>(<span class="params">_</span>):</span></span><br><span class="line">    writer = tf.python_io.TFRecordWriter(FLAGS.output_path)</span><br><span class="line">    path = os.path.join(os.getcwd(), <span class="string">&#x27;images&#x27;</span>)</span><br><span class="line">    examples = pd.read_csv(FLAGS.csv_input)</span><br><span class="line">    grouped = split(examples, <span class="string">&#x27;filename&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> group <span class="keyword">in</span> grouped:</span><br><span class="line">        tf_example = create_tf_example(group, path)</span><br><span class="line">        writer.write(tf_example.SerializeToString())</span><br><span class="line"></span><br><span class="line">    writer.close()</span><br><span class="line">    output_path = os.path.join(os.getcwd(), FLAGS.output_path)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Successfully created the TFRecords: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(output_path))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    tf.app.run()</span><br></pre></td></tr></table></figure></div><h2 id="参考资料">参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="http://blog.csdn.net/xiaoxiao123jun/article/details/76605928">对于谷歌开源的TensorFlow Object Detection API视频物体识别系统实现教程</a></p><p>[2] <a target="_blank" rel="noopener" href="http://blog.csdn.net/c20081052/article/details/77608954">TensorFlow学习——Tensorflow Object Detection API（win10，CPU）</a></p><p>[3] <a target="_blank" rel="noopener" href="https://towardsdatascience.com/how-to-train-your-own-object-detector-with-tensorflows-object-detector-api-bec72ecfe1d9">How to train your own Object Detector with TensorFlow’s Object Detector API</a></p><p>[4] <a target="_blank" rel="noopener" href="http://rensanning.iteye.com/blog/2381885">TensorFlow 之 物体检测</a>（<a target="_blank" rel="noopener" href="http://rensanning.iteye.com/category/374992" class="uri">http://rensanning.iteye.com/category/374992</a>）</p><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr><ol><li id="fn1" role="doc-endnote"><p>See <a target="_blank" rel="noopener" href="http://cocodataset.org/#detections-eval">MSCOCO evaluation protocol</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li></ol></section></div><div class="article-content-more"><button type="button" class="article-more--link"><i class="fa fa-angle-double-down fa-3x" aria-hidden="true"></i></button></div></section></article><article id="post-C语言中整型提升问题" class="article div-border"><header class="article-header"><span class="article-date article-title--index"><i class="fa fa-calendar" aria-hidden="true"></i> <a href="/posts/2a3d46b0.html"><time datetime="2017-10-27T11:56:12.000Z">2017-10-27</time></a></span><section class="article-title article-title--index"><a href="/posts/2a3d46b0.html">C语言中整型提升问题</a></section><div class="article-label"><div class="article-category label"><i class="fa fa-book" aria-hidden="true"></i> <a class="color4 article-category-link" href="/categories/Problems/">Problems</a></div><div class="article-tag label"><i class="fa fa-bookmark" aria-hidden="true"></i> <a class="color4 article-tag-none-link" href="/tags/c-cpp/" rel="tag">c/cpp</a></div></div></header><section class="article-content"><div class="article-content--excerpt"><h2 id="前言">前言</h2><p>　　今天有人问了 Shaun 一个移位的问题，就是下面这段 C 语言代码：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> a = <span class="number">0xffff</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%#hx\n&quot;</span>, a &lt;&lt; <span class="number">4</span> &gt;&gt; <span class="number">8</span> &lt;&lt; <span class="number">4</span>);</span><br></pre></td></tr></table></figure><p>你认为会输出什么结果？ ੧ಡ ⌣ ಡ੭</p></div><div class="article-content--all"><h2 id="前言">前言</h2><p>　　今天有人问了 Shaun 一个移位的问题，就是下面这段 C 语言代码：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="C"><div class="code-copy"></div><figure class="highlight hljs c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">short</span> a = <span class="number">0xffff</span>;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%#hx\n&quot;</span>, a &lt;&lt; <span class="number">4</span> &gt;&gt; <span class="number">8</span> &lt;&lt; <span class="number">4</span>);</span><br></pre></td></tr></table></figure></div><p>你认为会输出什么结果？ ੧ಡ ⌣ ಡ੭</p><span id="more"></span><h2 id="解答篇">解答篇</h2><p>　　正确答案是：<code>0xfff0</code>。恐怕有一部分会像 Shaun 一样觉得答案就是 <code>0xff0</code> 才对，还像模像样的给出对应的说法：看 <code>a</code> 首先向左移四位，即去掉最左边的 <code>f</code>，右边补 4 个 0 变成这样 <code>0xfff0</code>；然后再向右移 8 位，a 将会变成这样 <code>0x00ff</code>；最后向左移四位，得到 <code>0x0ff0</code>，所以应该输出 <code>0xff0</code>。<strong>但是，正确答案终究是正确答案。</strong>之所以会输出正确答案，是因为这里面还有一个<strong>整型提升</strong>。所谓的整型提升就是：</p><blockquote><p>在一个表达式中，如果int能够表示原始类型中的所有数值，那么这个数值就被转成int型，否则，它被转成unsigned int型。这种规则被称为整型提升。所有其它类型都不会被整型提升改变。</p></blockquote><p>　　所以在 <code>a &lt;&lt; 4 &gt;&gt; 8 &lt;&lt; 4</code> 中，会先将 a 提升为 int 型，即 a 会变成 <code>0x0000ffff</code>，接着向左移四位，a 变成 <code>0x000ffff0</code>，再向右移 8 位，变成 <code>0x00000fff</code>，最后向左移 4 位，变成 <code>0x0000fff0</code>，最后为了输出，再做一个隐式的类型转换（由 int 转 unsigned short），得到 <code>0xfff0</code>，所以最后输出 <code>0xfff0</code>。</p><h2 id="后记">后记</h2><p>　　这个问题是一个刚入大学的童靴问 Shaun 的，刚问 Shaun 时 Shaun 还没反应过来，后来才想起有整型提升这么回事 o(╯□╰)o。btw，这位童靴主要是想去掉高 4 位和低 4 位只取中间 8 位的值，其实最简单的办法就是直接 <code>a &amp; 0x0ff0</code>，这样管它有没有整型提升，肯定能得到中间 8 位的值 (╯▽╰)。</p><h2 id="参考资料">参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="http://blog.csdn.net/mishifangxiangdefeng/article/details/47981889">C语言进阶：整型提升</a>（<a target="_blank" rel="noopener" href="http://blog.csdn.net/mishifangxiangdefeng/article/category/1058873" class="uri">http://blog.csdn.net/mishifangxiangdefeng/article/category/1058873</a>）</p><p>[2] <a target="_blank" rel="noopener" href="http://bbs.csdn.net/topics/390856773">对 unsigned char 先左移 后右移 可以出现两种结果</a></p></div><div class="article-content-more"><button type="button" class="article-more--link"><i class="fa fa-angle-double-down fa-3x" aria-hidden="true"></i></button></div></section></article><article id="post-TXT数据转OpenCV中的Mat数据" class="article div-border"><header class="article-header"><span class="article-date article-title--index"><i class="fa fa-calendar" aria-hidden="true"></i> <a href="/posts/dece8eba.html"><time datetime="2017-10-19T09:01:01.000Z">2017-10-19</time></a></span><section class="article-title article-title--index"><a href="/posts/dece8eba.html">TXT数据转OpenCV中的Mat数据</a></section><div class="article-label"><div class="article-category label"><i class="fa fa-book" aria-hidden="true"></i> <a class="color1 article-category-link" href="/categories/Study/">Study</a></div><div class="article-tag label"><i class="fa fa-bookmark" aria-hidden="true"></i> <a class="color2 article-tag-none-link" href="/tags/c-cpp/" rel="tag">c/cpp</a><a class="color2 article-tag-none-link" href="/tags/opencv/" rel="tag">opencv</a></div></div></header><section class="article-content"><div class="article-content--excerpt"><h2 id="前言">前言</h2><p>　　本文是以前做的一个小东西的处理前奏，当时也记录过，现在把它翻出来重新看看。那个东西需要利用深度图，Shaun 当时还没拿到 Kinect，就在网上下了一些<a target="_blank" rel="noopener" href="https://drive.google.com/uc?export=download&amp;confirm=QRhv&amp;id=0B_9saHAqGFITODNmNzU0ZjctMjk0Yi00YjI5LWJmZDMtYTdiYTE2YzM5OTQ4">数据</a>（<a target="_blank" rel="noopener" href="http://eeeweba.ntu.edu.sg/computervision/people/home/renzhou/HandGesture.htm" class="uri">http://eeeweba.ntu.edu.sg/computervision/people/home/renzhou/HandGesture.htm</a>），该数据集包含了彩色图及对应的深度图，但是该数据集没有以图像形式存储深度值，而是用 txt 文本以行列形式存储真正的深度值（单位为 mm），所以并不能直观的看到深度图像，Shaun 需要把这些深度值从 txt 文本提取出来并把它以图像的形式呈现出来，由于需求比较特殊，网上没看到现成的解决的方案，所以 Shaun 只有用现成的轮子自己做一个了。</p></div><div class="article-content--all"><h2 id="前言">前言</h2><p>　　本文是以前做的一个小东西的处理前奏，当时也记录过，现在把它翻出来重新看看。那个东西需要利用深度图，Shaun 当时还没拿到 Kinect，就在网上下了一些<a target="_blank" rel="noopener" href="https://drive.google.com/uc?export=download&amp;confirm=QRhv&amp;id=0B_9saHAqGFITODNmNzU0ZjctMjk0Yi00YjI5LWJmZDMtYTdiYTE2YzM5OTQ4">数据</a>（<a target="_blank" rel="noopener" href="http://eeeweba.ntu.edu.sg/computervision/people/home/renzhou/HandGesture.htm" class="uri">http://eeeweba.ntu.edu.sg/computervision/people/home/renzhou/HandGesture.htm</a>），该数据集包含了彩色图及对应的深度图，但是该数据集没有以图像形式存储深度值，而是用 txt 文本以行列形式存储真正的深度值（单位为 mm），所以并不能直观的看到深度图像，Shaun 需要把这些深度值从 txt 文本提取出来并把它以图像的形式呈现出来，由于需求比较特殊，网上没看到现成的解决的方案，所以 Shaun 只有用现成的轮子自己做一个了。</p><span id="more"></span><h2 id="思路篇">思路篇</h2><p>　　程序的基本思路是：先找到目录及子目录下的所有 txt 文件路径；再根据路径分别读取 txt 文件，按行读取之后再进行字符串分割提取其中的深度值；为了便于以图像形式显示，将深度值归一化至 0~255 存入 8 位单通道的 Mat 类型数据中，最后以 png 图像形式保存至各个目录。</p><h2 id="实现篇">实现篇</h2><p>　　因为当时还在用 opencv-2.4.11，所以本文所实现的代码是基于 opencv-2.4.11，不过应该只要在 opencv-2.0 版本及以上只要有 Mat 数据结构的都能用，毕竟 Shaun 只用到了 OpenCV 中的 Mat 数据结构。Talk is cheap, show you the code（代码很乱，估计也只用这么一次，所以就没怎么注意了 :-P）。具体 C++ 实现代码为：</p><div class="highlight-wrap" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="false" data-lang="C++"><div class="code-copy"></div><figure class="highlight hljs c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/core/core.hpp&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/imgproc/imgproc.hpp&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/highgui/highgui.hpp&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;io.h&gt;</span>  </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;direct.h&gt;</span>  </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> cv;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ******************************************************************</span></span><br><span class="line"><span class="comment">// @refer to  [C++文件读写操作（二）逐字符读取文本和逐行读取文本](http://blog.csdn.net/wangshihui512/article/details/8921924)</span></span><br><span class="line"><span class="comment">//            [字符串分割(C++)](http://www.cnblogs.com/MikeZhang/archive/2012/03/24/MySplitFunCPP.html)</span></span><br><span class="line"><span class="comment">//            [C++读取文件夹中所有的文件或者是特定后缀的文件](http://blog.csdn.net/adong76/article/details/39432467)</span></span><br><span class="line"><span class="comment">//            [C/C++ 判断文件夹是否存在以及创建、删除文件夹 windows以及linux通用](http://blog.csdn.net/u012005313/article/details/50688257)</span></span><br><span class="line"><span class="comment">//            [Split a string in C++?](http://stackoverflow.com/questions/236129/split-a-string-in-c)</span></span><br><span class="line"><span class="comment">//            [Kinect开发学习笔记之（六）带游戏者ID的深度数据的提取](http://blog.csdn.net/zouxy09/article/details/8151044)</span></span><br><span class="line"><span class="comment">//            [Depth Map Tutorial](http://www.pages.drexel.edu/~nk752/depthMapTut.html)</span></span><br><span class="line"><span class="comment">// ******************************************************************</span></span><br><span class="line"><span class="comment">// ----- 逐个字符读取文件 --------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testByChar</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    fstream testByCharFile;  </span><br><span class="line">    <span class="keyword">char</span> c;  </span><br><span class="line">    testByCharFile.<span class="built_in">open</span>(<span class="string">&quot;./test.txt&quot;</span>,ios::in);  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!testByCharFile.<span class="built_in">eof</span>())  </span><br><span class="line">    &#123;  </span><br><span class="line">        testByCharFile&gt;&gt;c;  </span><br><span class="line">        cout&lt;&lt;c;  </span><br><span class="line">    &#125;  </span><br><span class="line">    testByCharFile.<span class="built_in">close</span>();  </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// -------- 逐行读取文件 -------------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">testByLine</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">char</span> buffer[<span class="number">256</span>];  </span><br><span class="line">    fstream outFile;  </span><br><span class="line">    outFile.<span class="built_in">open</span>(<span class="string">&quot;./test.txt&quot;</span>,ios::in);  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!outFile.<span class="built_in">eof</span>())  </span><br><span class="line">    &#123;  </span><br><span class="line">        outFile.<span class="built_in">getline</span>(buffer, <span class="number">256</span>, <span class="string">&#x27;\n&#x27;</span>);<span class="comment">//getline(char *,int,char) 表示该行字符达到256个或遇到换行就结束  </span></span><br><span class="line">        cout&lt;&lt;buffer&lt;&lt;endl; </span><br><span class="line">    &#125;  </span><br><span class="line">    outFile.<span class="built_in">close</span>();  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">//  ------- 分割字符串 --------------</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">splitString</span><span class="params">()</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="keyword">char</span> buffer[<span class="number">1280</span>];  </span><br><span class="line">    fstream outFile;  </span><br><span class="line">    outFile.<span class="built_in">open</span>(<span class="string">&quot;./test.txt&quot;</span>,ios::in);  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(!outFile.<span class="built_in">eof</span>())  </span><br><span class="line">    &#123;  </span><br><span class="line">        outFile.<span class="built_in">getline</span>(buffer, <span class="number">1280</span>, <span class="string">&#x27;\n&#x27;</span>);<span class="comment">//getline(char *,int,char) 表示该行字符达到1280个或遇到换行就结束  </span></span><br><span class="line">        cout&lt;&lt;buffer&lt;&lt;endl; </span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> <span class="keyword">char</span> *d = <span class="string">&quot; ,*&quot;</span>;</span><br><span class="line">        <span class="keyword">char</span> *p;</span><br><span class="line">        p = <span class="built_in">strtok</span>(buffer, d);</span><br><span class="line">        <span class="keyword">while</span>(p)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, p);</span><br><span class="line">            p=<span class="built_in">strtok</span>(<span class="literal">NULL</span>, d);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line">    outFile.<span class="built_in">close</span>();  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取文件夹下指定格式所有文件名</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getAllFormatFiles</span><span class="params">( string path, string format, vector&lt;string&gt;&amp; files )</span>  </span></span><br><span class="line"><span class="function"></span>&#123;  </span><br><span class="line">    <span class="comment">//文件句柄    </span></span><br><span class="line">    <span class="keyword">long</span>   hFile   =   <span class="number">0</span>;    </span><br><span class="line">    <span class="comment">//文件信息    </span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> _<span class="title">finddata_t</span> <span class="title">fileinfo</span>;</span>    </span><br><span class="line">    string pathName;    </span><br><span class="line">    <span class="keyword">if</span>((hFile = _findfirst(pathName.<span class="built_in">assign</span>(path).<span class="built_in">append</span>(<span class="string">&quot;/*.&quot;</span> + format).<span class="built_in">c_str</span>(),&amp;fileinfo)) !=  <span class="number">-1</span>)    </span><br><span class="line">    &#123;    </span><br><span class="line">        <span class="keyword">do</span>    </span><br><span class="line">        &#123;   </span><br><span class="line">            <span class="comment">//如果是目录,迭代之  </span></span><br><span class="line">            <span class="comment">//如果不是,加入列表  </span></span><br><span class="line">            <span class="keyword">if</span>((fileinfo.attrib &amp;  _A_SUBDIR))    </span><br><span class="line">            &#123;    </span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">strcmp</span>(fileinfo.name,<span class="string">&quot;.&quot;</span>) != <span class="number">0</span>  &amp;&amp;  <span class="built_in">strcmp</span>(fileinfo.name,<span class="string">&quot;..&quot;</span>) != <span class="number">0</span>)    </span><br><span class="line">                &#123;  </span><br><span class="line">                    <span class="comment">//files.push_back(p.assign(path).append(&quot;/&quot;).append(fileinfo.name) );  </span></span><br><span class="line">                    <span class="built_in">getAllFormatFiles</span>( pathName.<span class="built_in">assign</span>(path).<span class="built_in">append</span>(<span class="string">&quot;/&quot;</span>).<span class="built_in">append</span>(fileinfo.name), format, files);   </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;    </span><br><span class="line">            <span class="keyword">else</span>    </span><br><span class="line">            &#123;    </span><br><span class="line">                files.<span class="built_in">push_back</span>(pathName.<span class="built_in">assign</span>(path).<span class="built_in">append</span>(<span class="string">&quot;/&quot;</span>).<span class="built_in">append</span>(fileinfo.name) );    </span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;<span class="keyword">while</span>(_findnext(hFile, &amp;fileinfo) == <span class="number">0</span>);    </span><br><span class="line"></span><br><span class="line">        _findclose(hFile);   </span><br><span class="line">    &#125;   </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment">// http://stackoverflow.com/questions/236129/split-a-string-in-c</span></span><br><span class="line"><span class="comment">// ---- stackoverflow上大神的C++版本分割字符串 --------------------</span></span><br><span class="line"><span class="function">std::vector&lt;std::string&gt; <span class="title">split</span><span class="params">(<span class="keyword">const</span> std::string&amp; text, <span class="keyword">const</span> std::string&amp; delims)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::vector&lt;std::string&gt; tokens;</span><br><span class="line">    std::<span class="keyword">size_t</span> start = text.<span class="built_in">find_first_not_of</span>(delims), end = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>((end = text.<span class="built_in">find_first_of</span>(delims, start)) != std::string::npos)</span><br><span class="line">    &#123;</span><br><span class="line">        tokens.<span class="built_in">push_back</span>(text.<span class="built_in">substr</span>(start, end - start));</span><br><span class="line">        start = text.<span class="built_in">find_first_not_of</span>(delims, end);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(start != std::string::npos)</span><br><span class="line">        tokens.<span class="built_in">push_back</span>(text.<span class="built_in">substr</span>(start));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> tokens;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建文件夹及子文件夹</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">makeDir</span><span class="params">(<span class="keyword">const</span> string &amp;path)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::vector&lt;std::string&gt; tokens;</span><br><span class="line">    std::<span class="keyword">size_t</span> start = <span class="number">0</span>, end = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ((end = path.<span class="built_in">find</span>(<span class="string">&#x27;/&#x27;</span>, start)) != std::string::npos) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (end != start) </span><br><span class="line">        &#123;</span><br><span class="line">            tokens.<span class="built_in">push_back</span>(path.<span class="built_in">substr</span>(<span class="number">0</span>, end));</span><br><span class="line">        &#125;</span><br><span class="line">        start = end + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (end != start) </span><br><span class="line">    &#123;</span><br><span class="line">        tokens.<span class="built_in">push_back</span>(path);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    vector&lt;string&gt;::const_iterator itp = tokens.<span class="built_in">begin</span>();</span><br><span class="line">    <span class="keyword">while</span> (itp != tokens.<span class="built_in">end</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">access</span>(itp-&gt;<span class="built_in">c_str</span>(), <span class="number">0</span>) == <span class="number">-1</span>)  <span class="comment">// 判断文件夹是否存在  </span></span><br><span class="line">        &#123;  </span><br><span class="line">            cout&lt;&lt;*itp&lt;&lt;<span class="string">&quot; is not existing&quot;</span>&lt;&lt;endl;  </span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;now make it&quot;</span>&lt;&lt;endl;  </span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">mkdir</span>(itp-&gt;<span class="built_in">c_str</span>()) == <span class="number">0</span>)   <span class="comment">// 不存在则创建，只能一级一级的创建</span></span><br><span class="line">            &#123;</span><br><span class="line">                cout&lt;&lt;<span class="string">&quot;make successfully&quot;</span>&lt;&lt;endl; </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; *itp++ &lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Txt文件转opencv Mat（txt文件中存的是以行列形式的深度值）</span></span><br><span class="line"><span class="function">cv::Mat <span class="title">Txt2DepthMat</span><span class="params">(<span class="keyword">const</span> string &amp;txtname)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">cv::Mat <span class="title">result</span><span class="params">(<span class="number">480</span>, <span class="number">640</span>, CV_8UC1, cv::Scalar(<span class="number">0</span>))</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">char</span> buffer[<span class="number">12800</span>];     <span class="comment">// 按行读取文件</span></span><br><span class="line">    fstream outFile;  </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *d = <span class="string">&quot;,&quot;</span>;    <span class="comment">// 以,为分割点</span></span><br><span class="line">    <span class="keyword">char</span> *p;    <span class="comment">// 分割出的子串</span></span><br><span class="line">    outFile.<span class="built_in">open</span>(txtname, ios::in);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; outFile.<span class="built_in">getline</span>(buffer, <span class="number">12800</span>, <span class="string">&#x27;\n&#x27;</span>) != <span class="literal">NULL</span> &amp;&amp; i &lt; result.rows; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        p = <span class="built_in">strtok</span>(buffer, d);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; p &amp;&amp; j &lt; result.cols; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> realDepth = (<span class="built_in">atoi</span>(p) &amp; <span class="number">0xfff8</span>) &gt;&gt; <span class="number">3</span>; <span class="comment">//提取距离信息，高13位</span></span><br><span class="line">            <span class="keyword">int</span> depth = (<span class="keyword">int</span>)(<span class="number">256</span> * realDepth / <span class="number">0x0fff</span>); <span class="comment">//因为提取的信息是距离信息，为了便于显示，这里归一化为0-255  </span></span><br><span class="line">            result.at&lt;uchar&gt;(i, j) = cv::saturate_cast&lt;uchar&gt;(depth);</span><br><span class="line">            p = <span class="built_in">strtok</span>(<span class="literal">NULL</span>, d);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    outFile.<span class="built_in">close</span>();  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以颜色表示深度信息，越暖（红色）越近，越冷（蓝色）越远</span></span><br><span class="line"><span class="function">cv::Mat <span class="title">Depth2Color</span><span class="params">(<span class="keyword">const</span> cv::Mat &amp;depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">cv::Mat <span class="title">result</span><span class="params">(depth.size(), CV_8UC3, cv::Scalar::all(<span class="number">0</span>))</span></span>;</span><br><span class="line">    <span class="keyword">int</span> tempDepth, depthRed, depthGreen, depthBlue;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; result.rows; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; result.cols; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            tempDepth = <span class="number">255</span> - depth.at&lt;uchar&gt;(i, j);</span><br><span class="line">            <span class="keyword">if</span>(tempDepth &lt; <span class="number">43</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                depthRed = tempDepth * <span class="number">6</span>;</span><br><span class="line">                depthGreen = <span class="number">0</span>;</span><br><span class="line">                depthBlue = tempDepth * <span class="number">6</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(tempDepth &gt; <span class="number">42</span> &amp;&amp; tempDepth &lt; <span class="number">85</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                depthRed = <span class="number">255</span> - (tempDepth - <span class="number">43</span>) * <span class="number">6</span>;</span><br><span class="line">                depthGreen = <span class="number">0</span>;</span><br><span class="line">                depthBlue = <span class="number">255</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(tempDepth &gt; <span class="number">84</span> &amp;&amp; tempDepth &lt; <span class="number">128</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                depthRed = <span class="number">0</span>;</span><br><span class="line">                depthGreen = (tempDepth - <span class="number">85</span>) * <span class="number">6</span>;</span><br><span class="line">                depthBlue = <span class="number">255</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(tempDepth &gt; <span class="number">127</span> &amp;&amp; tempDepth &lt; <span class="number">169</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                depthRed = <span class="number">0</span>;</span><br><span class="line">                depthGreen = <span class="number">255</span>;</span><br><span class="line">                depthBlue = <span class="number">255</span> - (tempDepth - <span class="number">128</span>) * <span class="number">6</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(tempDepth &gt; <span class="number">168</span> &amp;&amp; tempDepth &lt; <span class="number">212</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                depthRed = (tempDepth - <span class="number">169</span>) * <span class="number">6</span>;</span><br><span class="line">                depthGreen = <span class="number">255</span>;</span><br><span class="line">                depthBlue = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(tempDepth &gt; <span class="number">211</span> &amp;&amp; tempDepth &lt; <span class="number">254</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                depthRed = <span class="number">255</span>;</span><br><span class="line">                depthGreen = <span class="number">255</span> - (tempDepth - <span class="number">212</span>) * <span class="number">6</span>;</span><br><span class="line">                depthBlue = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(tempDepth &gt; <span class="number">253</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                depthRed = <span class="number">255</span>;</span><br><span class="line">                depthGreen = <span class="number">0</span>;</span><br><span class="line">                depthBlue = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (tempDepth == <span class="number">255</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                depthRed = <span class="number">0</span>;</span><br><span class="line">                depthGreen = <span class="number">0</span>;</span><br><span class="line">                depthBlue = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            result.at&lt;Vec3b&gt;(i, j)[<span class="number">0</span>] = depthBlue;</span><br><span class="line">            result.at&lt;Vec3b&gt;(i, j)[<span class="number">1</span>] = depthGreen;</span><br><span class="line">            result.at&lt;Vec3b&gt;(i, j)[<span class="number">2</span>] = depthRed;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    string filePath = <span class="string">&quot;C:/Users/XXXXXX/Downloads/NTU-Microsoft-Kinect-HandGesture Dataset/Depth&quot;</span>;</span><br><span class="line">    vector&lt;string&gt; files;  </span><br><span class="line">    <span class="comment">//读取所有文件  </span></span><br><span class="line">    string format = <span class="string">&quot;*&quot;</span>;  <span class="comment">// 不知道为什么在我电脑读不了特定文件？</span></span><br><span class="line">    <span class="built_in">getAllFormatFiles</span>(filePath, format, files);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; files.<span class="built_in">size</span>(); i++)    </span><br><span class="line">    &#123;</span><br><span class="line">        cv::Mat tempMat = <span class="built_in">Txt2DepthMat</span>(files[i]);</span><br><span class="line">        files[i].<span class="built_in">replace</span>(<span class="number">0</span>, <span class="number">66</span>, <span class="string">&quot;../data&quot;</span>);</span><br><span class="line">        files[i].<span class="built_in">replace</span>(files[i].<span class="built_in">find</span>(<span class="string">&quot;.txt&quot;</span>), files[i].<span class="built_in">length</span>() - <span class="number">1</span>, <span class="string">&quot;.png&quot;</span>);</span><br><span class="line">        cout&lt;&lt; files[i] &lt;&lt; endl; </span><br><span class="line">        string tempString = files[i].<span class="built_in">substr</span>(<span class="number">0</span>, files[i].<span class="built_in">find_last_of</span>(<span class="string">&quot;/&quot;</span>));</span><br><span class="line">        <span class="built_in">makeDir</span>(tempString);</span><br><span class="line">        cv::<span class="built_in">imwrite</span>(files[i], tempMat);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;File Size: &quot;</span> &lt;&lt; files.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//cv::imshow(&quot;test&quot;, Depth2Color(Txt2DepthMat(&quot;./1.txt&quot;)));</span></span><br><span class="line">    cv::<span class="built_in">waitKey</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><strong><em>2018-01-01 BTW：</em></strong>以上代码在 VS2010+Win7 下编译运行通过，在 VS2013+Win10 下 <code>for (int i = 0; outFile.getline(buffer, 12800, '\n') != NULL &amp;&amp; i &lt; result.rows; i++)</code> 会报错，可能需要改成 <code>for (int i = 0; outFile.getline(buffer, 12800, '\n') &amp;&amp; i &lt; result.rows; i++)</code> ，即去掉后面的 <code>!= NULL</code>。</p><h2 id="后记">后记</h2><p>　　正如前言所说，本文是以前记录过的，一些细节也快忘记，这次重写算是回顾一下吧，这段程序可能也确实只用这么一次，但其中用到了不少 C++ 处理字符串和读写文件等相关知识，而这些知识，在以后有极大的可能会再次用到，因此记录 ↖(^ω^)↗。</p><h2 id="参考资料">参考资料</h2><p>[1] <a target="_blank" rel="noopener" href="http://blog.csdn.net/wangshihui512/article/details/8921924">C++文件读写操作（二）逐字符读取文本和逐行读取文本</a>（<a target="_blank" rel="noopener" href="http://blog.csdn.net/shihui512/article/category/1397194" class="uri">http://blog.csdn.net/shihui512/article/category/1397194</a>）</p><p>[2] <a target="_blank" rel="noopener" href="http://www.cnblogs.com/MikeZhang/archive/2012/03/24/MySplitFunCPP.html">字符串分割(C++)</a>（<a target="_blank" rel="noopener" href="http://www.cnblogs.com/MikeZhang/category/345894.html" class="uri">http://www.cnblogs.com/MikeZhang/category/345894.html</a>）</p><p>[3] <a target="_blank" rel="noopener" href="http://blog.csdn.net/adong76/article/details/39432467">C++读取文件夹中所有的文件或者是特定后缀的文件</a>（<a target="_blank" rel="noopener" href="http://blog.csdn.net/adong76/article/category/1632029" class="uri">http://blog.csdn.net/adong76/article/category/1632029</a>）</p><p>[4] <a target="_blank" rel="noopener" href="http://blog.csdn.net/u012005313/article/details/50688257">C/C++ 判断文件夹是否存在以及创建、删除文件夹 windows以及linux通用</a>（<a target="_blank" rel="noopener" href="http://blog.csdn.net/u012005313/article/category/5586103" class="uri">http://blog.csdn.net/u012005313/article/category/5586103</a>）</p><p>[5] <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/236129/the-most-elegant-way-to-iterate-the-words-of-a-string/7408245#7408245">Split a string in C++?</a>（<a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/236129/split-a-string-in-c" class="uri">http://stackoverflow.com/questions/236129/split-a-string-in-c</a>）</p><p>[6] <a target="_blank" rel="noopener" href="http://blog.csdn.net/zouxy09/article/details/8151044">Kinect开发学习笔记之（六）带游戏者ID的深度数据的提取</a>（<a target="_blank" rel="noopener" href="http://blog.csdn.net/zouxy09/article/category/1273380" class="uri">http://blog.csdn.net/zouxy09/article/category/1273380</a>）</p><p>[7] <a target="_blank" rel="noopener" href="http://www.pages.drexel.edu/~nk752/depthMapTut.html">Depth Map Tutorial</a>（<a target="_blank" rel="noopener" href="http://www.pages.drexel.edu/~nk752/depthMapTut.html" class="uri">http://www.pages.drexel.edu/~nk752/depthMapTut.html</a>）</p></div><div class="article-content-more"><button type="button" class="article-more--link"><i class="fa fa-angle-double-down fa-3x" aria-hidden="true"></i></button></div></section></article><nav id="pagination--nav" class="text-center"><a class="extend prev" rel="prev" href="/page/5/">&lt;&lt; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/7/">Next &gt;&gt;</a></nav></main><div id="site-tool"><div class="scroll"><a href="#header"><i class="fa fa-arrow-up"></i></a> <a href="#footer"><i class="fa fa-arrow-down"></i></a></div><div></div></div><aside id="right-col" class="col-lg-3 col-sm-12"><div id="sidebar-sticky--bottom"></div><div id="sidebar"><header class="author-info div-border"><a href="/"><img class="header-avatar" src="/img/avatar.jpg"></a><h1 class="header-author"><a href="/" title="Hi Mate" data-toggle="tooltip">Shaun</a></h1><p class="header-slogan">求知！ 视界！ 未来！ ↖(^ω^)↗</p><div class="social-info"><a class="social-icon" target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=qNvAyd3G0d3JxujOx9DFycHEhsvHxQ" title="envelope" data-toggle="tooltip"><i class="fa fa-envelope" aria-hidden="true"></i> </a><a class="social-icon" target="_blank" href="https://github.com/cniter" title="github" data-toggle="tooltip"><i class="fa fa-github" aria-hidden="true"></i> </a><a class="social-icon" target="_blank" href="/atom.xml" title="rss" data-toggle="tooltip"><i class="fa fa-rss" aria-hidden="true"></i> </a><a class="social-icon" target="_blank" href="http://sighttp.qq.com/authd?IDKEY=4faf682653b3b7f5f47b9cb6d2bb8b81de8fa7a8fb8cee12" title="qq" data-toggle="tooltip"><i class="fa fa-qq" aria-hidden="true"></i></a></div></header><div class="search div-border" title="搜索" data-toggle="tooltip"><form id="search-form"><input type="text" id="local-search--input" name="q" results="0" placeholder=" Search..." autocomplete="off" autocorrect="off"> <i class="fa fa-times" onclick="resetSearch()"></i></form><div id="local-search--result"></div><p class="no-result">No results found</p></div><div id="tagcloud" class="tagcanvas div-border" title="标签" data-toggle="tooltip"><canvas width="200" height="200" id="tagcloud-canvas"><p>Anything in here will be replaced on browsers that support the canvas element</p><ul><li><a href="/tags/algorithm/" data-weight="8">algorithm</a></li><li><a href="/tags/android/" data-weight="2">android</a></li><li><a href="/tags/bigdata/" data-weight="2">bigdata</a></li><li><a href="/tags/c-cpp/" data-weight="6">c/cpp</a></li><li><a href="/tags/clustering/" data-weight="1">clustering</a></li><li><a href="/tags/container/" data-weight="1">container</a></li><li><a href="/tags/css/" data-weight="1">css</a></li><li><a href="/tags/cv/" data-weight="5">cv</a></li><li><a href="/tags/devtool/" data-weight="1">devtool</a></li><li><a href="/tags/ffmpeg/" data-weight="1">ffmpeg</a></li><li><a href="/tags/geomesa/" data-weight="1">geomesa</a></li><li><a href="/tags/geometry/" data-weight="4">geometry</a></li><li><a href="/tags/gfw/" data-weight="1">gfw</a></li><li><a href="/tags/github/" data-weight="1">github</a></li><li><a href="/tags/gl/" data-weight="1">gl</a></li><li><a href="/tags/golang/" data-weight="2">golang</a></li><li><a href="/tags/hexo/" data-weight="8">hexo</a></li><li><a href="/tags/http/" data-weight="1">http</a></li><li><a href="/tags/integration/" data-weight="1">integration</a></li><li><a href="/tags/java/" data-weight="2">java</a></li><li><a href="/tags/k8s/" data-weight="1">k8s</a></li><li><a href="/tags/language/" data-weight="3">language</a></li><li><a href="/tags/latex/" data-weight="1">latex</a></li><li><a href="/tags/llm/" data-weight="1">llm</a></li><li><a href="/tags/mapbox/" data-weight="1">mapbox</a></li><li><a href="/tags/markdown/" data-weight="1">markdown</a></li><li><a href="/tags/matlab/" data-weight="2">matlab</a></li><li><a href="/tags/network/" data-weight="1">network</a></li><li><a href="/tags/note/" data-weight="7">note</a></li><li><a href="/tags/numerical/" data-weight="1">numerical</a></li><li><a href="/tags/opencv/" data-weight="11">opencv</a></li><li><a href="/tags/opendrive/" data-weight="1">opendrive</a></li><li><a href="/tags/opengl/" data-weight="1">opengl</a></li><li><a href="/tags/python/" data-weight="1">python</a></li><li><a href="/tags/qt/" data-weight="2">qt</a></li><li><a href="/tags/record/" data-weight="15">record</a></li><li><a href="/tags/search/" data-weight="1">search</a></li><li><a href="/tags/segmentation/" data-weight="2">segmentation</a></li><li><a href="/tags/tensorflow/" data-weight="1">tensorflow</a></li><li><a href="/tags/thought/" data-weight="3">thought</a></li><li><a href="/tags/unix-like/" data-weight="3">unix-like</a></li><li><a href="/tags/vscode/" data-weight="1">vscode</a></li></ul></canvas><script src="/plugins/TagCanvas/jquery.tagcanvas.min.js" type="text/javascript"></script><script type="text/javascript">$(document).ready((function(){$("#tagcloud-canvas").tagcanvas({initial:[.1,-.1],activeCursor:'url("/img/cursor/link.cur"), auto',reverse:!0,depth:.75,weight:!0,weightFrom:"data-weight",weightMode:"both",weightSizeMin:15,weightSizeMax:50})||$("#tagcloud").hide()}))</script></div><div class="friends div-border" title="友链" data-toggle="tooltip"><a target="_blank" class="friends-link" href="https://cniter.github.io">Shaun&#39;s Space</a></div><div class="revolvermaps div-border" title="访客" data-toggle="tooltip"><a target="_blank" rel="noopener" href="http://livetrafficfeed.com/3d-visitor-maps" id="LTF_3d_maps">Live 3D Globes Visitor</a><script type="text/javascript" src="//cdn.livetrafficfeed.com/static/3d-maps/live.js?o=000080&amp;l=339966&amp;b=339966&amp;c=ff0000&amp;root=1&amp;timezone=Asia%2FShanghai&amp;s=" async></script></div></div><div class="toc-card"><div class="toc-card--head"><i class="fa fa-angle-up" aria-hidden="true"></i></div><div id="toc" class="toc-card--content"><strong class="toc-title">文章列表</strong><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/posts/1e3f8228.html">天文通预测气象奇观小记</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/49bd1c83.html">LLM 本地部署运行初体验</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/36b343ff.html">HTTP 超时浅见</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/6be57d7f.html">关于中学的学习方法</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/619020f7.html">VNSWRR 算法浅解</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/2eb69b33.html">记一次资源不释放的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/dbbe01e5.html">社畜三年，风雨兼程</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/8e1d1e1d.html">2021 年小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/4b1f50ff.html">M1 个人配置</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/9c9b4035.html">Scala 多线程编程小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/720275bd.html">Google S2 Geometry 浅解</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/55e674ff.html">K8S 应用开发指北</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/81321445.html">OpenGL坐标系统与渲染管线</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/8d3d87a2.html">Scala 学习小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/28416d7c.html">2020年小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/b59e3e7b.html">Linux服务器运维文档</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/489fa7b3.html">时空查询之ECQL</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/9978824c.html">GeoMesa踩坑指北</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/3692cd6.html">IDEA使用Docker环境开发调试</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/af5e9ace.html">大数据环境搭建笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ae780057.html">设计模式浅谈</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/eee1c041.html">积分计算</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/a5661762.html">Geometry增量更新</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e225d8fd.html">Mapbox显示GeoServer地图</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/3d8ab974.html">Docker使用小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/6694a214.html">空间中三角形与三角形相交</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/5315fcfd.html">计算几何基础</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/b7d79231.html">OpenDrive解析小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/39a3c99e.html">一张纹理做天空盒</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/a250bb21.html">Windows Terminal 尝鲜小记</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ae5f9dce.html">读大学</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/cf97ba7c.html">2019，既是结束又是开始</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ff29de94.html">快速判断三角形与长方体相交</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/70a807da.html">网页菜单纯 css 实现</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/abe58f8c.html">个人游记</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/26d437be.html">hexo-theme-chi主题更新小记</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/3578e309.html">［译］为什么深度学习没有取代传统的计算机视觉</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/37b89a23.html">再也不见，18年</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/ac4679b5.html">hexo-theme-chi主题开发小记</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/64889158.html">Matlab和OpenCV混合编程小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/be7949e4.html">Android实践小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/fc1165b7.html">C++数组中的坑</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/cafdd60d.html">Android开发环境配置</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/27a4c8b6.html">Windows实用技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/6315717b.html">FFmpeg提取与合并命令使用小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/fd823bf9.html">解决VSCode使用Cmder作为默认终端问题</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/fddd1e17.html">图割算法之NCuts浅见</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/c42ff8d4.html">图割算法之Graph Cuts浅见</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/b93d943b.html">C++中static用法小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/8fb9f004.html">斐波那契数列的三种写法</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/bcdf334e.html">LaTex语法指北</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/982ff584.html">搜索技巧</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/7cebf0ee.html">17年走了，18年来了</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e124baa1.html">矩阵的应用之图像仿射变换</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/aef52be2.html">本人常用小工具安利</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/376168c6.html">解决无法打开某个网页问题</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/5f54aa2c.html">PyQt5使用小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/82d3b275.html">TensorFlow Object Detection API使用小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/2a3d46b0.html">C语言中整型提升问题</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/dece8eba.html">TXT数据转OpenCV中的Mat数据</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/e8b35736.html">OpenCV中滑动条和鼠标事件响应操作的使用小结</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/b6fb6109.html">利用回调函数计算函数运行时间</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/df943c4f.html">论如何科学的上网</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/b1e9411b.html">Hexo的SPFK主题修改小记</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/22c3daf1.html">解决Qt中Qlabel显示OpenCV的Mat数据图像产生扭曲现象问题</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/509ee93b.html">解决OpenCV-2.4.11调用摄像头显示拍摄视频出错问题</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/3bc0decc.html">Hexo添加各种小部件</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/fd0f8195.html">OpenCV中显著性检测算法的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/35132cb7.html">OpenCV中Selective Search算法的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/170c76cc.html">别了，漆黑的象牙塔</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/c3f26b1.html">Win10以树形结构显示文件目录结构</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/68065b99.html">ACGN作品个人印象简评</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/4f6225b7.html">Hexo添加站内本地搜索</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/302a6244.html">用OpenCV显示OpenGL图形</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/7df528b4.html">Win10＋VS2013＋CMake-gui编译和配置OpenCV-3.2.0</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/17017530.html">MyThoughts</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/7d5bc07b.html">解决写上篇文档“Hexo+GitHub搭建个人博客”遇到的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/d7965b48.html">Hexo+GitHub搭建个人博客</a></li><li class="post-list-item"><a class="post-list-link" href="/posts/4a17b156.html">Hello World</a></li></ul></div></div></aside></div></div><span id="cursor-trail"></span> <span class="click-halo"></span><footer id="footer" class="text-center"><div class="copyright-info">&copy; 2017 - 2025 <a href="/">Shaun</a></div><span class="site-visitor"><i class="fa fa-user-o" aria-hidden="true"></i> <span id="busuanzi_value_site_uv"><i class="fa fa-spinner fa-spin"></i></span> &nbsp;|&nbsp; <i class="fa fa-eye" aria-hidden="true"></i> <span id="busuanzi_value_site_pv"><i class="fa fa-spinner fa-spin"></i></span> &nbsp;|&nbsp; <i class="fa fa-hand-o-up" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span></span><div class="site-info"><a href="http://hexo.io/" target="_blank">Hexo </a>theme <a href="https://github.com/cniter/hexo-theme-chi" target="_blank">Chi </a>by <a href="https://github.com/cniter" target="_blank">Shaun</a></div></footer><script type="text/javascript" async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" integrity="sha256-WUED7NFzpsmHtLO7bswSz4JSfkhE+cD4ncKeOznwFSY=" crossorigin="anonymous"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
            processEscapes: true,
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }

        , TeX: {
            extensions: ["extpfeil.js"]
        }
    });
    
    MathJax.Hub.Queue(function() {
        let all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';                 
        }       
    });</script><script type="text/javascript">const MutationObserver=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,config={attributes:!0,childList:!0,characterData:!0};let target=document.querySelector("#local-search--result"),$local_search_result=$("#local-search--result"),$no_result=$(".no-result"),observer=new MutationObserver((function(e){e.forEach((function(e){$local_search_result.text()||""==$local_search_result.html()?$no_result.hide():$no_result.show(200)}))})),inputArea=document.querySelector("#local-search--input"),getSearchFile=function(){let e="search.xml";0==e.length&&(e="search.xml"),searchFunc("/"+e,"local-search--input","local-search--result"),observer.observe(target,config)};inputArea.onfocus=function(){getSearchFile()};let $resetButton=$("#search-form .fa-times"),$resultArea=$("#local-search--result");inputArea.oninput=function(){$resetButton.show()};let resetSearch=function(){$resultArea.html(""),document.querySelector("#search-form").reset(),$resetButton.hide(),$no_result.hide(),observer.disconnect()};inputArea.onkeydown=function(e){if(13==e.keyCode)return!1};let searchFunc=function(e,t,r){"use strict";$.ajax({url:e,dataType:"xml",success:function(e){let n=$("entry",e).map((function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}})).get(),l=document.getElementById(t),s=document.getElementById(r);l.addEventListener("input",(function(){let e='<ul class="search-result--list">',t=this.value.trim().toLowerCase().split(/[\s\-]+/);s.innerHTML="",this.value.trim().length<=0||(n.forEach((function(r){let n=!0,l=r.title.trim().toLowerCase(),s=r.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),c=r.url,o=-1,a=-1,u=-1;if(""!=l&&""!=s&&t.forEach((function(e,t){o=l.indexOf(e),a=s.indexOf(e),o<0&&a<0?n=!1:(a<0&&(a=0),0==t&&(u=a))})),n){e+="<li><a href='"+c+"' class='search-result--title' target='_blank'>> "+l+"</a>";let n=r.content.trim().replace(/<[^>]+>/g,"");if(u>=0){let r=u-6,l=u+6;r<0&&(r=0),0==r&&(l=10),l>n.length&&(l=n.length);let s=n.substr(r,l);t.forEach((function(e){let t=new RegExp(e,"gi");s=s.replace(t,'<em class="search-keyword">'+e+"</em>")})),e+='<p class="search-result">'+s+"...</p>"}}})),s.innerHTML=e)}))}})}</script><script>function loadScript(e,t){let a=document.createElement("script");a.type="text/javascript",a.async=!0,a.readyState?a.onreadystatechange=function(){"loaded"!=a.readyState&&"complete"!=a.readyState||(a.onreadystatechange=null,t())}:a.onload=function(){t()},a.src=e,document.getElementsByTagName("body")[0].appendChild(a)}</script><script type="module" src="/js/main.js"></script><script>$(document).ready((function(){$("del").attr("title","你知道的太多了ヾ(▼ﾍ▼；) (#｀皿´メ)"),$(".toc-card").width($("#right-col").width()),$("a.footnote-ref").each((function(t,e){let i=$(this).parents("article").attr("id"),o=$(this).attr("href");e.setAttribute("data-toggle","tooltip"),e.setAttribute("data-html","true"),e.setAttribute("title",$("#"+i+" "+o).html())})),setInterval(()=>{$("#site-bg").fadeTo(1e3,.1,()=>{$("#site-bg").css("background-image",'url("/img/site-bg/bg-'+Math.floor(8*Math.random())+'.jpg")')}),$("#site-bg").fadeTo(2e3,.2)},3e4),siteBgElem=document.getElementById("site-bg"),siteBgElem&&siteBgElem.clientWidth>0&&siteBgElem.clientHeight>0&&loadScript("/js/widget/canvas-nest.js",()=>{new CanvasNest(siteBgElem,{opacity:1,pointColor:"255,255,0",color:"255,255,0",count:30})})})),$(window).on("load",(function(){$("#sidebar-sticky--bottom").height($("#right-col").height()-$("#sidebar").height()-$("#footer").height())})),$((function(){$("[data-toggle='tooltip']").tooltip()}))</script></body></html>