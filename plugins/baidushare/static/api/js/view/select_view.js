window._bd_share_main.F.module("view/select_view",function(e,t,s){function _(e){var t="",t=document.selection?document.selection.createRange().text:document.getSelection();return m.string(t.toString()).trim()}var u,b,p,f,m=e("base/tangram").T,a=e("base/class").Class,e=(e("conf/const"),e("view/view_base")),g="getSelection"in document?function(){document.getSelection().removeAllRanges(),f=""}:function(){document.selection.empty(),f=""};t.View=a.create(function(a){function n(e,s){var t,a,n=function(e,t){var s=e.pageY,a=e.pageX;s+=5,a-=18;var n=u.outerHeight(),i=m(window).scrollTop();return(s+n>m("body").height()&&s+n>m(window).height()||s+n>i+m(window).height())&&(s=(s=e.pageY-n-5)<i?i:s),i=t.bdPopupOffsetLeft,t=t.bdPopupOffsetTop,(i||t)&&(s+=0|t,a+=0|i),{top:s,left:a}}(e,s);f.length<5?i.hide("less"):(m.each([u,b],function(e,t){t.css({top:n.top,left:n.left}).show(),s.bdText=_()}),a=p.find("a").length,t=m(p.find("a")).outerWidth(!0)*a+20,e=parseInt(u.css("max-width")),u.width(t=e&&e<t?e:t),u.find(".bdselect_share_head").width(t),b.width(t),b.height(u.height()),(a=u.find(".bdselect_share_dialog_search")).attr("href","http://www.baidu.com/s?wd="+s.bdText+"&tn=SE_hldp08010_vurs2xrp"),e=h(function(){l("http://s.share.baidu.com/select?"+m.ajax.param({log_type:"click",content:encodeURIComponent(s.bdText)}))},100),a.click(e),t<220?u.find(".bdselect_share_dialog_search_span").hide():u.find(".bdselect_share_dialog_search_span").show(),l("http://s.share.baidu.com/select?"+m.ajax.param({log_type:"show",content:encodeURIComponent(s.bdText)})))}var i=this;i._container=null;var d=a.bdStyle||0,o=-1<"|16|24|32|".indexOf("|"+a.bdSize+"|")?a.bdSize:16,r=!1;i._buttonType=0,i.render=function(){var e="bdSharePopup_selectshare"+ +new Date,t=['<iframe frameborder="0" id="'+e+'bg" class="bdselect_share_bg" style="display:none;"></iframe>'].join(""),s=['<div id="'+e+'box" style="display:none;" share-type="selectshare" class="bdselect_share_box">','<div class="selectshare-mod-triangle"><div class="triangle-border"></div><div class="triangle-inset"></div></div>','<div  class="bdselect_share_head" ><span>分享到</span>','<a href="http://www.baidu.com/s?wd='+a.bdText+'&tn=SE_hldp08010_vurs2xrp"',' class="bdselect_share_dialog_search" target="_blank">','<i class="bdselect_share_dialog_search_i"></i>','<span class="bdselect_share_dialog_search_span">百度一下</span></a>','<a class="bdselect_share_dialog_close"></a></div>','<div class="bdselect_share_content" >','<ul class="bdselect_share_list">','<div class="bdselect_share_partners"></div>','<a href="#" class="bds_more"  data-cmd="more"></a>',"</ul>","</div>","</div>"].join("");m("body").insertHTML("beforeEnd",t+s),i._container=u=m("#"+e+"box"),p=u.find(".bdselect_share_list").addClass("bdshare-button-style"+d+"-"+o),b=m("#"+e+"bg"),i._entities.push(u),m(".bdselect_share_dialog_close").click(i.hide)},i.hide=function(e){e||g(),b&&b.hide(),u&&u.hide()},i._init=function(){var e=a.bdContainerClass?m("."+a.bdContainerClass):m("body").children();m("body").on("mouseup",function(s){e.each(function(e,t){t==s.target||m(t).contains(s.target)||!a.bdContainerClass&&s.target==document.body?setTimeout(function(){var e;f=_(),a.bdCustomStyle?((e=document.createElement("link")).href=a.bdCustomStyle,e.rel="styleSheet",e.type="text/css",document.getElementsByTagName("head")[0].appendChild(e)):window._bd_share_main.F.use("share_style"+d+"_"+o+".css"),i.show(s,a)},10):"block"==u.css("display")&&i.hide()})})},i.show=function(t,s){window._bd_share_main.F.use(["component/partners","share_popup.css","select_share.css"],function(e){i._partnerSort=e.partnerSort,r||(function(e){e.bdMini;var e=e.bdSelectMiniList||i._partnerSort.slice(0,4),s=[];m.each(e,function(e,t){s[e]='<a href="#" class="bds_'+t+'" data-cmd="'+t+'"></a>'}),p.find(".bdselect_share_partners").html(s.join(""))}((i._container,s)),r=!0),n(t,s)})};var c,l=(c={},function(e){var t="bdsharelog__"+(new Date).getTime(),s=c[t]=new Image;s.onload=s.onerror=function(){c[t]=null},s.src=e+"&t="+(new Date).getTime()}),h=function(s,a,n){var i,d,o,r=null,c=0;n=n||{};function l(){c=!1===n.leading?0:new Date,r=null,o=s.apply(i,d),r||(i=d=null)}return function(){var e=new Date;c||!1!==n.leading||(c=e);var t=a-(e-c);return i=this,d=arguments,t<=0||a<t?(clearTimeout(r),r=null,c=e,o=s.apply(i,d),r||(i=d=null)):r||!1===n.trailing||(r=setTimeout(l,t)),o}};i._distory=function(){u.remove(),b.remove()}},e.ViewBase)});